var yn=Object.defineProperty;var Cr=N=>{throw TypeError(N)};var _n=(N,r,e)=>r in N?yn(N,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):N[r]=e;var Ne=(N,r,e)=>_n(N,typeof r!="symbol"?r+"":r,e),kn=(N,r,e)=>r.has(N)||Cr("Cannot "+e);var Ir=(N,r,e)=>r.has(N)?Cr("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(N):r.set(N,e);var Dt=(N,r,e)=>(kn(N,r,"access private method"),e);import{r as ge,a as Sn,b as pe,c as Lt,g as Nn}from"./vendor-Q3K9tvtn.js";import{O as En,u as jn,a as qt,L as pt,R as Tn,b as yt,c as An,B as Cn}from"./router-B8gHI2G4.js";import{C as In,D as Xr,S as Rn,P as vt,a as Rr,X as st,A as Vr,L as zn,b as On,c as Qt,M as er,I as Dn,d as Ln,e as Pn,f as Mn,B as Bn,E as zr,g as Or}from"./ui-CArKjTqp.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();var Jr={exports:{}},Yt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Un=ge,Fn=Symbol.for("react.element"),$n=Symbol.for("react.fragment"),Wn=Object.prototype.hasOwnProperty,Hn=Un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zn={key:!0,ref:!0,__self:!0,__source:!0};function Qr(N,r,e){var t,i={},n=null,s=null;e!==void 0&&(n=""+e),r.key!==void 0&&(n=""+r.key),r.ref!==void 0&&(s=r.ref);for(t in r)Wn.call(r,t)&&!Zn.hasOwnProperty(t)&&(i[t]=r[t]);if(N&&N.defaultProps)for(t in r=N.defaultProps,r)i[t]===void 0&&(i[t]=r[t]);return{$$typeof:Fn,type:N,key:n,ref:s,props:i,_owner:Hn.current}}Yt.Fragment=$n;Yt.jsx=Qr;Yt.jsxs=Qr;Jr.exports=Yt;var l=Jr.exports,lr={},Dr=Sn;lr.createRoot=Dr.createRoot,lr.hydrateRoot=Dr.hydrateRoot;const en=ge.createContext(void 0),It=()=>{const N=ge.useContext(en);if(N===void 0)throw new Error("useAuth must be used within an AuthProvider");return N},Gn=({children:N})=>{const[r,e]=ge.useState(null),[t,i]=ge.useState(!0);ge.useEffect(()=>{const m=localStorage.getItem("mockUser");m&&e(JSON.parse(m)),i(!1)},[]);const f={user:r,loading:t,signIn:async(m,g)=>{const b={uid:"mock-user-id",email:m,displayName:m.split("@")[0],photoURL:null};e(b),localStorage.setItem("mockUser",JSON.stringify(b))},signUp:async(m,g,b)=>{const u={uid:"mock-user-id",email:m,displayName:b,photoURL:null};e(u),localStorage.setItem("mockUser",JSON.stringify(u))},signOut:async()=>{e(null),localStorage.removeItem("mockUser")},signInWithGoogle:async()=>{const m={uid:"mock-google-user-id",email:"user@gmail.com",displayName:"Google User",photoURL:"https://via.placeholder.com/40"};e(m),localStorage.setItem("mockUser",JSON.stringify(m))}};return l.jsx(en.Provider,{value:f,children:N})},qn=()=>l.jsx("div",{className:"min-h-screen bg-white",children:l.jsx("main",{className:"px-4 py-6",children:l.jsx(En,{})})});function tn(N){var r,e,t="";if(typeof N=="string"||typeof N=="number")t+=N;else if(typeof N=="object")if(Array.isArray(N)){var i=N.length;for(r=0;r<i;r++)N[r]&&(e=tn(N[r]))&&(t&&(t+=" "),t+=e)}else for(e in N)N[e]&&(t&&(t+=" "),t+=e);return t}function pr(){for(var N,r,e=0,t="",i=arguments.length;e<i;e++)(N=arguments[e])&&(r=tn(N))&&(t&&(t+=" "),t+=r);return t}const Be=({variant:N="primary",size:r="md",children:e,className:t,...i})=>{const n="inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",s={primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-primary-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-primary-500"},a={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"};return l.jsx("button",{className:pr(n,s[N],a[r],t),...i,children:e})},mr=pe.forwardRef(({label:N,error:r,helperText:e,className:t,id:i,...n},s)=>{const a=i||`textarea-${Math.random().toString(36).substr(2,9)}`;return l.jsxs("div",{className:"w-full",children:[N&&l.jsx("label",{htmlFor:a,className:"block text-sm font-medium text-gray-700 mb-2",children:N}),l.jsx("textarea",{ref:s,id:a,className:pr("w-full px-3 py-2 border rounded-lg shadow-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 resize-vertical",r?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500",t),...n}),r&&l.jsx("p",{className:"mt-1 text-sm text-red-600",children:r}),e&&!r&&l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:e})]})}),it=({label:N,error:r,helperText:e,className:t,id:i,...n})=>{const s=i||`input-${Math.random().toString(36).substr(2,9)}`;return l.jsxs("div",{className:"w-full",children:[N&&l.jsx("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-2",children:N}),l.jsx("input",{id:s,className:pr("w-full px-3 py-2 border rounded-lg shadow-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",r?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500",t),...n}),r&&l.jsx("p",{className:"mt-1 text-sm text-red-600",children:r}),e&&!r&&l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:e})]})},rn=({size:N="md",className:r=""})=>{const e={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return l.jsx("div",{className:`flex items-center justify-center ${r}`,children:l.jsx("div",{className:`${e[N]} animate-spin rounded-full border-b-2 border-primary-600`})})},Yn=["主人公は立ち上がり、決意を込めて言った。","その時、不思議な光が現れて、状況を一変させた。","彼女の心に新しい希望が芽生え始めていた。","謎めいた影が近づいてくる。","突然、雷鳴が轟き、空が暗くなった。","古い城の扉がきしみながら開いた。","魔法の剣が光り始めた。","風が物語を運んでくる。","星が瞬いて、新しい冒険を予感させる。","時間が止まったような静寂が訪れた。"],Ct=new Map,Lr=[{id:"proj-001",name:"冒険の始まり",main:"冒険の始まり.md",ai_policy:{read:"allow",quote:"internal",write:"deny",scope:["local"],until:null},texts:[{id:"t-main",path:"texts/冒険の始まり.md"}],tags:["冒険","ファンタジー","魔法"],tag_docs:{},libraly:["辞書"],lib_docs:{辞書:{path:"tags/辞書.md"}}},{id:"proj-002",name:"謎の遺跡",main:"謎の遺跡.md",ai_policy:{read:"allow",quote:"internal",write:"deny",scope:["local"],until:null},texts:[{id:"t-main",path:"texts/謎の遺跡.md"}],tags:["ミステリー","古代","考古学"],tag_docs:{},libraly:["辞書"],lib_docs:{辞書:{path:"tags/辞書.md"}}},{id:"proj-003",name:"宇宙の旅人",main:"宇宙の旅人.md",ai_policy:{read:"allow",quote:"internal",write:"deny",scope:["local"],until:null},texts:[{id:"t-main",path:"texts/宇宙の旅人.md"}],tags:["SF","宇宙","冒険"],tag_docs:{},libraly:["辞書"],lib_docs:{辞書:{path:"tags/辞書.md"}}}];Ct.set("proj-001",new Map([["t-main",`主人公のアレックスは小さな村で平凡な生活を送っていた。毎日同じような日々が続き、何か変化を求めていた。

ある朝、村の外れで不思議な光を発する石を発見した。その石に触れた瞬間、世界が一変した。

「これは...魔法の石？」アレックスは呟いた。

その時、石から声が聞こえてきた。「選ばれし者よ、君の冒険が今始まる...」`]]));Ct.set("proj-002",new Map([["t-main",`考古学者のサラは古代の遺跡で不思議な発見をした。壁に刻まれた文字は、これまで見たことのない言語だった。

「この文字...古代エジプトとも、マヤ文明とも違う」サラは顕微鏡で文字を詳しく調べた。

突然、遺跡の奥から光が差し込んだ。それは自然光ではない。人工的な光だった。

「誰かいるのか？」サラは懐中電灯を手に取り、光の方向へ歩き始めた。`]]));Ct.set("proj-003",new Map([["t-main",`宇宙船パイオニア号は未知の惑星に向かっていた。船長のケンは地球を離れてから3年が経過していた。

「地球からの最後の通信から6ヶ月が経った」ケンは航海日誌に記録した。

その時、船の警報システムが作動した。「未知の物体が接近中」という警告音が響いた。

ケンはスクリーンを見つめた。そこには、これまで見たことのない巨大な宇宙船が映し出されていた。`]]));class Kn{constructor(){Ne(this,"projects",[...Lr]);Ne(this,"projectTextContents",new Map(Ct));Ne(this,"projectDictionaries",new Map);Ne(this,"scenarios",[]);this.projects=[...Lr],this.projectTextContents=new Map(Ct),this.loadFromLocalStorage(),this.normalizeAllProjectTags(),this.saveToLocalStorage()}normalizeTags(r){if(!r||r.length===0)return[];const e=r.map(t=>t.trim()).filter(t=>t.length>0);return Array.from(new Set(e))}normalizeProjectTags(r){const e=[];r.texts.forEach(i=>{const n=i;n.tags&&Array.isArray(n.tags)&&(e.push(...n.tags),delete n.tags)});const t=[...r.tags||[],...e];r.tags=this.normalizeTags(t)}normalizeAllProjectTags(){this.projects.forEach(r=>{this.normalizeProjectTags(r)})}projectToScenario(r,e){var s;const t=((s=r.texts[0])==null?void 0:s.id)||"t-main",i=this.getProjectTextContent(r.id,t)||"",n=this.getProjectDictionary(r.id);return{id:r.id,title:r.name,content:i,createdAt:new Date,updatedAt:new Date,tags:this.normalizeTags(r.tags||[]),isPublic:!0,authorId:e,dictionaryEntries:n}}getProjectTextContent(r,e){const t=this.projectTextContents.get(r);return(t==null?void 0:t.get(e))||null}setProjectTextContent(r,e,t){this.projectTextContents.has(r)||this.projectTextContents.set(r,new Map),this.projectTextContents.get(r).set(e,t)}getProject(r){return this.projects.find(e=>e.id===r)||null}getUserProjects(r){return this.projects}getUserScenarios(r){return this.getUserProjects(r).map(t=>this.projectToScenario(t,r))}getScenario(r){const e=this.getProject(r);return e?this.projectToScenario(e,"mock-user-id"):null}createScenario(r){const e=`proj-${Date.now()}`,t="t-main",i={id:e,name:r.title,main:`${r.title}.md`,ai_policy:{read:"allow",quote:"internal",write:"deny",scope:["local"],until:null},texts:[{id:t,path:`texts/${r.title}.md`}],tags:this.normalizeTags(r.tags||[]),tag_docs:{},libraly:r.dictionaryEntries&&r.dictionaryEntries.length>0?["辞書"]:void 0,lib_docs:r.dictionaryEntries&&r.dictionaryEntries.length>0?{辞書:{path:"tags/辞書.md"}}:void 0};return this.projects.push(i),this.setProjectTextContent(e,t,r.content),r.dictionaryEntries&&r.dictionaryEntries.length>0&&this.projectDictionaries.set(e,r.dictionaryEntries),this.saveToLocalStorage(),e}updateScenario(r,e){var i;const t=this.getProject(r);if(t){if(e.title&&(t.name=e.title,t.main=`${e.title}.md`),e.tags&&(t.tags=this.normalizeTags(e.tags)),this.normalizeProjectTags(t),e.content!==void 0){const n=((i=t.texts[0])==null?void 0:i.id)||"t-main";this.setProjectTextContent(r,n,e.content)}e.dictionaryEntries&&(this.projectDictionaries.set(r,e.dictionaryEntries),e.dictionaryEntries.length>0?(t.libraly=["辞書"],t.lib_docs={辞書:{path:"tags/辞書.md"}}):(t.libraly=void 0,t.lib_docs=void 0)),this.saveToLocalStorage()}}addDictionaryEntry(r,e){if(!this.getProject(r))return null;const i={id:Date.now().toString(),...e,createdAt:new Date},n=this.projectDictionaries.get(r)||[];return this.projectDictionaries.set(r,[...n,i]),this.saveToLocalStorage(),i}removeDictionaryEntry(r,e){const t=this.projectDictionaries.get(r)||[];this.projectDictionaries.set(r,t.filter(i=>i.id!==e)),this.saveToLocalStorage()}updateDictionaryEntry(r,e,t){const n=(this.projectDictionaries.get(r)||[]).map(s=>s.id===e?{...s,term:t.term,description:t.description}:s);return this.projectDictionaries.set(r,n),this.saveToLocalStorage(),n.find(s=>s.id===e)??null}getProjectDictionary(r){return this.projectDictionaries.get(r)||[]}deleteScenario(r){this.scenarios=this.scenarios.filter(e=>e.id!==r),this.saveToLocalStorage()}getPublicScenarios(){return this.scenarios.filter(r=>r.isPublic)}generateAISuggestions(){return[...Yn].sort(()=>.5-Math.random()).slice(0,5)}loadFromLocalStorage(){const r=localStorage.getItem("mockProjects");if(r)try{this.projects=JSON.parse(r),this.normalizeAllProjectTags()}catch(i){console.error("Error loading projects from localStorage:",i)}const e=localStorage.getItem("mockProjectTextContents");if(e)try{const i=JSON.parse(e);this.projectTextContents=new Map(Object.entries(i).map(([n,s])=>[n,new Map(Object.entries(s))]))}catch(i){console.error("Error loading project text contents from localStorage:",i)}const t=localStorage.getItem("mockProjectDictionaries");if(t)try{const i=JSON.parse(t);this.projectDictionaries=new Map(Object.entries(i).map(([n,s])=>[n,s.map(a=>({...a,createdAt:new Date(a.createdAt)}))]))}catch(i){console.error("Error loading project dictionaries from localStorage:",i)}}saveToLocalStorage(){localStorage.setItem("mockProjects",JSON.stringify(this.projects));const r={};this.projectTextContents.forEach((t,i)=>{r[i]=Object.fromEntries(t)}),localStorage.setItem("mockProjectTextContents",JSON.stringify(r));const e={};this.projectDictionaries.forEach((t,i)=>{e[i]=t}),localStorage.setItem("mockProjectDictionaries",JSON.stringify(e))}}const $e=new Kn,Xn=({initialContent:N="",onSave:r})=>{const{user:e}=It(),[t,i]=ge.useState(N),[n,s]=ge.useState(""),[a,c]=ge.useState([]),[f,m]=ge.useState(""),[g,b]=ge.useState(!1),[u,v]=ge.useState([]),[h,w]=ge.useState(!1),[p,_]=ge.useState(0),[S,A]=ge.useState(null),T=ge.useRef(null),U=async()=>{w(!0);try{await new Promise(te=>setTimeout(te,1500));const z=$e.generateAISuggestions();v(z)}catch(z){console.error("AI completion error:",z)}finally{w(!1)}},M=z=>{i(z.target.value),_(z.target.selectionStart)},Z=()=>{T.current&&_(T.current.selectionStart)},L=z=>{const te=t.substring(0,p),W=t.substring(p),le=te+z+W;i(le),v([]),setTimeout(()=>{if(T.current){const G=p+z.length;T.current.focus(),T.current.setSelectionRange(G,G)}},100)},Y=()=>{f.trim()&&!a.includes(f.trim())&&(c([...a,f.trim()]),m(""))},J=z=>{c(a.filter(te=>te!==z))},k=()=>{if(!e){alert("ログインが必要です");return}try{if(S)$e.updateScenario(S,{title:n,content:t,tags:a,isPublic:g});else{const z=$e.createScenario({title:n||"無題のシナリオ",content:t,tags:a,isPublic:g,authorId:e.uid});A(z)}r&&r({title:n,content:t,tags:a,isPublic:g}),alert("シナリオが保存されました！")}catch(z){console.error("Save error:",z),alert("保存に失敗しました")}},P=async()=>{try{await navigator.clipboard.writeText(t),alert("クリップボードにコピーしました")}catch(z){console.error("Copy failed:",z)}},d=()=>{const z=JSON.stringify({title:n,content:t,tags:a,isPublic:g,timestamp:new Date().toISOString()},null,2),te=new Blob([z],{type:"application/json"}),W=URL.createObjectURL(te),le=document.createElement("a");le.href=W,le.download=`${n||"scenario"}.json`,le.click(),URL.revokeObjectURL(W)};return l.jsxs("div",{className:"max-w-5xl mx-auto p-4 sm:p-6 lg:p-8 space-y-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"シナリオエディター"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs(Be,{variant:"outline",size:"sm",onClick:P,className:"flex-1 sm:flex-none",children:[l.jsx(In,{className:"h-4 w-4 mr-2"}),"コピー"]}),l.jsxs(Be,{variant:"outline",size:"sm",onClick:d,className:"flex-1 sm:flex-none",children:[l.jsx(Xr,{className:"h-4 w-4 mr-2"}),"エクスポート"]}),l.jsxs(Be,{size:"sm",onClick:k,className:"flex-1 sm:flex-none",children:[l.jsx(Rn,{className:"h-4 w-4 mr-2"}),"保存"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsx(it,{label:"タイトル",value:n,onChange:z=>s(z.target.value),placeholder:"シナリオのタイトルを入力"}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:g,onChange:z=>b(z.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"公開"})]})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"タグ"}),l.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:a.map((z,te)=>l.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary-100 text-primary-800",children:[z,l.jsx("button",{onClick:()=>J(z),className:"ml-2 text-primary-600 hover:text-primary-800",children:"×"})]},te))}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx(it,{value:f,onChange:z=>m(z.target.value),placeholder:"新しいタグを入力",onKeyPress:z=>z.key==="Enter"&&Y()}),l.jsx(Be,{variant:"outline",onClick:Y,children:l.jsx(vt,{className:"h-4 w-4"})})]})]}),l.jsxs("div",{className:"bg-gradient-to-r from-purple-50 via-blue-50 to-indigo-50 p-6 rounded-xl border border-purple-100 shadow-sm",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[l.jsx(Rr,{className:"h-5 w-5 mr-2 text-purple-600 animate-pulse"}),"AI補完"]}),l.jsx(Be,{variant:"outline",size:"sm",onClick:()=>U(),disabled:h,className:"w-full sm:w-auto",children:h?l.jsxs(l.Fragment,{children:[l.jsx(rn,{size:"sm",className:"mr-2"}),"生成中..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Rr,{className:"h-4 w-4 mr-2"}),"続きを生成"]})})]}),u.length>0&&l.jsxs("div",{className:"space-y-3 mt-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700",children:"以下の提案から選択してください："}),l.jsx("div",{className:"grid gap-3",children:u.map((z,te)=>l.jsx("div",{className:"bg-white p-4 rounded-lg border-2 border-purple-200 hover:border-purple-400 cursor-pointer transition-all shadow-sm hover:shadow-md",onClick:()=>L(z),children:l.jsx("p",{className:"text-gray-800 leading-relaxed",children:z})},te))})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"シナリオ内容"}),l.jsx(mr,{ref:T,value:t,onChange:M,onSelect:Z,onFocus:Z,placeholder:"シナリオの内容を入力してください...",className:"min-h-96 font-mono text-base leading-relaxed"}),l.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["文字数: ",t.length," | カーソル位置: ",p]})]}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"統計情報"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"文字数:"}),l.jsx("span",{className:"ml-2 font-medium",children:t.length})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"単語数:"}),l.jsx("span",{className:"ml-2 font-medium",children:t.split(/\s+/).filter(z=>z.length>0).length})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"行数:"}),l.jsx("span",{className:"ml-2 font-medium",children:t.split(`
`).length})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"段落数:"}),l.jsx("span",{className:"ml-2 font-medium",children:t.split(`

`).filter(z=>z.trim().length>0).length})]})]})]})]})},Vn=()=>{const[N]=jn(),[r,e]=ge.useState(""),t=N.get("id");ge.useEffect(()=>{if(t){const n=$e.getScenario(t);n&&e(n.content)}},[t]);const i=n=>{console.log("Saving scenario:",n)};return l.jsx("div",{className:"min-h-screen",children:l.jsx(Xn,{initialContent:r,onSave:i})})},Jn=({isOpen:N,onClose:r,onSave:e})=>{const[t,i]=ge.useState(""),[n,s]=ge.useState(!1),[a,c]=ge.useState(!1);ge.useEffect(()=>{if(N){const m=localStorage.getItem("apiKey")||"",g=localStorage.getItem("useShortcutKeys")==="true",b=localStorage.getItem("dontSaveAIHistory")==="true";i(m),s(g),c(b)}},[N]);const f=()=>{const m={apiKey:t,useShortcutKeys:n,dontSaveAIHistory:a};localStorage.setItem("apiKey",t),localStorage.setItem("useShortcutKeys",n.toString()),localStorage.setItem("dontSaveAIHistory",a.toString()),e(m),r()};return N?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:l.jsxs("div",{className:"bg-blue-50 border-2 border-gray-300 rounded-lg shadow-xl w-full max-w-lg mx-4 p-8 relative",children:[l.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"閉じる",children:l.jsx(st,{className:"h-5 w-5"})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"APIキーの入力"}),l.jsx("div",{className:"mb-6",children:l.jsx(it,{type:"password",value:t,onChange:m=>i(m.target.value),placeholder:"APIキーを入力してください",className:"w-full h-12 text-base"})}),l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:n,onChange:m=>s(m.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"ショートカットキーを使用する"})]}),l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:a,onChange:m=>c(m.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"AIの履歴を保存しない"})]})]}),l.jsx("div",{className:"flex justify-center",children:l.jsx(Be,{onClick:f,className:"px-8",children:"設定を保存"})})]})}):null},Qn=({isOpen:N,onClose:r,onSave:e,onNext:t})=>{const[i,n]=ge.useState(""),s=()=>{i.trim()&&(e(i),n(""),r())},a=()=>{i.trim()&&(t?(t(i),n(""),r()):s())},c=()=>{n(""),r()};return N?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:l.jsxs("div",{className:"bg-blue-50 border-2 border-gray-300 rounded-lg shadow-xl w-full max-w-2xl mx-4 p-6 relative",children:[l.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"閉じる",children:l.jsx(st,{className:"h-5 w-5"})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"プロンプト入力"}),l.jsx("div",{className:"mb-6",children:l.jsx(mr,{value:i,onChange:f=>n(f.target.value),placeholder:"プロンプトを入力してください...",className:"w-full min-h-[300px] text-base resize-none"})}),l.jsxs("div",{className:"flex justify-between gap-4",children:[l.jsx(Be,{onClick:s,variant:"outline",className:"flex-1 border border-gray-300 hover:border-gray-400",disabled:!i.trim(),children:"テキストを保存"}),l.jsxs(Be,{onClick:a,className:"flex-1",disabled:!i.trim(),children:[l.jsx(Vr,{className:"h-4 w-4 mr-2"}),"次へ"]})]})]})}):null},es=({isOpen:N,onClose:r,onSave:e,onNext:t,mode:i="create",initialEntry:n})=>{const[s,a]=ge.useState(""),[c,f]=ge.useState("");pe.useEffect(()=>{N&&(a((n==null?void 0:n.term)??""),f((n==null?void 0:n.description)??""))},[N,n]);const m=()=>{s.trim()&&c.trim()&&(e({term:s,description:c}),a(""),f(""),r())},g=()=>{if(i==="edit"||!t){m();return}s.trim()&&c.trim()&&(t({term:s,description:c}),a(""),f(""),r())},b=()=>{a(""),f(""),r()};return N?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:l.jsxs("div",{className:"bg-blue-50 rounded-lg shadow-xl w-full max-w-2xl mx-4 p-6 relative",children:[l.jsx("button",{onClick:b,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"閉じる",children:l.jsx(st,{className:"h-5 w-5"})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:i==="edit"?"辞書エントリの編集":"辞書エントリの追加"}),l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"用語"}),l.jsx(it,{value:s,onChange:u=>a(u.target.value),placeholder:"例: 魔法石"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"詳細"}),l.jsx(mr,{value:c,onChange:u=>f(u.target.value),placeholder:"用語の説明や背景を入力してください...",className:"w-full min-h-[220px] text-base resize-none bg-blue-50"})]})]}),l.jsxs("div",{className:"flex justify-between gap-4",children:[l.jsx(Be,{onClick:m,variant:"outline",className:"flex-1 border border-gray-300 hover:border-gray-400",disabled:!s.trim()||!c.trim(),children:i==="edit"?"更新する":"テキストを保存"}),i==="create"&&t&&l.jsx(Be,{onClick:g,className:"flex-1",disabled:!s.trim()||!c.trim(),children:l.jsx(Vr,{className:"h-4 w-4 mr-2"})})]})]})}):null};function gr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let xt=gr();function nn(N){xt=N}const sn=/[&<>"']/,ts=new RegExp(sn.source,"g"),an=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,rs=new RegExp(an.source,"g"),ns={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Pr=N=>ns[N];function Ye(N,r){if(r){if(sn.test(N))return N.replace(ts,Pr)}else if(an.test(N))return N.replace(rs,Pr);return N}const ss=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function is(N){return N.replace(ss,(r,e)=>(e=e.toLowerCase(),e==="colon"?":":e.charAt(0)==="#"?e.charAt(1)==="x"?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""))}const as=/(^|[^\[])\^/g;function Ee(N,r){let e=typeof N=="string"?N:N.source;r=r||"";const t={replace:(i,n)=>{let s=typeof n=="string"?n:n.source;return s=s.replace(as,"$1"),e=e.replace(i,s),t},getRegex:()=>new RegExp(e,r)};return t}function Mr(N){try{N=encodeURI(N).replace(/%25/g,"%")}catch{return null}return N}const Tt={exec:()=>null};function Br(N,r){const e=N.replace(/\|/g,(n,s,a)=>{let c=!1,f=s;for(;--f>=0&&a[f]==="\\";)c=!c;return c?"|":" |"}),t=e.split(/ \|/);let i=0;if(t[0].trim()||t.shift(),t.length>0&&!t[t.length-1].trim()&&t.pop(),r)if(t.length>r)t.splice(r);else for(;t.length<r;)t.push("");for(;i<t.length;i++)t[i]=t[i].trim().replace(/\\\|/g,"|");return t}function Pt(N,r,e){const t=N.length;if(t===0)return"";let i=0;for(;i<t&&N.charAt(t-i-1)===r;)i++;return N.slice(0,t-i)}function os(N,r){if(N.indexOf(r[1])===-1)return-1;let e=0;for(let t=0;t<N.length;t++)if(N[t]==="\\")t++;else if(N[t]===r[0])e++;else if(N[t]===r[1]&&(e--,e<0))return t;return-1}function Ur(N,r,e,t){const i=r.href,n=r.title?Ye(r.title):null,s=N[1].replace(/\\([\[\]])/g,"$1");if(N[0].charAt(0)!=="!"){t.state.inLink=!0;const a={type:"link",raw:e,href:i,title:n,text:s,tokens:t.inlineTokens(s)};return t.state.inLink=!1,a}return{type:"image",raw:e,href:i,title:n,text:Ye(s)}}function ls(N,r){const e=N.match(/^(\s+)(?:```)/);if(e===null)return r;const t=e[1];return r.split(`
`).map(i=>{const n=i.match(/^\s+/);if(n===null)return i;const[s]=n;return s.length>=t.length?i.slice(t.length):i}).join(`
`)}class Ht{constructor(r){Ne(this,"options");Ne(this,"rules");Ne(this,"lexer");this.options=r||xt}space(r){const e=this.rules.block.newline.exec(r);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(r){const e=this.rules.block.code.exec(r);if(e){const t=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Pt(t,`
`)}}}fences(r){const e=this.rules.block.fences.exec(r);if(e){const t=e[0],i=ls(t,e[3]||"");return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(r){const e=this.rules.block.heading.exec(r);if(e){let t=e[2].trim();if(/#$/.test(t)){const i=Pt(t,"#");(this.options.pedantic||!i||/ $/.test(i))&&(t=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(r){const e=this.rules.block.hr.exec(r);if(e)return{type:"hr",raw:e[0]}}blockquote(r){const e=this.rules.block.blockquote.exec(r);if(e){let t=e[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);t=Pt(t.replace(/^ *>[ \t]?/gm,""),`
`);const i=this.lexer.state.top;this.lexer.state.top=!0;const n=this.lexer.blockTokens(t);return this.lexer.state.top=i,{type:"blockquote",raw:e[0],tokens:n,text:t}}}list(r){let e=this.rules.block.list.exec(r);if(e){let t=e[1].trim();const i=t.length>1,n={type:"list",raw:"",ordered:i,start:i?+t.slice(0,-1):"",loose:!1,items:[]};t=i?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=i?t:"[*+-]");const s=new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a="",c="",f=!1;for(;r;){let m=!1;if(!(e=s.exec(r))||this.rules.block.hr.test(r))break;a=e[0],r=r.substring(a.length);let g=e[2].split(`
`,1)[0].replace(/^\t+/,p=>" ".repeat(3*p.length)),b=r.split(`
`,1)[0],u=0;this.options.pedantic?(u=2,c=g.trimStart()):(u=e[2].search(/[^ ]/),u=u>4?1:u,c=g.slice(u),u+=e[1].length);let v=!1;if(!g&&/^ *$/.test(b)&&(a+=b+`
`,r=r.substring(b.length+1),m=!0),!m){const p=new RegExp(`^ {0,${Math.min(3,u-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),_=new RegExp(`^ {0,${Math.min(3,u-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),S=new RegExp(`^ {0,${Math.min(3,u-1)}}(?:\`\`\`|~~~)`),A=new RegExp(`^ {0,${Math.min(3,u-1)}}#`);for(;r;){const T=r.split(`
`,1)[0];if(b=T,this.options.pedantic&&(b=b.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),S.test(b)||A.test(b)||p.test(b)||_.test(r))break;if(b.search(/[^ ]/)>=u||!b.trim())c+=`
`+b.slice(u);else{if(v||g.search(/[^ ]/)>=4||S.test(g)||A.test(g)||_.test(g))break;c+=`
`+b}!v&&!b.trim()&&(v=!0),a+=T+`
`,r=r.substring(T.length+1),g=b.slice(u)}}n.loose||(f?n.loose=!0:/\n *\n *$/.test(a)&&(f=!0));let h=null,w;this.options.gfm&&(h=/^\[[ xX]\] /.exec(c),h&&(w=h[0]!=="[ ] ",c=c.replace(/^\[[ xX]\] +/,""))),n.items.push({type:"list_item",raw:a,task:!!h,checked:w,loose:!1,text:c,tokens:[]}),n.raw+=a}n.items[n.items.length-1].raw=a.trimEnd(),n.items[n.items.length-1].text=c.trimEnd(),n.raw=n.raw.trimEnd();for(let m=0;m<n.items.length;m++)if(this.lexer.state.top=!1,n.items[m].tokens=this.lexer.blockTokens(n.items[m].text,[]),!n.loose){const g=n.items[m].tokens.filter(u=>u.type==="space"),b=g.length>0&&g.some(u=>/\n.*\n/.test(u.raw));n.loose=b}if(n.loose)for(let m=0;m<n.items.length;m++)n.items[m].loose=!0;return n}}html(r){const e=this.rules.block.html.exec(r);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(r){const e=this.rules.block.def.exec(r);if(e){const t=e[1].toLowerCase().replace(/\s+/g," "),i=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:i,title:n}}}table(r){const e=this.rules.block.table.exec(r);if(!e||!/[:|]/.test(e[2]))return;const t=Br(e[1]),i=e[2].replace(/^\||\| *$/g,"").split("|"),n=e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===i.length){for(const a of i)/^ *-+: *$/.test(a)?s.align.push("right"):/^ *:-+: *$/.test(a)?s.align.push("center"):/^ *:-+ *$/.test(a)?s.align.push("left"):s.align.push(null);for(const a of t)s.header.push({text:a,tokens:this.lexer.inline(a)});for(const a of n)s.rows.push(Br(a,s.header.length).map(c=>({text:c,tokens:this.lexer.inline(c)})));return s}}lheading(r){const e=this.rules.block.lheading.exec(r);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(r){const e=this.rules.block.paragraph.exec(r);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(r){const e=this.rules.block.text.exec(r);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(r){const e=this.rules.inline.escape.exec(r);if(e)return{type:"escape",raw:e[0],text:Ye(e[1])}}tag(r){const e=this.rules.inline.tag.exec(r);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(r){const e=this.rules.inline.link.exec(r);if(e){const t=e[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t))return;const s=Pt(t.slice(0,-1),"\\");if((t.length-s.length)%2===0)return}else{const s=os(e[2],"()");if(s>-1){const c=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let i=e[2],n="";if(this.options.pedantic){const s=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);s&&(i=s[1],n=s[3])}else n=e[3]?e[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(t)?i=i.slice(1):i=i.slice(1,-1)),Ur(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer)}}reflink(r,e){let t;if((t=this.rules.inline.reflink.exec(r))||(t=this.rules.inline.nolink.exec(r))){const i=(t[2]||t[1]).replace(/\s+/g," "),n=e[i.toLowerCase()];if(!n){const s=t[0].charAt(0);return{type:"text",raw:s,text:s}}return Ur(t,n,t[0],this.lexer)}}emStrong(r,e,t=""){let i=this.rules.inline.emStrongLDelim.exec(r);if(!i||i[3]&&t.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const s=[...i[0]].length-1;let a,c,f=s,m=0;const g=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(g.lastIndex=0,e=e.slice(-1*r.length+s);(i=g.exec(e))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(c=[...a].length,i[3]||i[4]){f+=c;continue}else if((i[5]||i[6])&&s%3&&!((s+c)%3)){m+=c;continue}if(f-=c,f>0)continue;c=Math.min(c,c+f+m);const b=[...i[0]][0].length,u=r.slice(0,s+i.index+b+c);if(Math.min(s,c)%2){const h=u.slice(1,-1);return{type:"em",raw:u,text:h,tokens:this.lexer.inlineTokens(h)}}const v=u.slice(2,-2);return{type:"strong",raw:u,text:v,tokens:this.lexer.inlineTokens(v)}}}}codespan(r){const e=this.rules.inline.code.exec(r);if(e){let t=e[2].replace(/\n/g," ");const i=/[^ ]/.test(t),n=/^ /.test(t)&&/ $/.test(t);return i&&n&&(t=t.substring(1,t.length-1)),t=Ye(t,!0),{type:"codespan",raw:e[0],text:t}}}br(r){const e=this.rules.inline.br.exec(r);if(e)return{type:"br",raw:e[0]}}del(r){const e=this.rules.inline.del.exec(r);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(r){const e=this.rules.inline.autolink.exec(r);if(e){let t,i;return e[2]==="@"?(t=Ye(e[1]),i="mailto:"+t):(t=Ye(e[1]),i=t),{type:"link",raw:e[0],text:t,href:i,tokens:[{type:"text",raw:t,text:t}]}}}url(r){var t;let e;if(e=this.rules.inline.url.exec(r)){let i,n;if(e[2]==="@")i=Ye(e[0]),n="mailto:"+i;else{let s;do s=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(s!==e[0]);i=Ye(e[0]),e[1]==="www."?n="http://"+e[0]:n=e[0]}return{type:"link",raw:e[0],text:i,href:n,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(r){const e=this.rules.inline.text.exec(r);if(e){let t;return this.lexer.state.inRawBlock?t=e[0]:t=Ye(e[0]),{type:"text",raw:e[0],text:t}}}}const cs=/^(?: *(?:\n|$))+/,ds=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,us=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Rt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,hs=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,on=/(?:[*+-]|\d{1,9}[.)])/,ln=Ee(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,on).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),xr=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,fs=/^[^\n]+/,br=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ps=Ee(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",br).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ms=Ee(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,on).getRegex(),Kt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",wr=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,gs=Ee("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",wr).replace("tag",Kt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),cn=Ee(xr).replace("hr",Rt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kt).getRegex(),xs=Ee(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",cn).getRegex(),vr={blockquote:xs,code:ds,def:ps,fences:us,heading:hs,hr:Rt,html:gs,lheading:ln,list:ms,newline:cs,paragraph:cn,table:Tt,text:fs},Fr=Ee("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Rt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kt).getRegex(),bs={...vr,table:Fr,paragraph:Ee(xr).replace("hr",Rt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Fr).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kt).getRegex()},ws={...vr,html:Ee(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",wr).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Tt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ee(xr).replace("hr",Rt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ln).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},dn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,vs=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,un=/^( {2,}|\\)\n(?!\s*$)/,ys=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,zt="\\p{P}\\p{S}",_s=Ee(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,zt).getRegex(),ks=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Ss=Ee(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,zt).getRegex(),Ns=Ee("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,zt).getRegex(),Es=Ee("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,zt).getRegex(),js=Ee(/\\([punct])/,"gu").replace(/punct/g,zt).getRegex(),Ts=Ee(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),As=Ee(wr).replace("(?:-->|$)","-->").getRegex(),Cs=Ee("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",As).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Zt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Is=Ee(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Zt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),hn=Ee(/^!?\[(label)\]\[(ref)\]/).replace("label",Zt).replace("ref",br).getRegex(),fn=Ee(/^!?\[(ref)\](?:\[\])?/).replace("ref",br).getRegex(),Rs=Ee("reflink|nolink(?!\\()","g").replace("reflink",hn).replace("nolink",fn).getRegex(),yr={_backpedal:Tt,anyPunctuation:js,autolink:Ts,blockSkip:ks,br:un,code:vs,del:Tt,emStrongLDelim:Ss,emStrongRDelimAst:Ns,emStrongRDelimUnd:Es,escape:dn,link:Is,nolink:fn,punctuation:_s,reflink:hn,reflinkSearch:Rs,tag:Cs,text:ys,url:Tt},zs={...yr,link:Ee(/^!?\[(label)\]\((.*?)\)/).replace("label",Zt).getRegex(),reflink:Ee(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Zt).getRegex()},cr={...yr,escape:Ee(dn).replace("])","~|])").getRegex(),url:Ee(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Os={...cr,br:Ee(un).replace("{2,}","*").getRegex(),text:Ee(cr.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Mt={normal:vr,gfm:bs,pedantic:ws},_t={normal:yr,gfm:cr,breaks:Os,pedantic:zs};class at{constructor(r){Ne(this,"tokens");Ne(this,"options");Ne(this,"state");Ne(this,"tokenizer");Ne(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=r||xt,this.options.tokenizer=this.options.tokenizer||new Ht,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const e={block:Mt.normal,inline:_t.normal};this.options.pedantic?(e.block=Mt.pedantic,e.inline=_t.pedantic):this.options.gfm&&(e.block=Mt.gfm,this.options.breaks?e.inline=_t.breaks:e.inline=_t.gfm),this.tokenizer.rules=e}static get rules(){return{block:Mt,inline:_t}}static lex(r,e){return new at(e).lex(r)}static lexInline(r,e){return new at(e).inlineTokens(r)}lex(r){r=r.replace(/\r\n|\r/g,`
`),this.blockTokens(r,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(r,e=[]){this.options.pedantic?r=r.replace(/\t/g,"    ").replace(/^ +$/gm,""):r=r.replace(/^( *)(\t+)/gm,(a,c,f)=>c+"    ".repeat(f.length));let t,i,n,s;for(;r;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(t=a.call({lexer:this},r,e))?(r=r.substring(t.raw.length),e.push(t),!0):!1))){if(t=this.tokenizer.space(r)){r=r.substring(t.raw.length),t.raw.length===1&&e.length>0?e[e.length-1].raw+=`
`:e.push(t);continue}if(t=this.tokenizer.code(r)){r=r.substring(t.raw.length),i=e[e.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+t.raw,i.text+=`
`+t.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(t);continue}if(t=this.tokenizer.fences(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.heading(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.hr(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.blockquote(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.list(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.html(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.def(r)){r=r.substring(t.raw.length),i=e[e.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+t.raw,i.text+=`
`+t.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[t.tag]||(this.tokens.links[t.tag]={href:t.href,title:t.title});continue}if(t=this.tokenizer.table(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.lheading(r)){r=r.substring(t.raw.length),e.push(t);continue}if(n=r,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=r.slice(1);let f;this.options.extensions.startBlock.forEach(m=>{f=m.call({lexer:this},c),typeof f=="number"&&f>=0&&(a=Math.min(a,f))}),a<1/0&&a>=0&&(n=r.substring(0,a+1))}if(this.state.top&&(t=this.tokenizer.paragraph(n))){i=e[e.length-1],s&&i.type==="paragraph"?(i.raw+=`
`+t.raw,i.text+=`
`+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(t),s=n.length!==r.length,r=r.substring(t.raw.length);continue}if(t=this.tokenizer.text(r)){r=r.substring(t.raw.length),i=e[e.length-1],i&&i.type==="text"?(i.raw+=`
`+t.raw,i.text+=`
`+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(t);continue}if(r){const a="Infinite loop on byte: "+r.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,e}inline(r,e=[]){return this.inlineQueue.push({src:r,tokens:e}),e}inlineTokens(r,e=[]){let t,i,n,s=r,a,c,f;if(this.tokens.links){const m=Object.keys(this.tokens.links);if(m.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)m.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,a.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;r;)if(c||(f=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(m=>(t=m.call({lexer:this},r,e))?(r=r.substring(t.raw.length),e.push(t),!0):!1))){if(t=this.tokenizer.escape(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.tag(r)){r=r.substring(t.raw.length),i=e[e.length-1],i&&t.type==="text"&&i.type==="text"?(i.raw+=t.raw,i.text+=t.text):e.push(t);continue}if(t=this.tokenizer.link(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.reflink(r,this.tokens.links)){r=r.substring(t.raw.length),i=e[e.length-1],i&&t.type==="text"&&i.type==="text"?(i.raw+=t.raw,i.text+=t.text):e.push(t);continue}if(t=this.tokenizer.emStrong(r,s,f)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.codespan(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.br(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.del(r)){r=r.substring(t.raw.length),e.push(t);continue}if(t=this.tokenizer.autolink(r)){r=r.substring(t.raw.length),e.push(t);continue}if(!this.state.inLink&&(t=this.tokenizer.url(r))){r=r.substring(t.raw.length),e.push(t);continue}if(n=r,this.options.extensions&&this.options.extensions.startInline){let m=1/0;const g=r.slice(1);let b;this.options.extensions.startInline.forEach(u=>{b=u.call({lexer:this},g),typeof b=="number"&&b>=0&&(m=Math.min(m,b))}),m<1/0&&m>=0&&(n=r.substring(0,m+1))}if(t=this.tokenizer.inlineText(n)){r=r.substring(t.raw.length),t.raw.slice(-1)!=="_"&&(f=t.raw.slice(-1)),c=!0,i=e[e.length-1],i&&i.type==="text"?(i.raw+=t.raw,i.text+=t.text):e.push(t);continue}if(r){const m="Infinite loop on byte: "+r.charCodeAt(0);if(this.options.silent){console.error(m);break}else throw new Error(m)}}return e}}class Gt{constructor(r){Ne(this,"options");this.options=r||xt}code(r,e,t){var n;const i=(n=(e||"").match(/^\S*/))==null?void 0:n[0];return r=r.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+Ye(i)+'">'+(t?r:Ye(r,!0))+`</code></pre>
`:"<pre><code>"+(t?r:Ye(r,!0))+`</code></pre>
`}blockquote(r){return`<blockquote>
${r}</blockquote>
`}html(r,e){return r}heading(r,e,t){return`<h${e}>${r}</h${e}>
`}hr(){return`<hr>
`}list(r,e,t){const i=e?"ol":"ul",n=e&&t!==1?' start="'+t+'"':"";return"<"+i+n+`>
`+r+"</"+i+`>
`}listitem(r,e,t){return`<li>${r}</li>
`}checkbox(r){return"<input "+(r?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(r){return`<p>${r}</p>
`}table(r,e){return e&&(e=`<tbody>${e}</tbody>`),`<table>
<thead>
`+r+`</thead>
`+e+`</table>
`}tablerow(r){return`<tr>
${r}</tr>
`}tablecell(r,e){const t=e.header?"th":"td";return(e.align?`<${t} align="${e.align}">`:`<${t}>`)+r+`</${t}>
`}strong(r){return`<strong>${r}</strong>`}em(r){return`<em>${r}</em>`}codespan(r){return`<code>${r}</code>`}br(){return"<br>"}del(r){return`<del>${r}</del>`}link(r,e,t){const i=Mr(r);if(i===null)return t;r=i;let n='<a href="'+r+'"';return e&&(n+=' title="'+e+'"'),n+=">"+t+"</a>",n}image(r,e,t){const i=Mr(r);if(i===null)return t;r=i;let n=`<img src="${r}" alt="${t}"`;return e&&(n+=` title="${e}"`),n+=">",n}text(r){return r}}class _r{strong(r){return r}em(r){return r}codespan(r){return r}del(r){return r}html(r){return r}text(r){return r}link(r,e,t){return""+t}image(r,e,t){return""+t}br(){return""}}class ot{constructor(r){Ne(this,"options");Ne(this,"renderer");Ne(this,"textRenderer");this.options=r||xt,this.options.renderer=this.options.renderer||new Gt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new _r}static parse(r,e){return new ot(e).parse(r)}static parseInline(r,e){return new ot(e).parseInline(r)}parse(r,e=!0){let t="";for(let i=0;i<r.length;i++){const n=r[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]){const s=n,a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(s.type)){t+=a||"";continue}}switch(n.type){case"space":continue;case"hr":{t+=this.renderer.hr();continue}case"heading":{const s=n;t+=this.renderer.heading(this.parseInline(s.tokens),s.depth,is(this.parseInline(s.tokens,this.textRenderer)));continue}case"code":{const s=n;t+=this.renderer.code(s.text,s.lang,!!s.escaped);continue}case"table":{const s=n;let a="",c="";for(let m=0;m<s.header.length;m++)c+=this.renderer.tablecell(this.parseInline(s.header[m].tokens),{header:!0,align:s.align[m]});a+=this.renderer.tablerow(c);let f="";for(let m=0;m<s.rows.length;m++){const g=s.rows[m];c="";for(let b=0;b<g.length;b++)c+=this.renderer.tablecell(this.parseInline(g[b].tokens),{header:!1,align:s.align[b]});f+=this.renderer.tablerow(c)}t+=this.renderer.table(a,f);continue}case"blockquote":{const s=n,a=this.parse(s.tokens);t+=this.renderer.blockquote(a);continue}case"list":{const s=n,a=s.ordered,c=s.start,f=s.loose;let m="";for(let g=0;g<s.items.length;g++){const b=s.items[g],u=b.checked,v=b.task;let h="";if(b.task){const w=this.renderer.checkbox(!!u);f?b.tokens.length>0&&b.tokens[0].type==="paragraph"?(b.tokens[0].text=w+" "+b.tokens[0].text,b.tokens[0].tokens&&b.tokens[0].tokens.length>0&&b.tokens[0].tokens[0].type==="text"&&(b.tokens[0].tokens[0].text=w+" "+b.tokens[0].tokens[0].text)):b.tokens.unshift({type:"text",text:w+" "}):h+=w+" "}h+=this.parse(b.tokens,f),m+=this.renderer.listitem(h,v,!!u)}t+=this.renderer.list(m,a,c);continue}case"html":{const s=n;t+=this.renderer.html(s.text,s.block);continue}case"paragraph":{const s=n;t+=this.renderer.paragraph(this.parseInline(s.tokens));continue}case"text":{let s=n,a=s.tokens?this.parseInline(s.tokens):s.text;for(;i+1<r.length&&r[i+1].type==="text";)s=r[++i],a+=`
`+(s.tokens?this.parseInline(s.tokens):s.text);t+=e?this.renderer.paragraph(a):a;continue}default:{const s='Token with "'+n.type+'" type was not found.';if(this.options.silent)return console.error(s),"";throw new Error(s)}}}return t}parseInline(r,e){e=e||this.renderer;let t="";for(let i=0;i<r.length;i++){const n=r[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]){const s=this.options.extensions.renderers[n.type].call({parser:this},n);if(s!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(n.type)){t+=s||"";continue}}switch(n.type){case"escape":{const s=n;t+=e.text(s.text);break}case"html":{const s=n;t+=e.html(s.text);break}case"link":{const s=n;t+=e.link(s.href,s.title,this.parseInline(s.tokens,e));break}case"image":{const s=n;t+=e.image(s.href,s.title,s.text);break}case"strong":{const s=n;t+=e.strong(this.parseInline(s.tokens,e));break}case"em":{const s=n;t+=e.em(this.parseInline(s.tokens,e));break}case"codespan":{const s=n;t+=e.codespan(s.text);break}case"br":{t+=e.br();break}case"del":{const s=n;t+=e.del(this.parseInline(s.tokens,e));break}case"text":{const s=n;t+=e.text(s.text);break}default:{const s='Token with "'+n.type+'" type was not found.';if(this.options.silent)return console.error(s),"";throw new Error(s)}}}return t}}class At{constructor(r){Ne(this,"options");this.options=r||xt}preprocess(r){return r}postprocess(r){return r}processAllTokens(r){return r}}Ne(At,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var gt,dr,pn;class Ds{constructor(...r){Ir(this,gt);Ne(this,"defaults",gr());Ne(this,"options",this.setOptions);Ne(this,"parse",Dt(this,gt,dr).call(this,at.lex,ot.parse));Ne(this,"parseInline",Dt(this,gt,dr).call(this,at.lexInline,ot.parseInline));Ne(this,"Parser",ot);Ne(this,"Renderer",Gt);Ne(this,"TextRenderer",_r);Ne(this,"Lexer",at);Ne(this,"Tokenizer",Ht);Ne(this,"Hooks",At);this.use(...r)}walkTokens(r,e){var i,n;let t=[];for(const s of r)switch(t=t.concat(e.call(this,s)),s.type){case"table":{const a=s;for(const c of a.header)t=t.concat(this.walkTokens(c.tokens,e));for(const c of a.rows)for(const f of c)t=t.concat(this.walkTokens(f.tokens,e));break}case"list":{const a=s;t=t.concat(this.walkTokens(a.items,e));break}default:{const a=s;(n=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&n[a.type]?this.defaults.extensions.childTokens[a.type].forEach(c=>{const f=a[c].flat(1/0);t=t.concat(this.walkTokens(f,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}use(...r){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return r.forEach(t=>{const i={...t};if(i.async=this.defaults.async||i.async||!1,t.extensions&&(t.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){const s=e.renderers[n.name];s?e.renderers[n.name]=function(...a){let c=n.renderer.apply(this,a);return c===!1&&(c=s.apply(this,a)),c}:e.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=e[n.level];s?s.unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),i.extensions=e),t.renderer){const n=this.defaults.renderer||new Gt(this.defaults);for(const s in t.renderer){if(!(s in n))throw new Error(`renderer '${s}' does not exist`);if(s==="options")continue;const a=s,c=t.renderer[a],f=n[a];n[a]=(...m)=>{let g=c.apply(n,m);return g===!1&&(g=f.apply(n,m)),g||""}}i.renderer=n}if(t.tokenizer){const n=this.defaults.tokenizer||new Ht(this.defaults);for(const s in t.tokenizer){if(!(s in n))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const a=s,c=t.tokenizer[a],f=n[a];n[a]=(...m)=>{let g=c.apply(n,m);return g===!1&&(g=f.apply(n,m)),g}}i.tokenizer=n}if(t.hooks){const n=this.defaults.hooks||new At;for(const s in t.hooks){if(!(s in n))throw new Error(`hook '${s}' does not exist`);if(s==="options")continue;const a=s,c=t.hooks[a],f=n[a];At.passThroughHooks.has(s)?n[a]=m=>{if(this.defaults.async)return Promise.resolve(c.call(n,m)).then(b=>f.call(n,b));const g=c.call(n,m);return f.call(n,g)}:n[a]=(...m)=>{let g=c.apply(n,m);return g===!1&&(g=f.apply(n,m)),g}}i.hooks=n}if(t.walkTokens){const n=this.defaults.walkTokens,s=t.walkTokens;i.walkTokens=function(a){let c=[];return c.push(s.call(this,a)),n&&(c=c.concat(n.call(this,a))),c}}this.defaults={...this.defaults,...i}}),this}setOptions(r){return this.defaults={...this.defaults,...r},this}lexer(r,e){return at.lex(r,e??this.defaults)}parser(r,e){return ot.parse(r,e??this.defaults)}}gt=new WeakSet,dr=function(r,e){return(t,i)=>{const n={...i},s={...this.defaults,...n};this.defaults.async===!0&&n.async===!1&&(s.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),s.async=!0);const a=Dt(this,gt,pn).call(this,!!s.silent,!!s.async);if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(s.hooks&&(s.hooks.options=s),s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(t):t).then(c=>r(c,s)).then(c=>s.hooks?s.hooks.processAllTokens(c):c).then(c=>s.walkTokens?Promise.all(this.walkTokens(c,s.walkTokens)).then(()=>c):c).then(c=>e(c,s)).then(c=>s.hooks?s.hooks.postprocess(c):c).catch(a);try{s.hooks&&(t=s.hooks.preprocess(t));let c=r(t,s);s.hooks&&(c=s.hooks.processAllTokens(c)),s.walkTokens&&this.walkTokens(c,s.walkTokens);let f=e(c,s);return s.hooks&&(f=s.hooks.postprocess(f)),f}catch(c){return a(c)}}},pn=function(r,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,r){const i="<p>An error occurred:</p><pre>"+Ye(t.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(t);throw t}};const mt=new Ds;function ke(N,r){return mt.parse(N,r)}ke.options=ke.setOptions=function(N){return mt.setOptions(N),ke.defaults=mt.defaults,nn(ke.defaults),ke};ke.getDefaults=gr;ke.defaults=xt;ke.use=function(...N){return mt.use(...N),ke.defaults=mt.defaults,nn(ke.defaults),ke};ke.walkTokens=function(N,r){return mt.walkTokens(N,r)};ke.parseInline=mt.parseInline;ke.Parser=ot;ke.parser=ot.parse;ke.Renderer=Gt;ke.TextRenderer=_r;ke.Lexer=at;ke.lexer=at.lex;ke.Tokenizer=Ht;ke.Hooks=At;ke.parse=ke;ke.options;ke.setOptions;ke.use;ke.walkTokens;ke.parseInline;ot.parse;at.lex;/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:mn,setPrototypeOf:$r,isFrozen:Ls,getPrototypeOf:Ps,getOwnPropertyDescriptor:Ms}=Object;let{freeze:Ze,seal:Xe,create:ur}=Object,{apply:hr,construct:fr}=typeof Reflect<"u"&&Reflect;Ze||(Ze=function(r){return r});Xe||(Xe=function(r){return r});hr||(hr=function(r,e){for(var t=arguments.length,i=new Array(t>2?t-2:0),n=2;n<t;n++)i[n-2]=arguments[n];return r.apply(e,i)});fr||(fr=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return new r(...t)});const Bt=Ge(Array.prototype.forEach),Bs=Ge(Array.prototype.lastIndexOf),Wr=Ge(Array.prototype.pop),kt=Ge(Array.prototype.push),Us=Ge(Array.prototype.splice),$t=Ge(String.prototype.toLowerCase),tr=Ge(String.prototype.toString),rr=Ge(String.prototype.match),St=Ge(String.prototype.replace),Fs=Ge(String.prototype.indexOf),$s=Ge(String.prototype.trim),Je=Ge(Object.prototype.hasOwnProperty),He=Ge(RegExp.prototype.test),Nt=Ws(TypeError);function Ge(N){return function(r){r instanceof RegExp&&(r.lastIndex=0);for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return hr(N,r,t)}}function Ws(N){return function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return fr(N,e)}}function me(N,r){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$t;$r&&$r(N,null);let t=r.length;for(;t--;){let i=r[t];if(typeof i=="string"){const n=e(i);n!==i&&(Ls(r)||(r[t]=n),i=n)}N[i]=!0}return N}function Hs(N){for(let r=0;r<N.length;r++)Je(N,r)||(N[r]=null);return N}function ut(N){const r=ur(null);for(const[e,t]of mn(N))Je(N,e)&&(Array.isArray(t)?r[e]=Hs(t):t&&typeof t=="object"&&t.constructor===Object?r[e]=ut(t):r[e]=t);return r}function Et(N,r){for(;N!==null;){const t=Ms(N,r);if(t){if(t.get)return Ge(t.get);if(typeof t.value=="function")return Ge(t.value)}N=Ps(N)}function e(){return null}return e}const Hr=Ze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),nr=Ze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),sr=Ze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Zs=Ze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ir=Ze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Gs=Ze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Zr=Ze(["#text"]),Gr=Ze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ar=Ze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),qr=Ze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ut=Ze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qs=Xe(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ys=Xe(/<%[\w\W]*|[\w\W]*%>/gm),Ks=Xe(/\$\{[\w\W]*/gm),Xs=Xe(/^data-[\-\w.\u00B7-\uFFFF]+$/),Vs=Xe(/^aria-[\-\w]+$/),gn=Xe(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Js=Xe(/^(?:\w+script|data):/i),Qs=Xe(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),xn=Xe(/^html$/i),ei=Xe(/^[a-z][.\w]*(-[.\w]+)+$/i);var Yr=Object.freeze({__proto__:null,ARIA_ATTR:Vs,ATTR_WHITESPACE:Qs,CUSTOM_ELEMENT:ei,DATA_ATTR:Xs,DOCTYPE_NAME:xn,ERB_EXPR:Ys,IS_ALLOWED_URI:gn,IS_SCRIPT_OR_DATA:Js,MUSTACHE_EXPR:qs,TMPLIT_EXPR:Ks});const jt={element:1,text:3,progressingInstruction:7,comment:8,document:9},ti=function(){return typeof window>"u"?null:window},ri=function(r,e){if(typeof r!="object"||typeof r.createPolicy!="function")return null;let t=null;const i="data-tt-policy-suffix";e&&e.hasAttribute(i)&&(t=e.getAttribute(i));const n="dompurify"+(t?"#"+t:"");try{return r.createPolicy(n,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+n+" could not be created."),null}},Kr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function bn(){let N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ti();const r=ie=>bn(ie);if(r.version="3.3.0",r.removed=[],!N||!N.document||N.document.nodeType!==jt.document||!N.Element)return r.isSupported=!1,r;let{document:e}=N;const t=e,i=t.currentScript,{DocumentFragment:n,HTMLTemplateElement:s,Node:a,Element:c,NodeFilter:f,NamedNodeMap:m=N.NamedNodeMap||N.MozNamedAttrMap,HTMLFormElement:g,DOMParser:b,trustedTypes:u}=N,v=c.prototype,h=Et(v,"cloneNode"),w=Et(v,"remove"),p=Et(v,"nextSibling"),_=Et(v,"childNodes"),S=Et(v,"parentNode");if(typeof s=="function"){const ie=e.createElement("template");ie.content&&ie.content.ownerDocument&&(e=ie.content.ownerDocument)}let A,T="";const{implementation:U,createNodeIterator:M,createDocumentFragment:Z,getElementsByTagName:L}=e,{importNode:Y}=t;let J=Kr();r.isSupported=typeof mn=="function"&&typeof S=="function"&&U&&U.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:k,ERB_EXPR:P,TMPLIT_EXPR:d,DATA_ATTR:z,ARIA_ATTR:te,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:le,CUSTOM_ELEMENT:G}=Yr;let{IS_ALLOWED_URI:ae}=Yr,I=null;const O=me({},[...Hr,...nr,...sr,...ir,...Zr]);let ee=null;const V=me({},[...Gr,...ar,...qr,...Ut]);let $=Object.seal(ur(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ye=null,Se=null;const ue=Object.seal(ur(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let fe=!0,Te=!0,de=!1,We=!0,je=!1,o=!0,B=!1,D=!1,y=!1,x=!1,j=!1,F=!1,H=!0,R=!1;const K="user-content-";let Q=!0,q=!1,re={},be=null;const he=me({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Le=null;const Qe=me({},["audio","video","img","source","image","track"]);let Ue=null;const et=me({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),_e="http://www.w3.org/1998/Math/MathML",Ve="http://www.w3.org/2000/svg",Pe="http://www.w3.org/1999/xhtml";let De=Pe,ht=!1,tt=null;const bt=me({},[_e,Ve,Pe],tr);let rt=me({},["mi","mo","mn","ms","mtext"]),lt=me({},["annotation-xml"]);const nt=me({},["title","style","font","a","script"]);let C=null;const se=["application/xhtml+xml","text/html"],oe="text/html";let ce=null,ve=null;const we=e.createElement("form"),Ae=function(E){return E instanceof RegExp||E instanceof Function},ze=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ve&&ve===E)){if((!E||typeof E!="object")&&(E={}),E=ut(E),C=se.indexOf(E.PARSER_MEDIA_TYPE)===-1?oe:E.PARSER_MEDIA_TYPE,ce=C==="application/xhtml+xml"?tr:$t,I=Je(E,"ALLOWED_TAGS")?me({},E.ALLOWED_TAGS,ce):O,ee=Je(E,"ALLOWED_ATTR")?me({},E.ALLOWED_ATTR,ce):V,tt=Je(E,"ALLOWED_NAMESPACES")?me({},E.ALLOWED_NAMESPACES,tr):bt,Ue=Je(E,"ADD_URI_SAFE_ATTR")?me(ut(et),E.ADD_URI_SAFE_ATTR,ce):et,Le=Je(E,"ADD_DATA_URI_TAGS")?me(ut(Qe),E.ADD_DATA_URI_TAGS,ce):Qe,be=Je(E,"FORBID_CONTENTS")?me({},E.FORBID_CONTENTS,ce):he,ye=Je(E,"FORBID_TAGS")?me({},E.FORBID_TAGS,ce):ut({}),Se=Je(E,"FORBID_ATTR")?me({},E.FORBID_ATTR,ce):ut({}),re=Je(E,"USE_PROFILES")?E.USE_PROFILES:!1,fe=E.ALLOW_ARIA_ATTR!==!1,Te=E.ALLOW_DATA_ATTR!==!1,de=E.ALLOW_UNKNOWN_PROTOCOLS||!1,We=E.ALLOW_SELF_CLOSE_IN_ATTR!==!1,je=E.SAFE_FOR_TEMPLATES||!1,o=E.SAFE_FOR_XML!==!1,B=E.WHOLE_DOCUMENT||!1,x=E.RETURN_DOM||!1,j=E.RETURN_DOM_FRAGMENT||!1,F=E.RETURN_TRUSTED_TYPE||!1,y=E.FORCE_BODY||!1,H=E.SANITIZE_DOM!==!1,R=E.SANITIZE_NAMED_PROPS||!1,Q=E.KEEP_CONTENT!==!1,q=E.IN_PLACE||!1,ae=E.ALLOWED_URI_REGEXP||gn,De=E.NAMESPACE||Pe,rt=E.MATHML_TEXT_INTEGRATION_POINTS||rt,lt=E.HTML_INTEGRATION_POINTS||lt,$=E.CUSTOM_ELEMENT_HANDLING||{},E.CUSTOM_ELEMENT_HANDLING&&Ae(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&($.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&Ae(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&($.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&($.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),je&&(Te=!1),j&&(x=!0),re&&(I=me({},Zr),ee=[],re.html===!0&&(me(I,Hr),me(ee,Gr)),re.svg===!0&&(me(I,nr),me(ee,ar),me(ee,Ut)),re.svgFilters===!0&&(me(I,sr),me(ee,ar),me(ee,Ut)),re.mathMl===!0&&(me(I,ir),me(ee,qr),me(ee,Ut))),E.ADD_TAGS&&(typeof E.ADD_TAGS=="function"?ue.tagCheck=E.ADD_TAGS:(I===O&&(I=ut(I)),me(I,E.ADD_TAGS,ce))),E.ADD_ATTR&&(typeof E.ADD_ATTR=="function"?ue.attributeCheck=E.ADD_ATTR:(ee===V&&(ee=ut(ee)),me(ee,E.ADD_ATTR,ce))),E.ADD_URI_SAFE_ATTR&&me(Ue,E.ADD_URI_SAFE_ATTR,ce),E.FORBID_CONTENTS&&(be===he&&(be=ut(be)),me(be,E.FORBID_CONTENTS,ce)),Q&&(I["#text"]=!0),B&&me(I,["html","head","body"]),I.table&&(me(I,["tbody"]),delete ye.tbody),E.TRUSTED_TYPES_POLICY){if(typeof E.TRUSTED_TYPES_POLICY.createHTML!="function")throw Nt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof E.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Nt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=E.TRUSTED_TYPES_POLICY,T=A.createHTML("")}else A===void 0&&(A=ri(u,i)),A!==null&&typeof T=="string"&&(T=A.createHTML(""));Ze&&Ze(E),ve=E}},xe=me({},[...nr,...sr,...Zs]),Re=me({},[...ir,...Gs]),ft=function(E){let X=S(E);(!X||!X.tagName)&&(X={namespaceURI:De,tagName:"template"});const ne=$t(E.tagName),Ce=$t(X.tagName);return tt[E.namespaceURI]?E.namespaceURI===Ve?X.namespaceURI===Pe?ne==="svg":X.namespaceURI===_e?ne==="svg"&&(Ce==="annotation-xml"||rt[Ce]):!!xe[ne]:E.namespaceURI===_e?X.namespaceURI===Pe?ne==="math":X.namespaceURI===Ve?ne==="math"&&lt[Ce]:!!Re[ne]:E.namespaceURI===Pe?X.namespaceURI===Ve&&!lt[Ce]||X.namespaceURI===_e&&!rt[Ce]?!1:!Re[ne]&&(nt[ne]||!xe[ne]):!!(C==="application/xhtml+xml"&&tt[E.namespaceURI]):!1},Ie=function(E){kt(r.removed,{element:E});try{S(E).removeChild(E)}catch{w(E)}},Ke=function(E,X){try{kt(r.removed,{attribute:X.getAttributeNode(E),from:X})}catch{kt(r.removed,{attribute:null,from:X})}if(X.removeAttribute(E),E==="is")if(x||j)try{Ie(X)}catch{}else try{X.setAttribute(E,"")}catch{}},Xt=function(E){let X=null,ne=null;if(y)E="<remove></remove>"+E;else{const Oe=rr(E,/^[\r\n\t ]+/);ne=Oe&&Oe[0]}C==="application/xhtml+xml"&&De===Pe&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");const Ce=A?A.createHTML(E):E;if(De===Pe)try{X=new b().parseFromString(Ce,C)}catch{}if(!X||!X.documentElement){X=U.createDocument(De,"template",null);try{X.documentElement.innerHTML=ht?T:Ce}catch{}}const Fe=X.body||X.documentElement;return E&&ne&&Fe.insertBefore(e.createTextNode(ne),Fe.childNodes[0]||null),De===Pe?L.call(X,B?"html":"body")[0]:B?X.documentElement:Fe},Ot=function(E){return M.call(E.ownerDocument||E,E,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},Vt=function(E){return E instanceof g&&(typeof E.nodeName!="string"||typeof E.textContent!="string"||typeof E.removeChild!="function"||!(E.attributes instanceof m)||typeof E.removeAttribute!="function"||typeof E.setAttribute!="function"||typeof E.namespaceURI!="string"||typeof E.insertBefore!="function"||typeof E.hasChildNodes!="function")},kr=function(E){return typeof a=="function"&&E instanceof a};function ct(ie,E,X){Bt(ie,ne=>{ne.call(r,E,X,ve)})}const Sr=function(E){let X=null;if(ct(J.beforeSanitizeElements,E,null),Vt(E))return Ie(E),!0;const ne=ce(E.nodeName);if(ct(J.uponSanitizeElement,E,{tagName:ne,allowedTags:I}),o&&E.hasChildNodes()&&!kr(E.firstElementChild)&&He(/<[/\w!]/g,E.innerHTML)&&He(/<[/\w!]/g,E.textContent)||E.nodeType===jt.progressingInstruction||o&&E.nodeType===jt.comment&&He(/<[/\w]/g,E.data))return Ie(E),!0;if(!(ue.tagCheck instanceof Function&&ue.tagCheck(ne))&&(!I[ne]||ye[ne])){if(!ye[ne]&&Er(ne)&&($.tagNameCheck instanceof RegExp&&He($.tagNameCheck,ne)||$.tagNameCheck instanceof Function&&$.tagNameCheck(ne)))return!1;if(Q&&!be[ne]){const Ce=S(E)||E.parentNode,Fe=_(E)||E.childNodes;if(Fe&&Ce){const Oe=Fe.length;for(let qe=Oe-1;qe>=0;--qe){const dt=h(Fe[qe],!0);dt.__removalCount=(E.__removalCount||0)+1,Ce.insertBefore(dt,p(E))}}}return Ie(E),!0}return E instanceof c&&!ft(E)||(ne==="noscript"||ne==="noembed"||ne==="noframes")&&He(/<\/no(script|embed|frames)/i,E.innerHTML)?(Ie(E),!0):(je&&E.nodeType===jt.text&&(X=E.textContent,Bt([k,P,d],Ce=>{X=St(X,Ce," ")}),E.textContent!==X&&(kt(r.removed,{element:E.cloneNode()}),E.textContent=X)),ct(J.afterSanitizeElements,E,null),!1)},Nr=function(E,X,ne){if(H&&(X==="id"||X==="name")&&(ne in e||ne in we))return!1;if(!(Te&&!Se[X]&&He(z,X))){if(!(fe&&He(te,X))){if(!(ue.attributeCheck instanceof Function&&ue.attributeCheck(X,E))){if(!ee[X]||Se[X]){if(!(Er(E)&&($.tagNameCheck instanceof RegExp&&He($.tagNameCheck,E)||$.tagNameCheck instanceof Function&&$.tagNameCheck(E))&&($.attributeNameCheck instanceof RegExp&&He($.attributeNameCheck,X)||$.attributeNameCheck instanceof Function&&$.attributeNameCheck(X,E))||X==="is"&&$.allowCustomizedBuiltInElements&&($.tagNameCheck instanceof RegExp&&He($.tagNameCheck,ne)||$.tagNameCheck instanceof Function&&$.tagNameCheck(ne))))return!1}else if(!Ue[X]){if(!He(ae,St(ne,le,""))){if(!((X==="src"||X==="xlink:href"||X==="href")&&E!=="script"&&Fs(ne,"data:")===0&&Le[E])){if(!(de&&!He(W,St(ne,le,"")))){if(ne)return!1}}}}}}}return!0},Er=function(E){return E!=="annotation-xml"&&rr(E,G)},jr=function(E){ct(J.beforeSanitizeAttributes,E,null);const{attributes:X}=E;if(!X||Vt(E))return;const ne={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ee,forceKeepAttr:void 0};let Ce=X.length;for(;Ce--;){const Fe=X[Ce],{name:Oe,namespaceURI:qe,value:dt}=Fe,wt=ce(Oe),Jt=dt;let Me=Oe==="value"?Jt:$s(Jt);if(ne.attrName=wt,ne.attrValue=Me,ne.keepAttr=!0,ne.forceKeepAttr=void 0,ct(J.uponSanitizeAttribute,E,ne),Me=ne.attrValue,R&&(wt==="id"||wt==="name")&&(Ke(Oe,E),Me=K+Me),o&&He(/((--!?|])>)|<\/(style|title|textarea)/i,Me)){Ke(Oe,E);continue}if(wt==="attributename"&&rr(Me,"href")){Ke(Oe,E);continue}if(ne.forceKeepAttr)continue;if(!ne.keepAttr){Ke(Oe,E);continue}if(!We&&He(/\/>/i,Me)){Ke(Oe,E);continue}je&&Bt([k,P,d],Ar=>{Me=St(Me,Ar," ")});const Tr=ce(E.nodeName);if(!Nr(Tr,wt,Me)){Ke(Oe,E);continue}if(A&&typeof u=="object"&&typeof u.getAttributeType=="function"&&!qe)switch(u.getAttributeType(Tr,wt)){case"TrustedHTML":{Me=A.createHTML(Me);break}case"TrustedScriptURL":{Me=A.createScriptURL(Me);break}}if(Me!==Jt)try{qe?E.setAttributeNS(qe,Oe,Me):E.setAttribute(Oe,Me),Vt(E)?Ie(E):Wr(r.removed)}catch{Ke(Oe,E)}}ct(J.afterSanitizeAttributes,E,null)},vn=function ie(E){let X=null;const ne=Ot(E);for(ct(J.beforeSanitizeShadowDOM,E,null);X=ne.nextNode();)ct(J.uponSanitizeShadowNode,X,null),Sr(X),jr(X),X.content instanceof n&&ie(X.content);ct(J.afterSanitizeShadowDOM,E,null)};return r.sanitize=function(ie){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=null,ne=null,Ce=null,Fe=null;if(ht=!ie,ht&&(ie="<!-->"),typeof ie!="string"&&!kr(ie))if(typeof ie.toString=="function"){if(ie=ie.toString(),typeof ie!="string")throw Nt("dirty is not a string, aborting")}else throw Nt("toString is not a function");if(!r.isSupported)return ie;if(D||ze(E),r.removed=[],typeof ie=="string"&&(q=!1),q){if(ie.nodeName){const dt=ce(ie.nodeName);if(!I[dt]||ye[dt])throw Nt("root node is forbidden and cannot be sanitized in-place")}}else if(ie instanceof a)X=Xt("<!---->"),ne=X.ownerDocument.importNode(ie,!0),ne.nodeType===jt.element&&ne.nodeName==="BODY"||ne.nodeName==="HTML"?X=ne:X.appendChild(ne);else{if(!x&&!je&&!B&&ie.indexOf("<")===-1)return A&&F?A.createHTML(ie):ie;if(X=Xt(ie),!X)return x?null:F?T:""}X&&y&&Ie(X.firstChild);const Oe=Ot(q?ie:X);for(;Ce=Oe.nextNode();)Sr(Ce),jr(Ce),Ce.content instanceof n&&vn(Ce.content);if(q)return ie;if(x){if(j)for(Fe=Z.call(X.ownerDocument);X.firstChild;)Fe.appendChild(X.firstChild);else Fe=X;return(ee.shadowroot||ee.shadowrootmode)&&(Fe=Y.call(t,Fe,!0)),Fe}let qe=B?X.outerHTML:X.innerHTML;return B&&I["!doctype"]&&X.ownerDocument&&X.ownerDocument.doctype&&X.ownerDocument.doctype.name&&He(xn,X.ownerDocument.doctype.name)&&(qe="<!DOCTYPE "+X.ownerDocument.doctype.name+`>
`+qe),je&&Bt([k,P,d],dt=>{qe=St(qe,dt," ")}),A&&F?A.createHTML(qe):qe},r.setConfig=function(){let ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ze(ie),D=!0},r.clearConfig=function(){ve=null,D=!1},r.isValidAttribute=function(ie,E,X){ve||ze({});const ne=ce(ie),Ce=ce(E);return Nr(ne,Ce,X)},r.addHook=function(ie,E){typeof E=="function"&&kt(J[ie],E)},r.removeHook=function(ie,E){if(E!==void 0){const X=Bs(J[ie],E);return X===-1?void 0:Us(J[ie],X,1)[0]}return Wr(J[ie])},r.removeHooks=function(ie){J[ie]=[]},r.removeAllHooks=function(){J=Kr()},r}var ni=bn();ke.setOptions({gfm:!0,breaks:!0});const si=N=>N.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ii=`**太字テキスト** と *斜体テキスト*、そして \`インラインコード\`。

> ブロック引用: 雨上がりの匂いが、彼女の記憶を呼び起こした。

- 箇条書き1
- 箇条書き2
  - ネスト1
  - ネスト2

1. 番号付きリスト
2. 二行目

[リンク例](https://example.com) と ![画像例](https://placehold.co/100x60)。

| 列A | 列B | 列C |
| --- | --- | --- |
| 太字 | *斜体* | \`コード\` |

\`\`\`ts
function greet(name: string) {
  console.log(\`こんにちは、\${name}さん\`)
}
\`\`\`

---
`,ai=N=>{const r=ke.parse(N,{async:!1});return ni.sanitize(r)},oi=N=>`<mark class="bg-yellow-100 text-gray-800 font-semibold px-1 rounded-sm" data-dictionary-term="${N}">$1</mark>`,li=(N,r)=>{if(!N||!r.length)return N;const e=r.map(c=>{var f;return(f=c.term)==null?void 0:f.trim()}).filter(c=>!!c);if(e.length===0)return N;const t=c=>e.reduce((f,m)=>{const g=new RegExp(`(${si(m)})`,"gi");return f.replace(g,oi(m))},c);if(typeof window>"u"||typeof window.DOMParser>"u")return t(N);const n=new window.DOMParser().parseFromString(N,"text/html"),s=n.createTreeWalker(n.body,NodeFilter.SHOW_TEXT),a=[];for(;s.nextNode();)a.push(s.currentNode);return a.forEach(c=>{const f=c.nodeValue??"",m=t(f);if(f!==m){const g=n.createElement("span");g.innerHTML=m,c.replaceWith(...Array.from(g.childNodes))}}),n.body.innerHTML},ci=/^(#+)\s+(.*)$/,Wt=N=>{const r=N.split(`
`),e=[];return r.forEach((t,i)=>{const n=t.trim().match(ci);n&&e.push({id:`section-${i}`,level:n[1].length,text:n[2],startLine:i,endLine:r.length})}),e.forEach((t,i)=>{const n=e.slice(i+1).find(s=>s.level<=t.level);t.endLine=n?n.startLine:r.length}),e.length===0&&N.trim().length>0&&e.push({id:"section-0",level:1,text:N.trim().split(`
`).slice(0,3).join(" "),startLine:0,endLine:r.length}),e},di=(N,r,e)=>{if(r===e)return N;const t=N.split(`
`),i=Wt(N),n=i.findIndex(b=>b.id===r),s=i.findIndex(b=>b.id===e);if(n===-1||s===-1)return N;const a=i[n],c=i[s],f=a.endLine-a.startLine,m=t.slice(a.startLine,a.endLine);t.splice(a.startLine,f);const g=n<s?Math.max(0,c.startLine-f):c.startLine;return t.splice(g,0,...m),t.join(`
`)};function Ft(N){throw new Error('Could not dynamically require "'+N+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(N,r){(function(e){N.exports=e()})(function(){return function e(t,i,n){function s(f,m){if(!i[f]){if(!t[f]){var g=typeof Ft=="function"&&Ft;if(!m&&g)return g(f,!0);if(a)return a(f,!0);var b=new Error("Cannot find module '"+f+"'");throw b.code="MODULE_NOT_FOUND",b}var u=i[f]={exports:{}};t[f][0].call(u.exports,function(v){var h=t[f][1][v];return s(h||v)},u,u.exports,e,t,i,n)}return i[f].exports}for(var a=typeof Ft=="function"&&Ft,c=0;c<n.length;c++)s(n[c]);return s}({1:[function(e,t,i){var n=e("./utils"),s=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var f,m,g,b,u,v,h,w=[],p=0,_=c.length,S=_,A=n.getTypeOf(c)!=="string";p<c.length;)S=_-p,g=A?(f=c[p++],m=p<_?c[p++]:0,p<_?c[p++]:0):(f=c.charCodeAt(p++),m=p<_?c.charCodeAt(p++):0,p<_?c.charCodeAt(p++):0),b=f>>2,u=(3&f)<<4|m>>4,v=1<S?(15&m)<<2|g>>6:64,h=2<S?63&g:64,w.push(a.charAt(b)+a.charAt(u)+a.charAt(v)+a.charAt(h));return w.join("")},i.decode=function(c){var f,m,g,b,u,v,h=0,w=0,p="data:";if(c.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var _,S=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&S--,c.charAt(c.length-2)===a.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=s.uint8array?new Uint8Array(0|S):new Array(0|S);h<c.length;)f=a.indexOf(c.charAt(h++))<<2|(b=a.indexOf(c.charAt(h++)))>>4,m=(15&b)<<4|(u=a.indexOf(c.charAt(h++)))>>2,g=(3&u)<<6|(v=a.indexOf(c.charAt(h++))),_[w++]=f,u!==64&&(_[w++]=m),v!==64&&(_[w++]=g);return _}},{"./support":30,"./utils":32}],2:[function(e,t,i){var n=e("./external"),s=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),c=e("./stream/DataLengthProbe");function f(m,g,b,u,v){this.compressedSize=m,this.uncompressedSize=g,this.crc32=b,this.compression=u,this.compressedContent=v}f.prototype={getContentWorker:function(){var m=new s(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),g=this;return m.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new s(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(m,g,b){return m.pipe(new a).pipe(new c("uncompressedSize")).pipe(g.compressWorker(b)).pipe(new c("compressedSize")).withStreamInfo("compression",g)},t.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){var n=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){var n=e("./utils"),s=function(){for(var a,c=[],f=0;f<256;f++){a=f;for(var m=0;m<8;m++)a=1&a?3988292384^a>>>1:a>>>1;c[f]=a}return c}();t.exports=function(a,c){return a!==void 0&&a.length?n.getTypeOf(a)!=="string"?function(f,m,g,b){var u=s,v=b+g;f^=-1;for(var h=b;h<v;h++)f=f>>>8^u[255&(f^m[h])];return-1^f}(0|c,a,a.length,0):function(f,m,g,b){var u=s,v=b+g;f^=-1;for(var h=b;h<v;h++)f=f>>>8^u[255&(f^m.charCodeAt(h))];return-1^f}(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(e,t,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){var n=null;n=typeof Promise<"u"?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=e("pako"),a=e("./utils"),c=e("./stream/GenericWorker"),f=n?"uint8array":"array";function m(g,b){c.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=b,this.meta={}}i.magic="\b\0",a.inherits(m,c),m.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(f,g.data),!1)},m.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(b){g.push({data:b,meta:g.meta})}},i.compressWorker=function(g){return new m("Deflate",g)},i.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){function n(u,v){var h,w="";for(h=0;h<v;h++)w+=String.fromCharCode(255&u),u>>>=8;return w}function s(u,v,h,w,p,_){var S,A,T=u.file,U=u.compression,M=_!==f.utf8encode,Z=a.transformTo("string",_(T.name)),L=a.transformTo("string",f.utf8encode(T.name)),Y=T.comment,J=a.transformTo("string",_(Y)),k=a.transformTo("string",f.utf8encode(Y)),P=L.length!==T.name.length,d=k.length!==Y.length,z="",te="",W="",le=T.dir,G=T.date,ae={crc32:0,compressedSize:0,uncompressedSize:0};v&&!h||(ae.crc32=u.crc32,ae.compressedSize=u.compressedSize,ae.uncompressedSize=u.uncompressedSize);var I=0;v&&(I|=8),M||!P&&!d||(I|=2048);var O=0,ee=0;le&&(O|=16),p==="UNIX"?(ee=798,O|=function($,ye){var Se=$;return $||(Se=ye?16893:33204),(65535&Se)<<16}(T.unixPermissions,le)):(ee=20,O|=function($){return 63&($||0)}(T.dosPermissions)),S=G.getUTCHours(),S<<=6,S|=G.getUTCMinutes(),S<<=5,S|=G.getUTCSeconds()/2,A=G.getUTCFullYear()-1980,A<<=4,A|=G.getUTCMonth()+1,A<<=5,A|=G.getUTCDate(),P&&(te=n(1,1)+n(m(Z),4)+L,z+="up"+n(te.length,2)+te),d&&(W=n(1,1)+n(m(J),4)+k,z+="uc"+n(W.length,2)+W);var V="";return V+=`
\0`,V+=n(I,2),V+=U.magic,V+=n(S,2),V+=n(A,2),V+=n(ae.crc32,4),V+=n(ae.compressedSize,4),V+=n(ae.uncompressedSize,4),V+=n(Z.length,2),V+=n(z.length,2),{fileRecord:g.LOCAL_FILE_HEADER+V+Z+z,dirRecord:g.CENTRAL_FILE_HEADER+n(ee,2)+V+n(J.length,2)+"\0\0\0\0"+n(O,4)+n(w,4)+Z+z+J}}var a=e("../utils"),c=e("../stream/GenericWorker"),f=e("../utf8"),m=e("../crc32"),g=e("../signature");function b(u,v,h,w){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=h,this.encodeFileName=w,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(b,c),b.prototype.push=function(u){var v=u.meta.percent||0,h=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,c.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:h?(v+100*(h-w-1))/h:100}}))},b.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var v=this.streamFiles&&!u.file.dir;if(v){var h=s(u,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(u){this.accumulate=!1;var v=this.streamFiles&&!u.file.dir,h=s(u,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),v)this.push({data:function(w){return g.DATA_DESCRIPTOR+n(w.crc32,4)+n(w.compressedSize,4)+n(w.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var u=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var h=this.bytesWritten-u,w=function(p,_,S,A,T){var U=a.transformTo("string",T(A));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(p,2)+n(p,2)+n(_,4)+n(S,4)+n(U.length,2)+U}(this.dirRecords.length,h,u,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(u){this._sources.push(u);var v=this;return u.on("data",function(h){v.processChunk(h)}),u.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),u.on("error",function(h){v.error(h)}),this},b.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},b.prototype.error=function(u){var v=this._sources;if(!c.prototype.error.call(this,u))return!1;for(var h=0;h<v.length;h++)try{v[h].error(u)}catch{}return!0},b.prototype.lock=function(){c.prototype.lock.call(this);for(var u=this._sources,v=0;v<u.length;v++)u[v].lock()},t.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){var n=e("../compressions"),s=e("./ZipFileWorker");i.generateWorker=function(a,c,f){var m=new s(c.streamFiles,f,c.platform,c.encodeFileName),g=0;try{a.forEach(function(b,u){g++;var v=function(_,S){var A=_||S,T=n[A];if(!T)throw new Error(A+" is not a valid compression method !");return T}(u.options.compression,c.compression),h=u.options.compressionOptions||c.compressionOptions||{},w=u.dir,p=u.date;u._compressWorker(v,h).withStreamInfo("file",{name:b,dir:w,date:p,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(m)}),m.entriesCount=g}catch(b){m.error(b)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new n;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(s,a){return new n().loadAsync(s,a)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){var n=e("./utils"),s=e("./external"),a=e("./utf8"),c=e("./zipEntries"),f=e("./stream/Crc32Probe"),m=e("./nodejsUtils");function g(b){return new s.Promise(function(u,v){var h=b.decompressed.getContentWorker().pipe(new f);h.on("error",function(w){v(w)}).on("end",function(){h.streamInfo.crc32!==b.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}t.exports=function(b,u){var v=this;return u=n.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),m.isNode&&m.isStream(b)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",b,!0,u.optimizedBinaryString,u.base64).then(function(h){var w=new c(u);return w.load(h),w}).then(function(h){var w=[s.Promise.resolve(h)],p=h.files;if(u.checkCRC32)for(var _=0;_<p.length;_++)w.push(g(p[_]));return s.Promise.all(w)}).then(function(h){for(var w=h.shift(),p=w.files,_=0;_<p.length;_++){var S=p[_],A=S.fileNameStr,T=n.resolve(S.fileNameStr);v.file(T,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:u.createFolders}),S.dir||(v.file(T).unsafeOriginalName=A)}return w.zipComment.length&&(v.comment=w.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){var n=e("../utils"),s=e("../stream/GenericWorker");function a(c,f){s.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(f)}n.inherits(a,s),a.prototype._bindStream=function(c){var f=this;(this._stream=c).pause(),c.on("data",function(m){f.push({data:m,meta:{percent:0}})}).on("error",function(m){f.isPaused?this.generatedError=m:f.error(m)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){var n=e("readable-stream").Readable;function s(a,c,f){n.call(this,c),this._helper=a;var m=this;a.on("data",function(g,b){m.push(g)||m._helper.pause(),f&&f(b)}).on("error",function(g){m.emit("error",g)}).on("end",function(){m.push(null)})}e("../utils").inherits(s,n),s.prototype._read=function(){this._helper.resume()},t.exports=s},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){t.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,s);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,s)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var s=new Buffer(n);return s.fill(0),s},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(e,t,i){function n(T,U,M){var Z,L=a.getTypeOf(U),Y=a.extend(M||{},m);Y.date=Y.date||new Date,Y.compression!==null&&(Y.compression=Y.compression.toUpperCase()),typeof Y.unixPermissions=="string"&&(Y.unixPermissions=parseInt(Y.unixPermissions,8)),Y.unixPermissions&&16384&Y.unixPermissions&&(Y.dir=!0),Y.dosPermissions&&16&Y.dosPermissions&&(Y.dir=!0),Y.dir&&(T=p(T)),Y.createFolders&&(Z=w(T))&&_.call(this,Z,!0);var J=L==="string"&&Y.binary===!1&&Y.base64===!1;M&&M.binary!==void 0||(Y.binary=!J),(U instanceof g&&U.uncompressedSize===0||Y.dir||!U||U.length===0)&&(Y.base64=!1,Y.binary=!0,U="",Y.compression="STORE",L="string");var k=null;k=U instanceof g||U instanceof c?U:v.isNode&&v.isStream(U)?new h(T,U):a.prepareContent(T,U,Y.binary,Y.optimizedBinaryString,Y.base64);var P=new b(T,k,Y);this.files[T]=P}var s=e("./utf8"),a=e("./utils"),c=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),m=e("./defaults"),g=e("./compressedObject"),b=e("./zipObject"),u=e("./generate"),v=e("./nodejsUtils"),h=e("./nodejs/NodejsStreamInputAdapter"),w=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var U=T.lastIndexOf("/");return 0<U?T.substring(0,U):""},p=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},_=function(T,U){return U=U!==void 0?U:m.createFolders,T=p(T),this.files[T]||n.call(this,T,null,{dir:!0,createFolders:U}),this.files[T]};function S(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var A={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var U,M,Z;for(U in this.files)Z=this.files[U],(M=U.slice(this.root.length,U.length))&&U.slice(0,this.root.length)===this.root&&T(M,Z)},filter:function(T){var U=[];return this.forEach(function(M,Z){T(M,Z)&&U.push(Z)}),U},file:function(T,U,M){if(arguments.length!==1)return T=this.root+T,n.call(this,T,U,M),this;if(S(T)){var Z=T;return this.filter(function(Y,J){return!J.dir&&Z.test(Y)})}var L=this.files[this.root+T];return L&&!L.dir?L:null},folder:function(T){if(!T)return this;if(S(T))return this.filter(function(L,Y){return Y.dir&&T.test(L)});var U=this.root+T,M=_.call(this,U),Z=this.clone();return Z.root=M.name,Z},remove:function(T){T=this.root+T;var U=this.files[T];if(U||(T.slice(-1)!=="/"&&(T+="/"),U=this.files[T]),U&&!U.dir)delete this.files[T];else for(var M=this.filter(function(L,Y){return Y.name.slice(0,T.length)===T}),Z=0;Z<M.length;Z++)delete this.files[M[Z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var U,M={};try{if((M=a.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=M.type.toLowerCase(),M.compression=M.compression.toUpperCase(),M.type==="binarystring"&&(M.type="string"),!M.type)throw new Error("No output type specified.");a.checkSupport(M.type),M.platform!=="darwin"&&M.platform!=="freebsd"&&M.platform!=="linux"&&M.platform!=="sunos"||(M.platform="UNIX"),M.platform==="win32"&&(M.platform="DOS");var Z=M.comment||this.comment||"";U=u.generateWorker(this,M,Z)}catch(L){(U=new c("error")).error(L)}return new f(U,M.type||"string",M.mimeType)},generateAsync:function(T,U){return this.generateInternalStream(T).accumulate(U)},generateNodeStream:function(T,U){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(U)}};t.exports=A},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){var n=e("./DataReader");function s(a){n.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}e("../utils").inherits(s,n),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),f=a.charCodeAt(1),m=a.charCodeAt(2),g=a.charCodeAt(3),b=this.length-4;0<=b;--b)if(this.data[b]===c&&this.data[b+1]===f&&this.data[b+2]===m&&this.data[b+3]===g)return b-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),f=a.charCodeAt(1),m=a.charCodeAt(2),g=a.charCodeAt(3),b=this.readData(4);return c===b[0]&&f===b[1]&&m===b[2]&&g===b[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},t.exports=s},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){var n=e("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,f=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)f=(f<<8)+this.byteAt(c);return this.index+=a,f},readString:function(a){return n.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},t.exports=s},{"../utils":32}],19:[function(e,t,i){var n=e("./Uint8ArrayReader");function s(a){n.call(this,a)}e("../utils").inherits(s,n),s.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},t.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){var n=e("./DataReader");function s(a){n.call(this,a)}e("../utils").inherits(s,n),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},t.exports=s},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){var n=e("./ArrayReader");function s(a){n.call(this,a)}e("../utils").inherits(s,n),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},t.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){var n=e("../utils"),s=e("../support"),a=e("./ArrayReader"),c=e("./StringReader"),f=e("./NodeBufferReader"),m=e("./Uint8ArrayReader");t.exports=function(g){var b=n.getTypeOf(g);return n.checkSupport(b),b!=="string"||s.uint8array?b==="nodebuffer"?new f(g):s.uint8array?new m(n.transformTo("uint8array",g)):new a(n.transformTo("array",g)):new c(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,i){var n=e("./GenericWorker"),s=e("../utils");function a(c){n.call(this,"ConvertWorker to "+c),this.destType=c}s.inherits(a,n),a.prototype.processChunk=function(c){this.push({data:s.transformTo(this.destType,c.data),meta:c.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){var n=e("./GenericWorker"),s=e("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,n),a.prototype.processChunk=function(c){this.streamInfo.crc32=s(c.data,this.streamInfo.crc32||0),this.push(c)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){var n=e("../utils"),s=e("./GenericWorker");function a(c){s.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}n.inherits(a,s),a.prototype.processChunk=function(c){if(c){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+c.data.length}s.prototype.processChunk.call(this,c)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){var n=e("../utils"),s=e("./GenericWorker");function a(c){s.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(m){f.dataIsReady=!0,f.data=m,f.max=m&&m.length||0,f.type=n.getTypeOf(m),f.isPaused||f._tickAndRepeat()},function(m){f.error(m)})}n.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,f);break;case"uint8array":c=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":c=this.data.slice(this.index,f)}return this.index=f,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){function n(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var c=0;c<this._listeners[s].length;c++)this._listeners[s][c].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(c){a.processChunk(c)}),s.on("end",function(){a.end()}),s.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},t.exports=n},{}],29:[function(e,t,i){var n=e("../utils"),s=e("./ConvertWorker"),a=e("./GenericWorker"),c=e("../base64"),f=e("../support"),m=e("../external"),g=null;if(f.nodestream)try{g=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(v,h){return new m.Promise(function(w,p){var _=[],S=v._internalType,A=v._outputType,T=v._mimeType;v.on("data",function(U,M){_.push(U),h&&h(M)}).on("error",function(U){_=[],p(U)}).on("end",function(){try{var U=function(M,Z,L){switch(M){case"blob":return n.newBlob(n.transformTo("arraybuffer",Z),L);case"base64":return c.encode(Z);default:return n.transformTo(M,Z)}}(A,function(M,Z){var L,Y=0,J=null,k=0;for(L=0;L<Z.length;L++)k+=Z[L].length;switch(M){case"string":return Z.join("");case"array":return Array.prototype.concat.apply([],Z);case"uint8array":for(J=new Uint8Array(k),L=0;L<Z.length;L++)J.set(Z[L],Y),Y+=Z[L].length;return J;case"nodebuffer":return Buffer.concat(Z);default:throw new Error("concat : unsupported type '"+M+"'")}}(S,_),T);w(U)}catch(M){p(M)}_=[]}).resume()})}function u(v,h,w){var p=h;switch(h){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=h,this._mimeType=w,n.checkSupport(p),this._worker=v.pipe(new s(p)),v.lock()}catch(_){this._worker=new a("error"),this._worker.error(_)}}u.prototype={accumulate:function(v){return b(this,v)},on:function(v,h){var w=this;return v==="data"?this._worker.on(v,function(p){h.call(w,p.data,p.meta)}):this._worker.on(v,function(){n.delay(h,arguments,w)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},v)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var n=new ArrayBuffer(0);try{i.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(n),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){for(var n=e("./utils"),s=e("./support"),a=e("./nodejsUtils"),c=e("./stream/GenericWorker"),f=new Array(256),m=0;m<256;m++)f[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;f[254]=f[254]=1;function g(){c.call(this,"utf-8 decode"),this.leftOver=null}function b(){c.call(this,"utf-8 encode")}i.utf8encode=function(u){return s.nodebuffer?a.newBufferFrom(u,"utf-8"):function(v){var h,w,p,_,S,A=v.length,T=0;for(_=0;_<A;_++)(64512&(w=v.charCodeAt(_)))==55296&&_+1<A&&(64512&(p=v.charCodeAt(_+1)))==56320&&(w=65536+(w-55296<<10)+(p-56320),_++),T+=w<128?1:w<2048?2:w<65536?3:4;for(h=s.uint8array?new Uint8Array(T):new Array(T),_=S=0;S<T;_++)(64512&(w=v.charCodeAt(_)))==55296&&_+1<A&&(64512&(p=v.charCodeAt(_+1)))==56320&&(w=65536+(w-55296<<10)+(p-56320),_++),w<128?h[S++]=w:(w<2048?h[S++]=192|w>>>6:(w<65536?h[S++]=224|w>>>12:(h[S++]=240|w>>>18,h[S++]=128|w>>>12&63),h[S++]=128|w>>>6&63),h[S++]=128|63&w);return h}(u)},i.utf8decode=function(u){return s.nodebuffer?n.transformTo("nodebuffer",u).toString("utf-8"):function(v){var h,w,p,_,S=v.length,A=new Array(2*S);for(h=w=0;h<S;)if((p=v[h++])<128)A[w++]=p;else if(4<(_=f[p]))A[w++]=65533,h+=_-1;else{for(p&=_===2?31:_===3?15:7;1<_&&h<S;)p=p<<6|63&v[h++],_--;1<_?A[w++]=65533:p<65536?A[w++]=p:(p-=65536,A[w++]=55296|p>>10&1023,A[w++]=56320|1023&p)}return A.length!==w&&(A.subarray?A=A.subarray(0,w):A.length=w),n.applyFromCharCode(A)}(u=n.transformTo(s.uint8array?"uint8array":"array",u))},n.inherits(g,c),g.prototype.processChunk=function(u){var v=n.transformTo(s.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var h=v;(v=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),v.set(h,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var w=function(_,S){var A;for((S=S||_.length)>_.length&&(S=_.length),A=S-1;0<=A&&(192&_[A])==128;)A--;return A<0||A===0?S:A+f[_[A]]>S?A:S}(v),p=v;w!==v.length&&(s.uint8array?(p=v.subarray(0,w),this.leftOver=v.subarray(w,v.length)):(p=v.slice(0,w),this.leftOver=v.slice(w,v.length))),this.push({data:i.utf8decode(p),meta:u.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=g,n.inherits(b,c),b.prototype.processChunk=function(u){this.push({data:i.utf8encode(u.data),meta:u.meta})},i.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,i){var n=e("./support"),s=e("./base64"),a=e("./nodejsUtils"),c=e("./external");function f(h){return h}function m(h,w){for(var p=0;p<h.length;++p)w[p]=255&h.charCodeAt(p);return w}e("setimmediate"),i.newBlob=function(h,w){i.checkSupport("blob");try{return new Blob([h],{type:w})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(h),p.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(h,w,p){var _=[],S=0,A=h.length;if(A<=p)return String.fromCharCode.apply(null,h);for(;S<A;)w==="array"||w==="nodebuffer"?_.push(String.fromCharCode.apply(null,h.slice(S,Math.min(S+p,A)))):_.push(String.fromCharCode.apply(null,h.subarray(S,Math.min(S+p,A)))),S+=p;return _.join("")},stringifyByChar:function(h){for(var w="",p=0;p<h.length;p++)w+=String.fromCharCode(h[p]);return w},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function b(h){var w=65536,p=i.getTypeOf(h),_=!0;if(p==="uint8array"?_=g.applyCanBeUsed.uint8array:p==="nodebuffer"&&(_=g.applyCanBeUsed.nodebuffer),_)for(;1<w;)try{return g.stringifyByChunk(h,p,w)}catch{w=Math.floor(w/2)}return g.stringifyByChar(h)}function u(h,w){for(var p=0;p<h.length;p++)w[p]=h[p];return w}i.applyFromCharCode=b;var v={};v.string={string:f,array:function(h){return m(h,new Array(h.length))},arraybuffer:function(h){return v.string.uint8array(h).buffer},uint8array:function(h){return m(h,new Uint8Array(h.length))},nodebuffer:function(h){return m(h,a.allocBuffer(h.length))}},v.array={string:b,array:f,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a.newBufferFrom(h)}},v.arraybuffer={string:function(h){return b(new Uint8Array(h))},array:function(h){return u(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:f,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a.newBufferFrom(new Uint8Array(h))}},v.uint8array={string:b,array:function(h){return u(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:f,nodebuffer:function(h){return a.newBufferFrom(h)}},v.nodebuffer={string:b,array:function(h){return u(h,new Array(h.length))},arraybuffer:function(h){return v.nodebuffer.uint8array(h).buffer},uint8array:function(h){return u(h,new Uint8Array(h.length))},nodebuffer:f},i.transformTo=function(h,w){if(w=w||"",!h)return w;i.checkSupport(h);var p=i.getTypeOf(w);return v[p][h](w)},i.resolve=function(h){for(var w=h.split("/"),p=[],_=0;_<w.length;_++){var S=w[_];S==="."||S===""&&_!==0&&_!==w.length-1||(S===".."?p.pop():p.push(S))}return p.join("/")},i.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":n.nodebuffer&&a.isBuffer(h)?"nodebuffer":n.uint8array&&h instanceof Uint8Array?"uint8array":n.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(h){if(!n[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(h){var w,p,_="";for(p=0;p<(h||"").length;p++)_+="\\x"+((w=h.charCodeAt(p))<16?"0":"")+w.toString(16).toUpperCase();return _},i.delay=function(h,w,p){setImmediate(function(){h.apply(p||null,w||[])})},i.inherits=function(h,w){function p(){}p.prototype=w.prototype,h.prototype=new p},i.extend=function(){var h,w,p={};for(h=0;h<arguments.length;h++)for(w in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],w)&&p[w]===void 0&&(p[w]=arguments[h][w]);return p},i.prepareContent=function(h,w,p,_,S){return c.Promise.resolve(w).then(function(A){return n.blob&&(A instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(A))!==-1)&&typeof FileReader<"u"?new c.Promise(function(T,U){var M=new FileReader;M.onload=function(Z){T(Z.target.result)},M.onerror=function(Z){U(Z.target.error)},M.readAsArrayBuffer(A)}):A}).then(function(A){var T=i.getTypeOf(A);return T?(T==="arraybuffer"?A=i.transformTo("uint8array",A):T==="string"&&(S?A=s.decode(A):p&&_!==!0&&(A=function(U){return m(U,n.uint8array?new Uint8Array(U.length):new Array(U.length))}(A))),A):c.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,i){var n=e("./reader/readerFor"),s=e("./utils"),a=e("./signature"),c=e("./zipEntry"),f=e("./support");function m(g){this.files=[],this.loadOptions=g}m.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(b)+", expected "+s.pretty(g)+")")}},isSignature:function(g,b){var u=this.reader.index;this.reader.setIndex(g);var v=this.reader.readString(4)===b;return this.reader.setIndex(u),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),b=f.uint8array?"uint8array":"array",u=s.transformTo(b,g);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,b,u,v=this.zip64EndOfCentralSize-44;0<v;)g=this.reader.readInt(2),b=this.reader.readInt(4),u=this.reader.readData(b),this.zip64ExtensibleData[g]={id:g,length:b,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,b;for(g=0;g<this.files.length;g++)b=this.files[g],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(g=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var b=g;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var v=b-u;if(0<v)this.isSignature(b,a.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(g){this.reader=n(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){var n=e("./reader/readerFor"),s=e("./utils"),a=e("./compressedObject"),c=e("./crc32"),f=e("./utf8"),m=e("./compressions"),g=e("./support");function b(u,v){this.options=u,this.loadOptions=v}b.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var v,h;if(u.skip(22),this.fileNameLength=u.readInt(2),h=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(w){for(var p in m)if(Object.prototype.hasOwnProperty.call(m,p)&&m[p].magic===w)return m[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,v,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var v=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(v),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=n(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var v,h,w,p=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<p;)v=u.readInt(2),h=u.readInt(2),w=u.readData(h),this.extraFields[v]={id:v,length:h,value:w};u.setIndex(p)},handleUTF8:function(){var u=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var h=s.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var p=s.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var v=n(u.value);return v.readInt(1)!==1||c(this.fileName)!==v.readInt(4)?null:f.utf8decode(v.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var v=n(u.value);return v.readInt(1)!==1||c(this.fileComment)!==v.readInt(4)?null:f.utf8decode(v.readData(u.length-5))}return null}},t.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){function n(v,h,w){this.name=v,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=h,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var s=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),c=e("./utf8"),f=e("./compressedObject"),m=e("./stream/GenericWorker");n.prototype={internalStream:function(v){var h=null,w="string";try{if(!v)throw new Error("No output type specified.");var p=(w=v.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),h=this._decompressWorker();var _=!this._dataBinary;_&&!p&&(h=h.pipe(new c.Utf8EncodeWorker)),!_&&p&&(h=h.pipe(new c.Utf8DecodeWorker))}catch(S){(h=new m("error")).error(S)}return new s(h,w,"")},async:function(v,h){return this.internalStream(v).accumulate(h)},nodeStream:function(v,h){return this.internalStream(v||"nodebuffer").toNodejsStream(h)},_compressWorker:function(v,h){if(this._data instanceof f&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new c.Utf8EncodeWorker)),f.createWorkerFrom(w,v,h)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof m?this._data:new a(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<g.length;u++)n.prototype[g[u]]=b;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,i){(function(n){var s,a,c=n.MutationObserver||n.WebKitMutationObserver;if(c){var f=0,m=new c(v),g=n.document.createTextNode("");m.observe(g,{characterData:!0}),s=function(){g.data=f=++f%2}}else if(n.setImmediate||n.MessageChannel===void 0)s="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var h=n.document.createElement("script");h.onreadystatechange=function(){v(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},n.document.documentElement.appendChild(h)}:function(){setTimeout(v,0)};else{var b=new n.MessageChannel;b.port1.onmessage=v,s=function(){b.port2.postMessage(0)}}var u=[];function v(){var h,w;a=!0;for(var p=u.length;p;){for(w=u,u=[],h=-1;++h<p;)w[h]();p=u.length}a=!1}t.exports=function(h){u.push(h)!==1||a||s()}}).call(this,typeof Lt<"u"?Lt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,t,i){var n=e("immediate");function s(){}var a={},c=["REJECTED"],f=["FULFILLED"],m=["PENDING"];function g(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,p!==s&&h(this,p)}function b(p,_,S){this.promise=p,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function u(p,_,S){n(function(){var A;try{A=_(S)}catch(T){return a.reject(p,T)}A===p?a.reject(p,new TypeError("Cannot resolve promise with itself")):a.resolve(p,A)})}function v(p){var _=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof _=="function")return function(){_.apply(p,arguments)}}function h(p,_){var S=!1;function A(M){S||(S=!0,a.reject(p,M))}function T(M){S||(S=!0,a.resolve(p,M))}var U=w(function(){_(T,A)});U.status==="error"&&A(U.value)}function w(p,_){var S={};try{S.value=p(_),S.status="success"}catch(A){S.status="error",S.value=A}return S}(t.exports=g).prototype.finally=function(p){if(typeof p!="function")return this;var _=this.constructor;return this.then(function(S){return _.resolve(p()).then(function(){return S})},function(S){return _.resolve(p()).then(function(){throw S})})},g.prototype.catch=function(p){return this.then(null,p)},g.prototype.then=function(p,_){if(typeof p!="function"&&this.state===f||typeof _!="function"&&this.state===c)return this;var S=new this.constructor(s);return this.state!==m?u(S,this.state===f?p:_,this.outcome):this.queue.push(new b(S,p,_)),S},b.prototype.callFulfilled=function(p){a.resolve(this.promise,p)},b.prototype.otherCallFulfilled=function(p){u(this.promise,this.onFulfilled,p)},b.prototype.callRejected=function(p){a.reject(this.promise,p)},b.prototype.otherCallRejected=function(p){u(this.promise,this.onRejected,p)},a.resolve=function(p,_){var S=w(v,_);if(S.status==="error")return a.reject(p,S.value);var A=S.value;if(A)h(p,A);else{p.state=f,p.outcome=_;for(var T=-1,U=p.queue.length;++T<U;)p.queue[T].callFulfilled(_)}return p},a.reject=function(p,_){p.state=c,p.outcome=_;for(var S=-1,A=p.queue.length;++S<A;)p.queue[S].callRejected(_);return p},g.resolve=function(p){return p instanceof this?p:a.resolve(new this(s),p)},g.reject=function(p){var _=new this(s);return a.reject(_,p)},g.all=function(p){var _=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=p.length,A=!1;if(!S)return this.resolve([]);for(var T=new Array(S),U=0,M=-1,Z=new this(s);++M<S;)L(p[M],M);return Z;function L(Y,J){_.resolve(Y).then(function(k){T[J]=k,++U!==S||A||(A=!0,a.resolve(Z,T))},function(k){A||(A=!0,a.reject(Z,k))})}},g.race=function(p){var _=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=p.length,A=!1;if(!S)return this.resolve([]);for(var T=-1,U=new this(s);++T<S;)M=p[T],_.resolve(M).then(function(Z){A||(A=!0,a.resolve(U,Z))},function(Z){A||(A=!0,a.reject(U,Z))});var M;return U}},{immediate:36}],38:[function(e,t,i){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){var n=e("./zlib/deflate"),s=e("./utils/common"),a=e("./utils/strings"),c=e("./zlib/messages"),f=e("./zlib/zstream"),m=Object.prototype.toString,g=0,b=-1,u=0,v=8;function h(p){if(!(this instanceof h))return new h(p);this.options=s.assign({level:b,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},p||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var S=n.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(S!==g)throw new Error(c[S]);if(_.header&&n.deflateSetHeader(this.strm,_.header),_.dictionary){var A;if(A=typeof _.dictionary=="string"?a.string2buf(_.dictionary):m.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(S=n.deflateSetDictionary(this.strm,A))!==g)throw new Error(c[S]);this._dict_set=!0}}function w(p,_){var S=new h(_);if(S.push(p,!0),S.err)throw S.msg||c[S.err];return S.result}h.prototype.push=function(p,_){var S,A,T=this.strm,U=this.options.chunkSize;if(this.ended)return!1;A=_===~~_?_:_===!0?4:0,typeof p=="string"?T.input=a.string2buf(p):m.call(p)==="[object ArrayBuffer]"?T.input=new Uint8Array(p):T.input=p,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new s.Buf8(U),T.next_out=0,T.avail_out=U),(S=n.deflate(T,A))!==1&&S!==g)return this.onEnd(S),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||A!==4&&A!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(T.output,T.next_out))):this.onData(s.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&S!==1);return A===4?(S=n.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===g):A!==2||(this.onEnd(g),!(T.avail_out=0))},h.prototype.onData=function(p){this.chunks.push(p)},h.prototype.onEnd=function(p){p===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},i.Deflate=h,i.deflate=w,i.deflateRaw=function(p,_){return(_=_||{}).raw=!0,w(p,_)},i.gzip=function(p,_){return(_=_||{}).gzip=!0,w(p,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){var n=e("./zlib/inflate"),s=e("./utils/common"),a=e("./utils/strings"),c=e("./zlib/constants"),f=e("./zlib/messages"),m=e("./zlib/zstream"),g=e("./zlib/gzheader"),b=Object.prototype.toString;function u(h){if(!(this instanceof u))return new u(h);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},h||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||h&&h.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&!(15&w.windowBits)&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var p=n.inflateInit2(this.strm,w.windowBits);if(p!==c.Z_OK)throw new Error(f[p]);this.header=new g,n.inflateGetHeader(this.strm,this.header)}function v(h,w){var p=new u(w);if(p.push(h,!0),p.err)throw p.msg||f[p.err];return p.result}u.prototype.push=function(h,w){var p,_,S,A,T,U,M=this.strm,Z=this.options.chunkSize,L=this.options.dictionary,Y=!1;if(this.ended)return!1;_=w===~~w?w:w===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof h=="string"?M.input=a.binstring2buf(h):b.call(h)==="[object ArrayBuffer]"?M.input=new Uint8Array(h):M.input=h,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new s.Buf8(Z),M.next_out=0,M.avail_out=Z),(p=n.inflate(M,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&L&&(U=typeof L=="string"?a.string2buf(L):b.call(L)==="[object ArrayBuffer]"?new Uint8Array(L):L,p=n.inflateSetDictionary(this.strm,U)),p===c.Z_BUF_ERROR&&Y===!0&&(p=c.Z_OK,Y=!1),p!==c.Z_STREAM_END&&p!==c.Z_OK)return this.onEnd(p),!(this.ended=!0);M.next_out&&(M.avail_out!==0&&p!==c.Z_STREAM_END&&(M.avail_in!==0||_!==c.Z_FINISH&&_!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=a.utf8border(M.output,M.next_out),A=M.next_out-S,T=a.buf2string(M.output,S),M.next_out=A,M.avail_out=Z-A,A&&s.arraySet(M.output,M.output,S,A,0),this.onData(T)):this.onData(s.shrinkBuf(M.output,M.next_out)))),M.avail_in===0&&M.avail_out===0&&(Y=!0)}while((0<M.avail_in||M.avail_out===0)&&p!==c.Z_STREAM_END);return p===c.Z_STREAM_END&&(_=c.Z_FINISH),_===c.Z_FINISH?(p=n.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===c.Z_OK):_!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(M.avail_out=0))},u.prototype.onData=function(h){this.chunks.push(h)},u.prototype.onEnd=function(h){h===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},i.Inflate=u,i.inflate=v,i.inflateRaw=function(h,w){return(w=w||{}).raw=!0,v(h,w)},i.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var m=f.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var g in m)m.hasOwnProperty(g)&&(c[g]=m[g])}}return c},i.shrinkBuf=function(c,f){return c.length===f?c:c.subarray?c.subarray(0,f):(c.length=f,c)};var s={arraySet:function(c,f,m,g,b){if(f.subarray&&c.subarray)c.set(f.subarray(m,m+g),b);else for(var u=0;u<g;u++)c[b+u]=f[m+u]},flattenChunks:function(c){var f,m,g,b,u,v;for(f=g=0,m=c.length;f<m;f++)g+=c[f].length;for(v=new Uint8Array(g),f=b=0,m=c.length;f<m;f++)u=c[f],v.set(u,b),b+=u.length;return v}},a={arraySet:function(c,f,m,g,b){for(var u=0;u<g;u++)c[b+u]=f[m+u]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(n)},{}],42:[function(e,t,i){var n=e("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new n.Buf8(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function m(g,b){if(b<65537&&(g.subarray&&a||!g.subarray&&s))return String.fromCharCode.apply(null,n.shrinkBuf(g,b));for(var u="",v=0;v<b;v++)u+=String.fromCharCode(g[v]);return u}c[254]=c[254]=1,i.string2buf=function(g){var b,u,v,h,w,p=g.length,_=0;for(h=0;h<p;h++)(64512&(u=g.charCodeAt(h)))==55296&&h+1<p&&(64512&(v=g.charCodeAt(h+1)))==56320&&(u=65536+(u-55296<<10)+(v-56320),h++),_+=u<128?1:u<2048?2:u<65536?3:4;for(b=new n.Buf8(_),h=w=0;w<_;h++)(64512&(u=g.charCodeAt(h)))==55296&&h+1<p&&(64512&(v=g.charCodeAt(h+1)))==56320&&(u=65536+(u-55296<<10)+(v-56320),h++),u<128?b[w++]=u:(u<2048?b[w++]=192|u>>>6:(u<65536?b[w++]=224|u>>>12:(b[w++]=240|u>>>18,b[w++]=128|u>>>12&63),b[w++]=128|u>>>6&63),b[w++]=128|63&u);return b},i.buf2binstring=function(g){return m(g,g.length)},i.binstring2buf=function(g){for(var b=new n.Buf8(g.length),u=0,v=b.length;u<v;u++)b[u]=g.charCodeAt(u);return b},i.buf2string=function(g,b){var u,v,h,w,p=b||g.length,_=new Array(2*p);for(u=v=0;u<p;)if((h=g[u++])<128)_[v++]=h;else if(4<(w=c[h]))_[v++]=65533,u+=w-1;else{for(h&=w===2?31:w===3?15:7;1<w&&u<p;)h=h<<6|63&g[u++],w--;1<w?_[v++]=65533:h<65536?_[v++]=h:(h-=65536,_[v++]=55296|h>>10&1023,_[v++]=56320|1023&h)}return m(_,v)},i.utf8border=function(g,b){var u;for((b=b||g.length)>g.length&&(b=g.length),u=b-1;0<=u&&(192&g[u])==128;)u--;return u<0||u===0?b:u+c[g[u]]>b?u:b}},{"./common":41}],43:[function(e,t,i){t.exports=function(n,s,a,c){for(var f=65535&n|0,m=n>>>16&65535|0,g=0;a!==0;){for(a-=g=2e3<a?2e3:a;m=m+(f=f+s[c++]|0)|0,--g;);f%=65521,m%=65521}return f|m<<16|0}},{}],44:[function(e,t,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){var n=function(){for(var s,a=[],c=0;c<256;c++){s=c;for(var f=0;f<8;f++)s=1&s?3988292384^s>>>1:s>>>1;a[c]=s}return a}();t.exports=function(s,a,c,f){var m=n,g=f+c;s^=-1;for(var b=f;b<g;b++)s=s>>>8^m[255&(s^a[b])];return-1^s}},{}],46:[function(e,t,i){var n,s=e("../utils/common"),a=e("./trees"),c=e("./adler32"),f=e("./crc32"),m=e("./messages"),g=0,b=4,u=0,v=-2,h=-1,w=4,p=2,_=8,S=9,A=286,T=30,U=19,M=2*A+1,Z=15,L=3,Y=258,J=Y+L+1,k=42,P=113,d=1,z=2,te=3,W=4;function le(o,B){return o.msg=m[B],B}function G(o){return(o<<1)-(4<o?9:0)}function ae(o){for(var B=o.length;0<=--B;)o[B]=0}function I(o){var B=o.state,D=B.pending;D>o.avail_out&&(D=o.avail_out),D!==0&&(s.arraySet(o.output,B.pending_buf,B.pending_out,D,o.next_out),o.next_out+=D,B.pending_out+=D,o.total_out+=D,o.avail_out-=D,B.pending-=D,B.pending===0&&(B.pending_out=0))}function O(o,B){a._tr_flush_block(o,0<=o.block_start?o.block_start:-1,o.strstart-o.block_start,B),o.block_start=o.strstart,I(o.strm)}function ee(o,B){o.pending_buf[o.pending++]=B}function V(o,B){o.pending_buf[o.pending++]=B>>>8&255,o.pending_buf[o.pending++]=255&B}function $(o,B){var D,y,x=o.max_chain_length,j=o.strstart,F=o.prev_length,H=o.nice_match,R=o.strstart>o.w_size-J?o.strstart-(o.w_size-J):0,K=o.window,Q=o.w_mask,q=o.prev,re=o.strstart+Y,be=K[j+F-1],he=K[j+F];o.prev_length>=o.good_match&&(x>>=2),H>o.lookahead&&(H=o.lookahead);do if(K[(D=B)+F]===he&&K[D+F-1]===be&&K[D]===K[j]&&K[++D]===K[j+1]){j+=2,D++;do;while(K[++j]===K[++D]&&K[++j]===K[++D]&&K[++j]===K[++D]&&K[++j]===K[++D]&&K[++j]===K[++D]&&K[++j]===K[++D]&&K[++j]===K[++D]&&K[++j]===K[++D]&&j<re);if(y=Y-(re-j),j=re-Y,F<y){if(o.match_start=B,H<=(F=y))break;be=K[j+F-1],he=K[j+F]}}while((B=q[B&Q])>R&&--x!=0);return F<=o.lookahead?F:o.lookahead}function ye(o){var B,D,y,x,j,F,H,R,K,Q,q=o.w_size;do{if(x=o.window_size-o.lookahead-o.strstart,o.strstart>=q+(q-J)){for(s.arraySet(o.window,o.window,q,q,0),o.match_start-=q,o.strstart-=q,o.block_start-=q,B=D=o.hash_size;y=o.head[--B],o.head[B]=q<=y?y-q:0,--D;);for(B=D=q;y=o.prev[--B],o.prev[B]=q<=y?y-q:0,--D;);x+=q}if(o.strm.avail_in===0)break;if(F=o.strm,H=o.window,R=o.strstart+o.lookahead,K=x,Q=void 0,Q=F.avail_in,K<Q&&(Q=K),D=Q===0?0:(F.avail_in-=Q,s.arraySet(H,F.input,F.next_in,Q,R),F.state.wrap===1?F.adler=c(F.adler,H,Q,R):F.state.wrap===2&&(F.adler=f(F.adler,H,Q,R)),F.next_in+=Q,F.total_in+=Q,Q),o.lookahead+=D,o.lookahead+o.insert>=L)for(j=o.strstart-o.insert,o.ins_h=o.window[j],o.ins_h=(o.ins_h<<o.hash_shift^o.window[j+1])&o.hash_mask;o.insert&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[j+L-1])&o.hash_mask,o.prev[j&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=j,j++,o.insert--,!(o.lookahead+o.insert<L)););}while(o.lookahead<J&&o.strm.avail_in!==0)}function Se(o,B){for(var D,y;;){if(o.lookahead<J){if(ye(o),o.lookahead<J&&B===g)return d;if(o.lookahead===0)break}if(D=0,o.lookahead>=L&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+L-1])&o.hash_mask,D=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),D!==0&&o.strstart-D<=o.w_size-J&&(o.match_length=$(o,D)),o.match_length>=L)if(y=a._tr_tally(o,o.strstart-o.match_start,o.match_length-L),o.lookahead-=o.match_length,o.match_length<=o.max_lazy_match&&o.lookahead>=L){for(o.match_length--;o.strstart++,o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+L-1])&o.hash_mask,D=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart,--o.match_length!=0;);o.strstart++}else o.strstart+=o.match_length,o.match_length=0,o.ins_h=o.window[o.strstart],o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+1])&o.hash_mask;else y=a._tr_tally(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++;if(y&&(O(o,!1),o.strm.avail_out===0))return d}return o.insert=o.strstart<L-1?o.strstart:L-1,B===b?(O(o,!0),o.strm.avail_out===0?te:W):o.last_lit&&(O(o,!1),o.strm.avail_out===0)?d:z}function ue(o,B){for(var D,y,x;;){if(o.lookahead<J){if(ye(o),o.lookahead<J&&B===g)return d;if(o.lookahead===0)break}if(D=0,o.lookahead>=L&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+L-1])&o.hash_mask,D=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),o.prev_length=o.match_length,o.prev_match=o.match_start,o.match_length=L-1,D!==0&&o.prev_length<o.max_lazy_match&&o.strstart-D<=o.w_size-J&&(o.match_length=$(o,D),o.match_length<=5&&(o.strategy===1||o.match_length===L&&4096<o.strstart-o.match_start)&&(o.match_length=L-1)),o.prev_length>=L&&o.match_length<=o.prev_length){for(x=o.strstart+o.lookahead-L,y=a._tr_tally(o,o.strstart-1-o.prev_match,o.prev_length-L),o.lookahead-=o.prev_length-1,o.prev_length-=2;++o.strstart<=x&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+L-1])&o.hash_mask,D=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),--o.prev_length!=0;);if(o.match_available=0,o.match_length=L-1,o.strstart++,y&&(O(o,!1),o.strm.avail_out===0))return d}else if(o.match_available){if((y=a._tr_tally(o,0,o.window[o.strstart-1]))&&O(o,!1),o.strstart++,o.lookahead--,o.strm.avail_out===0)return d}else o.match_available=1,o.strstart++,o.lookahead--}return o.match_available&&(y=a._tr_tally(o,0,o.window[o.strstart-1]),o.match_available=0),o.insert=o.strstart<L-1?o.strstart:L-1,B===b?(O(o,!0),o.strm.avail_out===0?te:W):o.last_lit&&(O(o,!1),o.strm.avail_out===0)?d:z}function fe(o,B,D,y,x){this.good_length=o,this.max_lazy=B,this.nice_length=D,this.max_chain=y,this.func=x}function Te(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*M),this.dyn_dtree=new s.Buf16(2*(2*T+1)),this.bl_tree=new s.Buf16(2*(2*U+1)),ae(this.dyn_ltree),ae(this.dyn_dtree),ae(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(Z+1),this.heap=new s.Buf16(2*A+1),ae(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*A+1),ae(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function de(o){var B;return o&&o.state?(o.total_in=o.total_out=0,o.data_type=p,(B=o.state).pending=0,B.pending_out=0,B.wrap<0&&(B.wrap=-B.wrap),B.status=B.wrap?k:P,o.adler=B.wrap===2?0:1,B.last_flush=g,a._tr_init(B),u):le(o,v)}function We(o){var B=de(o);return B===u&&function(D){D.window_size=2*D.w_size,ae(D.head),D.max_lazy_match=n[D.level].max_lazy,D.good_match=n[D.level].good_length,D.nice_match=n[D.level].nice_length,D.max_chain_length=n[D.level].max_chain,D.strstart=0,D.block_start=0,D.lookahead=0,D.insert=0,D.match_length=D.prev_length=L-1,D.match_available=0,D.ins_h=0}(o.state),B}function je(o,B,D,y,x,j){if(!o)return v;var F=1;if(B===h&&(B=6),y<0?(F=0,y=-y):15<y&&(F=2,y-=16),x<1||S<x||D!==_||y<8||15<y||B<0||9<B||j<0||w<j)return le(o,v);y===8&&(y=9);var H=new Te;return(o.state=H).strm=o,H.wrap=F,H.gzhead=null,H.w_bits=y,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=x+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+L-1)/L),H.window=new s.Buf8(2*H.w_size),H.head=new s.Buf16(H.hash_size),H.prev=new s.Buf16(H.w_size),H.lit_bufsize=1<<x+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new s.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=B,H.strategy=j,H.method=D,We(o)}n=[new fe(0,0,0,0,function(o,B){var D=65535;for(D>o.pending_buf_size-5&&(D=o.pending_buf_size-5);;){if(o.lookahead<=1){if(ye(o),o.lookahead===0&&B===g)return d;if(o.lookahead===0)break}o.strstart+=o.lookahead,o.lookahead=0;var y=o.block_start+D;if((o.strstart===0||o.strstart>=y)&&(o.lookahead=o.strstart-y,o.strstart=y,O(o,!1),o.strm.avail_out===0)||o.strstart-o.block_start>=o.w_size-J&&(O(o,!1),o.strm.avail_out===0))return d}return o.insert=0,B===b?(O(o,!0),o.strm.avail_out===0?te:W):(o.strstart>o.block_start&&(O(o,!1),o.strm.avail_out),d)}),new fe(4,4,8,4,Se),new fe(4,5,16,8,Se),new fe(4,6,32,32,Se),new fe(4,4,16,16,ue),new fe(8,16,32,32,ue),new fe(8,16,128,128,ue),new fe(8,32,128,256,ue),new fe(32,128,258,1024,ue),new fe(32,258,258,4096,ue)],i.deflateInit=function(o,B){return je(o,B,_,15,8,0)},i.deflateInit2=je,i.deflateReset=We,i.deflateResetKeep=de,i.deflateSetHeader=function(o,B){return o&&o.state?o.state.wrap!==2?v:(o.state.gzhead=B,u):v},i.deflate=function(o,B){var D,y,x,j;if(!o||!o.state||5<B||B<0)return o?le(o,v):v;if(y=o.state,!o.output||!o.input&&o.avail_in!==0||y.status===666&&B!==b)return le(o,o.avail_out===0?-5:v);if(y.strm=o,D=y.last_flush,y.last_flush=B,y.status===k)if(y.wrap===2)o.adler=0,ee(y,31),ee(y,139),ee(y,8),y.gzhead?(ee(y,(y.gzhead.text?1:0)+(y.gzhead.hcrc?2:0)+(y.gzhead.extra?4:0)+(y.gzhead.name?8:0)+(y.gzhead.comment?16:0)),ee(y,255&y.gzhead.time),ee(y,y.gzhead.time>>8&255),ee(y,y.gzhead.time>>16&255),ee(y,y.gzhead.time>>24&255),ee(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),ee(y,255&y.gzhead.os),y.gzhead.extra&&y.gzhead.extra.length&&(ee(y,255&y.gzhead.extra.length),ee(y,y.gzhead.extra.length>>8&255)),y.gzhead.hcrc&&(o.adler=f(o.adler,y.pending_buf,y.pending,0)),y.gzindex=0,y.status=69):(ee(y,0),ee(y,0),ee(y,0),ee(y,0),ee(y,0),ee(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),ee(y,3),y.status=P);else{var F=_+(y.w_bits-8<<4)<<8;F|=(2<=y.strategy||y.level<2?0:y.level<6?1:y.level===6?2:3)<<6,y.strstart!==0&&(F|=32),F+=31-F%31,y.status=P,V(y,F),y.strstart!==0&&(V(y,o.adler>>>16),V(y,65535&o.adler)),o.adler=1}if(y.status===69)if(y.gzhead.extra){for(x=y.pending;y.gzindex<(65535&y.gzhead.extra.length)&&(y.pending!==y.pending_buf_size||(y.gzhead.hcrc&&y.pending>x&&(o.adler=f(o.adler,y.pending_buf,y.pending-x,x)),I(o),x=y.pending,y.pending!==y.pending_buf_size));)ee(y,255&y.gzhead.extra[y.gzindex]),y.gzindex++;y.gzhead.hcrc&&y.pending>x&&(o.adler=f(o.adler,y.pending_buf,y.pending-x,x)),y.gzindex===y.gzhead.extra.length&&(y.gzindex=0,y.status=73)}else y.status=73;if(y.status===73)if(y.gzhead.name){x=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>x&&(o.adler=f(o.adler,y.pending_buf,y.pending-x,x)),I(o),x=y.pending,y.pending===y.pending_buf_size)){j=1;break}j=y.gzindex<y.gzhead.name.length?255&y.gzhead.name.charCodeAt(y.gzindex++):0,ee(y,j)}while(j!==0);y.gzhead.hcrc&&y.pending>x&&(o.adler=f(o.adler,y.pending_buf,y.pending-x,x)),j===0&&(y.gzindex=0,y.status=91)}else y.status=91;if(y.status===91)if(y.gzhead.comment){x=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>x&&(o.adler=f(o.adler,y.pending_buf,y.pending-x,x)),I(o),x=y.pending,y.pending===y.pending_buf_size)){j=1;break}j=y.gzindex<y.gzhead.comment.length?255&y.gzhead.comment.charCodeAt(y.gzindex++):0,ee(y,j)}while(j!==0);y.gzhead.hcrc&&y.pending>x&&(o.adler=f(o.adler,y.pending_buf,y.pending-x,x)),j===0&&(y.status=103)}else y.status=103;if(y.status===103&&(y.gzhead.hcrc?(y.pending+2>y.pending_buf_size&&I(o),y.pending+2<=y.pending_buf_size&&(ee(y,255&o.adler),ee(y,o.adler>>8&255),o.adler=0,y.status=P)):y.status=P),y.pending!==0){if(I(o),o.avail_out===0)return y.last_flush=-1,u}else if(o.avail_in===0&&G(B)<=G(D)&&B!==b)return le(o,-5);if(y.status===666&&o.avail_in!==0)return le(o,-5);if(o.avail_in!==0||y.lookahead!==0||B!==g&&y.status!==666){var H=y.strategy===2?function(R,K){for(var Q;;){if(R.lookahead===0&&(ye(R),R.lookahead===0)){if(K===g)return d;break}if(R.match_length=0,Q=a._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++,Q&&(O(R,!1),R.strm.avail_out===0))return d}return R.insert=0,K===b?(O(R,!0),R.strm.avail_out===0?te:W):R.last_lit&&(O(R,!1),R.strm.avail_out===0)?d:z}(y,B):y.strategy===3?function(R,K){for(var Q,q,re,be,he=R.window;;){if(R.lookahead<=Y){if(ye(R),R.lookahead<=Y&&K===g)return d;if(R.lookahead===0)break}if(R.match_length=0,R.lookahead>=L&&0<R.strstart&&(q=he[re=R.strstart-1])===he[++re]&&q===he[++re]&&q===he[++re]){be=R.strstart+Y;do;while(q===he[++re]&&q===he[++re]&&q===he[++re]&&q===he[++re]&&q===he[++re]&&q===he[++re]&&q===he[++re]&&q===he[++re]&&re<be);R.match_length=Y-(be-re),R.match_length>R.lookahead&&(R.match_length=R.lookahead)}if(R.match_length>=L?(Q=a._tr_tally(R,1,R.match_length-L),R.lookahead-=R.match_length,R.strstart+=R.match_length,R.match_length=0):(Q=a._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++),Q&&(O(R,!1),R.strm.avail_out===0))return d}return R.insert=0,K===b?(O(R,!0),R.strm.avail_out===0?te:W):R.last_lit&&(O(R,!1),R.strm.avail_out===0)?d:z}(y,B):n[y.level].func(y,B);if(H!==te&&H!==W||(y.status=666),H===d||H===te)return o.avail_out===0&&(y.last_flush=-1),u;if(H===z&&(B===1?a._tr_align(y):B!==5&&(a._tr_stored_block(y,0,0,!1),B===3&&(ae(y.head),y.lookahead===0&&(y.strstart=0,y.block_start=0,y.insert=0))),I(o),o.avail_out===0))return y.last_flush=-1,u}return B!==b?u:y.wrap<=0?1:(y.wrap===2?(ee(y,255&o.adler),ee(y,o.adler>>8&255),ee(y,o.adler>>16&255),ee(y,o.adler>>24&255),ee(y,255&o.total_in),ee(y,o.total_in>>8&255),ee(y,o.total_in>>16&255),ee(y,o.total_in>>24&255)):(V(y,o.adler>>>16),V(y,65535&o.adler)),I(o),0<y.wrap&&(y.wrap=-y.wrap),y.pending!==0?u:1)},i.deflateEnd=function(o){var B;return o&&o.state?(B=o.state.status)!==k&&B!==69&&B!==73&&B!==91&&B!==103&&B!==P&&B!==666?le(o,v):(o.state=null,B===P?le(o,-3):u):v},i.deflateSetDictionary=function(o,B){var D,y,x,j,F,H,R,K,Q=B.length;if(!o||!o.state||(j=(D=o.state).wrap)===2||j===1&&D.status!==k||D.lookahead)return v;for(j===1&&(o.adler=c(o.adler,B,Q,0)),D.wrap=0,Q>=D.w_size&&(j===0&&(ae(D.head),D.strstart=0,D.block_start=0,D.insert=0),K=new s.Buf8(D.w_size),s.arraySet(K,B,Q-D.w_size,D.w_size,0),B=K,Q=D.w_size),F=o.avail_in,H=o.next_in,R=o.input,o.avail_in=Q,o.next_in=0,o.input=B,ye(D);D.lookahead>=L;){for(y=D.strstart,x=D.lookahead-(L-1);D.ins_h=(D.ins_h<<D.hash_shift^D.window[y+L-1])&D.hash_mask,D.prev[y&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=y,y++,--x;);D.strstart=y,D.lookahead=L-1,ye(D)}return D.strstart+=D.lookahead,D.block_start=D.strstart,D.insert=D.lookahead,D.lookahead=0,D.match_length=D.prev_length=L-1,D.match_available=0,o.next_in=H,o.input=R,o.avail_in=F,D.wrap=j,u},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){t.exports=function(n,s){var a,c,f,m,g,b,u,v,h,w,p,_,S,A,T,U,M,Z,L,Y,J,k,P,d,z;a=n.state,c=n.next_in,d=n.input,f=c+(n.avail_in-5),m=n.next_out,z=n.output,g=m-(s-n.avail_out),b=m+(n.avail_out-257),u=a.dmax,v=a.wsize,h=a.whave,w=a.wnext,p=a.window,_=a.hold,S=a.bits,A=a.lencode,T=a.distcode,U=(1<<a.lenbits)-1,M=(1<<a.distbits)-1;e:do{S<15&&(_+=d[c++]<<S,S+=8,_+=d[c++]<<S,S+=8),Z=A[_&U];t:for(;;){if(_>>>=L=Z>>>24,S-=L,(L=Z>>>16&255)===0)z[m++]=65535&Z;else{if(!(16&L)){if(!(64&L)){Z=A[(65535&Z)+(_&(1<<L)-1)];continue t}if(32&L){a.mode=12;break e}n.msg="invalid literal/length code",a.mode=30;break e}Y=65535&Z,(L&=15)&&(S<L&&(_+=d[c++]<<S,S+=8),Y+=_&(1<<L)-1,_>>>=L,S-=L),S<15&&(_+=d[c++]<<S,S+=8,_+=d[c++]<<S,S+=8),Z=T[_&M];r:for(;;){if(_>>>=L=Z>>>24,S-=L,!(16&(L=Z>>>16&255))){if(!(64&L)){Z=T[(65535&Z)+(_&(1<<L)-1)];continue r}n.msg="invalid distance code",a.mode=30;break e}if(J=65535&Z,S<(L&=15)&&(_+=d[c++]<<S,(S+=8)<L&&(_+=d[c++]<<S,S+=8)),u<(J+=_&(1<<L)-1)){n.msg="invalid distance too far back",a.mode=30;break e}if(_>>>=L,S-=L,(L=m-g)<J){if(h<(L=J-L)&&a.sane){n.msg="invalid distance too far back",a.mode=30;break e}if(P=p,(k=0)===w){if(k+=v-L,L<Y){for(Y-=L;z[m++]=p[k++],--L;);k=m-J,P=z}}else if(w<L){if(k+=v+w-L,(L-=w)<Y){for(Y-=L;z[m++]=p[k++],--L;);if(k=0,w<Y){for(Y-=L=w;z[m++]=p[k++],--L;);k=m-J,P=z}}}else if(k+=w-L,L<Y){for(Y-=L;z[m++]=p[k++],--L;);k=m-J,P=z}for(;2<Y;)z[m++]=P[k++],z[m++]=P[k++],z[m++]=P[k++],Y-=3;Y&&(z[m++]=P[k++],1<Y&&(z[m++]=P[k++]))}else{for(k=m-J;z[m++]=z[k++],z[m++]=z[k++],z[m++]=z[k++],2<(Y-=3););Y&&(z[m++]=z[k++],1<Y&&(z[m++]=z[k++]))}break}}break}}while(c<f&&m<b);c-=Y=S>>3,_&=(1<<(S-=Y<<3))-1,n.next_in=c,n.next_out=m,n.avail_in=c<f?f-c+5:5-(c-f),n.avail_out=m<b?b-m+257:257-(m-b),a.hold=_,a.bits=S}},{}],49:[function(e,t,i){var n=e("../utils/common"),s=e("./adler32"),a=e("./crc32"),c=e("./inffast"),f=e("./inftrees"),m=1,g=2,b=0,u=-2,v=1,h=852,w=592;function p(k){return(k>>>24&255)+(k>>>8&65280)+((65280&k)<<8)+((255&k)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(k){var P;return k&&k.state?(P=k.state,k.total_in=k.total_out=P.total=0,k.msg="",P.wrap&&(k.adler=1&P.wrap),P.mode=v,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new n.Buf32(h),P.distcode=P.distdyn=new n.Buf32(w),P.sane=1,P.back=-1,b):u}function A(k){var P;return k&&k.state?((P=k.state).wsize=0,P.whave=0,P.wnext=0,S(k)):u}function T(k,P){var d,z;return k&&k.state?(z=k.state,P<0?(d=0,P=-P):(d=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?u:(z.window!==null&&z.wbits!==P&&(z.window=null),z.wrap=d,z.wbits=P,A(k))):u}function U(k,P){var d,z;return k?(z=new _,(k.state=z).window=null,(d=T(k,P))!==b&&(k.state=null),d):u}var M,Z,L=!0;function Y(k){if(L){var P;for(M=new n.Buf32(512),Z=new n.Buf32(32),P=0;P<144;)k.lens[P++]=8;for(;P<256;)k.lens[P++]=9;for(;P<280;)k.lens[P++]=7;for(;P<288;)k.lens[P++]=8;for(f(m,k.lens,0,288,M,0,k.work,{bits:9}),P=0;P<32;)k.lens[P++]=5;f(g,k.lens,0,32,Z,0,k.work,{bits:5}),L=!1}k.lencode=M,k.lenbits=9,k.distcode=Z,k.distbits=5}function J(k,P,d,z){var te,W=k.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new n.Buf8(W.wsize)),z>=W.wsize?(n.arraySet(W.window,P,d-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(z<(te=W.wsize-W.wnext)&&(te=z),n.arraySet(W.window,P,d-z,te,W.wnext),(z-=te)?(n.arraySet(W.window,P,d-z,z,0),W.wnext=z,W.whave=W.wsize):(W.wnext+=te,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=te))),0}i.inflateReset=A,i.inflateReset2=T,i.inflateResetKeep=S,i.inflateInit=function(k){return U(k,15)},i.inflateInit2=U,i.inflate=function(k,P){var d,z,te,W,le,G,ae,I,O,ee,V,$,ye,Se,ue,fe,Te,de,We,je,o,B,D,y,x=0,j=new n.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&k.avail_in!==0)return u;(d=k.state).mode===12&&(d.mode=13),le=k.next_out,te=k.output,ae=k.avail_out,W=k.next_in,z=k.input,G=k.avail_in,I=d.hold,O=d.bits,ee=G,V=ae,B=b;e:for(;;)switch(d.mode){case v:if(d.wrap===0){d.mode=13;break}for(;O<16;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(2&d.wrap&&I===35615){j[d.check=0]=255&I,j[1]=I>>>8&255,d.check=a(d.check,j,2,0),O=I=0,d.mode=2;break}if(d.flags=0,d.head&&(d.head.done=!1),!(1&d.wrap)||(((255&I)<<8)+(I>>8))%31){k.msg="incorrect header check",d.mode=30;break}if((15&I)!=8){k.msg="unknown compression method",d.mode=30;break}if(O-=4,o=8+(15&(I>>>=4)),d.wbits===0)d.wbits=o;else if(o>d.wbits){k.msg="invalid window size",d.mode=30;break}d.dmax=1<<o,k.adler=d.check=1,d.mode=512&I?10:12,O=I=0;break;case 2:for(;O<16;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(d.flags=I,(255&d.flags)!=8){k.msg="unknown compression method",d.mode=30;break}if(57344&d.flags){k.msg="unknown header flags set",d.mode=30;break}d.head&&(d.head.text=I>>8&1),512&d.flags&&(j[0]=255&I,j[1]=I>>>8&255,d.check=a(d.check,j,2,0)),O=I=0,d.mode=3;case 3:for(;O<32;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}d.head&&(d.head.time=I),512&d.flags&&(j[0]=255&I,j[1]=I>>>8&255,j[2]=I>>>16&255,j[3]=I>>>24&255,d.check=a(d.check,j,4,0)),O=I=0,d.mode=4;case 4:for(;O<16;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}d.head&&(d.head.xflags=255&I,d.head.os=I>>8),512&d.flags&&(j[0]=255&I,j[1]=I>>>8&255,d.check=a(d.check,j,2,0)),O=I=0,d.mode=5;case 5:if(1024&d.flags){for(;O<16;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}d.length=I,d.head&&(d.head.extra_len=I),512&d.flags&&(j[0]=255&I,j[1]=I>>>8&255,d.check=a(d.check,j,2,0)),O=I=0}else d.head&&(d.head.extra=null);d.mode=6;case 6:if(1024&d.flags&&(G<($=d.length)&&($=G),$&&(d.head&&(o=d.head.extra_len-d.length,d.head.extra||(d.head.extra=new Array(d.head.extra_len)),n.arraySet(d.head.extra,z,W,$,o)),512&d.flags&&(d.check=a(d.check,z,$,W)),G-=$,W+=$,d.length-=$),d.length))break e;d.length=0,d.mode=7;case 7:if(2048&d.flags){if(G===0)break e;for($=0;o=z[W+$++],d.head&&o&&d.length<65536&&(d.head.name+=String.fromCharCode(o)),o&&$<G;);if(512&d.flags&&(d.check=a(d.check,z,$,W)),G-=$,W+=$,o)break e}else d.head&&(d.head.name=null);d.length=0,d.mode=8;case 8:if(4096&d.flags){if(G===0)break e;for($=0;o=z[W+$++],d.head&&o&&d.length<65536&&(d.head.comment+=String.fromCharCode(o)),o&&$<G;);if(512&d.flags&&(d.check=a(d.check,z,$,W)),G-=$,W+=$,o)break e}else d.head&&(d.head.comment=null);d.mode=9;case 9:if(512&d.flags){for(;O<16;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(I!==(65535&d.check)){k.msg="header crc mismatch",d.mode=30;break}O=I=0}d.head&&(d.head.hcrc=d.flags>>9&1,d.head.done=!0),k.adler=d.check=0,d.mode=12;break;case 10:for(;O<32;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}k.adler=d.check=p(I),O=I=0,d.mode=11;case 11:if(d.havedict===0)return k.next_out=le,k.avail_out=ae,k.next_in=W,k.avail_in=G,d.hold=I,d.bits=O,2;k.adler=d.check=1,d.mode=12;case 12:if(P===5||P===6)break e;case 13:if(d.last){I>>>=7&O,O-=7&O,d.mode=27;break}for(;O<3;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}switch(d.last=1&I,O-=1,3&(I>>>=1)){case 0:d.mode=14;break;case 1:if(Y(d),d.mode=20,P!==6)break;I>>>=2,O-=2;break e;case 2:d.mode=17;break;case 3:k.msg="invalid block type",d.mode=30}I>>>=2,O-=2;break;case 14:for(I>>>=7&O,O-=7&O;O<32;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if((65535&I)!=(I>>>16^65535)){k.msg="invalid stored block lengths",d.mode=30;break}if(d.length=65535&I,O=I=0,d.mode=15,P===6)break e;case 15:d.mode=16;case 16:if($=d.length){if(G<$&&($=G),ae<$&&($=ae),$===0)break e;n.arraySet(te,z,W,$,le),G-=$,W+=$,ae-=$,le+=$,d.length-=$;break}d.mode=12;break;case 17:for(;O<14;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(d.nlen=257+(31&I),I>>>=5,O-=5,d.ndist=1+(31&I),I>>>=5,O-=5,d.ncode=4+(15&I),I>>>=4,O-=4,286<d.nlen||30<d.ndist){k.msg="too many length or distance symbols",d.mode=30;break}d.have=0,d.mode=18;case 18:for(;d.have<d.ncode;){for(;O<3;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}d.lens[F[d.have++]]=7&I,I>>>=3,O-=3}for(;d.have<19;)d.lens[F[d.have++]]=0;if(d.lencode=d.lendyn,d.lenbits=7,D={bits:d.lenbits},B=f(0,d.lens,0,19,d.lencode,0,d.work,D),d.lenbits=D.bits,B){k.msg="invalid code lengths set",d.mode=30;break}d.have=0,d.mode=19;case 19:for(;d.have<d.nlen+d.ndist;){for(;fe=(x=d.lencode[I&(1<<d.lenbits)-1])>>>16&255,Te=65535&x,!((ue=x>>>24)<=O);){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(Te<16)I>>>=ue,O-=ue,d.lens[d.have++]=Te;else{if(Te===16){for(y=ue+2;O<y;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(I>>>=ue,O-=ue,d.have===0){k.msg="invalid bit length repeat",d.mode=30;break}o=d.lens[d.have-1],$=3+(3&I),I>>>=2,O-=2}else if(Te===17){for(y=ue+3;O<y;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}O-=ue,o=0,$=3+(7&(I>>>=ue)),I>>>=3,O-=3}else{for(y=ue+7;O<y;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}O-=ue,o=0,$=11+(127&(I>>>=ue)),I>>>=7,O-=7}if(d.have+$>d.nlen+d.ndist){k.msg="invalid bit length repeat",d.mode=30;break}for(;$--;)d.lens[d.have++]=o}}if(d.mode===30)break;if(d.lens[256]===0){k.msg="invalid code -- missing end-of-block",d.mode=30;break}if(d.lenbits=9,D={bits:d.lenbits},B=f(m,d.lens,0,d.nlen,d.lencode,0,d.work,D),d.lenbits=D.bits,B){k.msg="invalid literal/lengths set",d.mode=30;break}if(d.distbits=6,d.distcode=d.distdyn,D={bits:d.distbits},B=f(g,d.lens,d.nlen,d.ndist,d.distcode,0,d.work,D),d.distbits=D.bits,B){k.msg="invalid distances set",d.mode=30;break}if(d.mode=20,P===6)break e;case 20:d.mode=21;case 21:if(6<=G&&258<=ae){k.next_out=le,k.avail_out=ae,k.next_in=W,k.avail_in=G,d.hold=I,d.bits=O,c(k,V),le=k.next_out,te=k.output,ae=k.avail_out,W=k.next_in,z=k.input,G=k.avail_in,I=d.hold,O=d.bits,d.mode===12&&(d.back=-1);break}for(d.back=0;fe=(x=d.lencode[I&(1<<d.lenbits)-1])>>>16&255,Te=65535&x,!((ue=x>>>24)<=O);){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(fe&&!(240&fe)){for(de=ue,We=fe,je=Te;fe=(x=d.lencode[je+((I&(1<<de+We)-1)>>de)])>>>16&255,Te=65535&x,!(de+(ue=x>>>24)<=O);){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}I>>>=de,O-=de,d.back+=de}if(I>>>=ue,O-=ue,d.back+=ue,d.length=Te,fe===0){d.mode=26;break}if(32&fe){d.back=-1,d.mode=12;break}if(64&fe){k.msg="invalid literal/length code",d.mode=30;break}d.extra=15&fe,d.mode=22;case 22:if(d.extra){for(y=d.extra;O<y;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}d.length+=I&(1<<d.extra)-1,I>>>=d.extra,O-=d.extra,d.back+=d.extra}d.was=d.length,d.mode=23;case 23:for(;fe=(x=d.distcode[I&(1<<d.distbits)-1])>>>16&255,Te=65535&x,!((ue=x>>>24)<=O);){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(!(240&fe)){for(de=ue,We=fe,je=Te;fe=(x=d.distcode[je+((I&(1<<de+We)-1)>>de)])>>>16&255,Te=65535&x,!(de+(ue=x>>>24)<=O);){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}I>>>=de,O-=de,d.back+=de}if(I>>>=ue,O-=ue,d.back+=ue,64&fe){k.msg="invalid distance code",d.mode=30;break}d.offset=Te,d.extra=15&fe,d.mode=24;case 24:if(d.extra){for(y=d.extra;O<y;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}d.offset+=I&(1<<d.extra)-1,I>>>=d.extra,O-=d.extra,d.back+=d.extra}if(d.offset>d.dmax){k.msg="invalid distance too far back",d.mode=30;break}d.mode=25;case 25:if(ae===0)break e;if($=V-ae,d.offset>$){if(($=d.offset-$)>d.whave&&d.sane){k.msg="invalid distance too far back",d.mode=30;break}ye=$>d.wnext?($-=d.wnext,d.wsize-$):d.wnext-$,$>d.length&&($=d.length),Se=d.window}else Se=te,ye=le-d.offset,$=d.length;for(ae<$&&($=ae),ae-=$,d.length-=$;te[le++]=Se[ye++],--$;);d.length===0&&(d.mode=21);break;case 26:if(ae===0)break e;te[le++]=d.length,ae--,d.mode=21;break;case 27:if(d.wrap){for(;O<32;){if(G===0)break e;G--,I|=z[W++]<<O,O+=8}if(V-=ae,k.total_out+=V,d.total+=V,V&&(k.adler=d.check=d.flags?a(d.check,te,V,le-V):s(d.check,te,V,le-V)),V=ae,(d.flags?I:p(I))!==d.check){k.msg="incorrect data check",d.mode=30;break}O=I=0}d.mode=28;case 28:if(d.wrap&&d.flags){for(;O<32;){if(G===0)break e;G--,I+=z[W++]<<O,O+=8}if(I!==(4294967295&d.total)){k.msg="incorrect length check",d.mode=30;break}O=I=0}d.mode=29;case 29:B=1;break e;case 30:B=-3;break e;case 31:return-4;case 32:default:return u}return k.next_out=le,k.avail_out=ae,k.next_in=W,k.avail_in=G,d.hold=I,d.bits=O,(d.wsize||V!==k.avail_out&&d.mode<30&&(d.mode<27||P!==4))&&J(k,k.output,k.next_out,V-k.avail_out)?(d.mode=31,-4):(ee-=k.avail_in,V-=k.avail_out,k.total_in+=ee,k.total_out+=V,d.total+=V,d.wrap&&V&&(k.adler=d.check=d.flags?a(d.check,te,V,k.next_out-V):s(d.check,te,V,k.next_out-V)),k.data_type=d.bits+(d.last?64:0)+(d.mode===12?128:0)+(d.mode===20||d.mode===15?256:0),(ee==0&&V===0||P===4)&&B===b&&(B=-5),B)},i.inflateEnd=function(k){if(!k||!k.state)return u;var P=k.state;return P.window&&(P.window=null),k.state=null,b},i.inflateGetHeader=function(k,P){var d;return k&&k.state&&2&(d=k.state).wrap?((d.head=P).done=!1,b):u},i.inflateSetDictionary=function(k,P){var d,z=P.length;return k&&k.state?(d=k.state).wrap!==0&&d.mode!==11?u:d.mode===11&&s(1,P,z,0)!==d.check?-3:J(k,P,z,z)?(d.mode=31,-4):(d.havedict=1,b):u},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){var n=e("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(m,g,b,u,v,h,w,p){var _,S,A,T,U,M,Z,L,Y,J=p.bits,k=0,P=0,d=0,z=0,te=0,W=0,le=0,G=0,ae=0,I=0,O=null,ee=0,V=new n.Buf16(16),$=new n.Buf16(16),ye=null,Se=0;for(k=0;k<=15;k++)V[k]=0;for(P=0;P<u;P++)V[g[b+P]]++;for(te=J,z=15;1<=z&&V[z]===0;z--);if(z<te&&(te=z),z===0)return v[h++]=20971520,v[h++]=20971520,p.bits=1,0;for(d=1;d<z&&V[d]===0;d++);for(te<d&&(te=d),k=G=1;k<=15;k++)if(G<<=1,(G-=V[k])<0)return-1;if(0<G&&(m===0||z!==1))return-1;for($[1]=0,k=1;k<15;k++)$[k+1]=$[k]+V[k];for(P=0;P<u;P++)g[b+P]!==0&&(w[$[g[b+P]]++]=P);if(M=m===0?(O=ye=w,19):m===1?(O=s,ee-=257,ye=a,Se-=257,256):(O=c,ye=f,-1),k=d,U=h,le=P=I=0,A=-1,T=(ae=1<<(W=te))-1,m===1&&852<ae||m===2&&592<ae)return 1;for(;;){for(Z=k-le,Y=w[P]<M?(L=0,w[P]):w[P]>M?(L=ye[Se+w[P]],O[ee+w[P]]):(L=96,0),_=1<<k-le,d=S=1<<W;v[U+(I>>le)+(S-=_)]=Z<<24|L<<16|Y|0,S!==0;);for(_=1<<k-1;I&_;)_>>=1;if(_!==0?(I&=_-1,I+=_):I=0,P++,--V[k]==0){if(k===z)break;k=g[b+w[P]]}if(te<k&&(I&T)!==A){for(le===0&&(le=te),U+=d,G=1<<(W=k-le);W+le<z&&!((G-=V[W+le])<=0);)W++,G<<=1;if(ae+=1<<W,m===1&&852<ae||m===2&&592<ae)return 1;v[A=I&T]=te<<24|W<<16|U-h|0}}return I!==0&&(v[U+I]=k-le<<24|64<<16|0),p.bits=te,0}},{"../utils/common":41}],51:[function(e,t,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){var n=e("../utils/common"),s=0,a=1;function c(x){for(var j=x.length;0<=--j;)x[j]=0}var f=0,m=29,g=256,b=g+1+m,u=30,v=19,h=2*b+1,w=15,p=16,_=7,S=256,A=16,T=17,U=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=new Array(2*(b+2));c(J);var k=new Array(2*u);c(k);var P=new Array(512);c(P);var d=new Array(256);c(d);var z=new Array(m);c(z);var te,W,le,G=new Array(u);function ae(x,j,F,H,R){this.static_tree=x,this.extra_bits=j,this.extra_base=F,this.elems=H,this.max_length=R,this.has_stree=x&&x.length}function I(x,j){this.dyn_tree=x,this.max_code=0,this.stat_desc=j}function O(x){return x<256?P[x]:P[256+(x>>>7)]}function ee(x,j){x.pending_buf[x.pending++]=255&j,x.pending_buf[x.pending++]=j>>>8&255}function V(x,j,F){x.bi_valid>p-F?(x.bi_buf|=j<<x.bi_valid&65535,ee(x,x.bi_buf),x.bi_buf=j>>p-x.bi_valid,x.bi_valid+=F-p):(x.bi_buf|=j<<x.bi_valid&65535,x.bi_valid+=F)}function $(x,j,F){V(x,F[2*j],F[2*j+1])}function ye(x,j){for(var F=0;F|=1&x,x>>>=1,F<<=1,0<--j;);return F>>>1}function Se(x,j,F){var H,R,K=new Array(w+1),Q=0;for(H=1;H<=w;H++)K[H]=Q=Q+F[H-1]<<1;for(R=0;R<=j;R++){var q=x[2*R+1];q!==0&&(x[2*R]=ye(K[q]++,q))}}function ue(x){var j;for(j=0;j<b;j++)x.dyn_ltree[2*j]=0;for(j=0;j<u;j++)x.dyn_dtree[2*j]=0;for(j=0;j<v;j++)x.bl_tree[2*j]=0;x.dyn_ltree[2*S]=1,x.opt_len=x.static_len=0,x.last_lit=x.matches=0}function fe(x){8<x.bi_valid?ee(x,x.bi_buf):0<x.bi_valid&&(x.pending_buf[x.pending++]=x.bi_buf),x.bi_buf=0,x.bi_valid=0}function Te(x,j,F,H){var R=2*j,K=2*F;return x[R]<x[K]||x[R]===x[K]&&H[j]<=H[F]}function de(x,j,F){for(var H=x.heap[F],R=F<<1;R<=x.heap_len&&(R<x.heap_len&&Te(j,x.heap[R+1],x.heap[R],x.depth)&&R++,!Te(j,H,x.heap[R],x.depth));)x.heap[F]=x.heap[R],F=R,R<<=1;x.heap[F]=H}function We(x,j,F){var H,R,K,Q,q=0;if(x.last_lit!==0)for(;H=x.pending_buf[x.d_buf+2*q]<<8|x.pending_buf[x.d_buf+2*q+1],R=x.pending_buf[x.l_buf+q],q++,H===0?$(x,R,j):($(x,(K=d[R])+g+1,j),(Q=M[K])!==0&&V(x,R-=z[K],Q),$(x,K=O(--H),F),(Q=Z[K])!==0&&V(x,H-=G[K],Q)),q<x.last_lit;);$(x,S,j)}function je(x,j){var F,H,R,K=j.dyn_tree,Q=j.stat_desc.static_tree,q=j.stat_desc.has_stree,re=j.stat_desc.elems,be=-1;for(x.heap_len=0,x.heap_max=h,F=0;F<re;F++)K[2*F]!==0?(x.heap[++x.heap_len]=be=F,x.depth[F]=0):K[2*F+1]=0;for(;x.heap_len<2;)K[2*(R=x.heap[++x.heap_len]=be<2?++be:0)]=1,x.depth[R]=0,x.opt_len--,q&&(x.static_len-=Q[2*R+1]);for(j.max_code=be,F=x.heap_len>>1;1<=F;F--)de(x,K,F);for(R=re;F=x.heap[1],x.heap[1]=x.heap[x.heap_len--],de(x,K,1),H=x.heap[1],x.heap[--x.heap_max]=F,x.heap[--x.heap_max]=H,K[2*R]=K[2*F]+K[2*H],x.depth[R]=(x.depth[F]>=x.depth[H]?x.depth[F]:x.depth[H])+1,K[2*F+1]=K[2*H+1]=R,x.heap[1]=R++,de(x,K,1),2<=x.heap_len;);x.heap[--x.heap_max]=x.heap[1],function(he,Le){var Qe,Ue,et,_e,Ve,Pe,De=Le.dyn_tree,ht=Le.max_code,tt=Le.stat_desc.static_tree,bt=Le.stat_desc.has_stree,rt=Le.stat_desc.extra_bits,lt=Le.stat_desc.extra_base,nt=Le.stat_desc.max_length,C=0;for(_e=0;_e<=w;_e++)he.bl_count[_e]=0;for(De[2*he.heap[he.heap_max]+1]=0,Qe=he.heap_max+1;Qe<h;Qe++)nt<(_e=De[2*De[2*(Ue=he.heap[Qe])+1]+1]+1)&&(_e=nt,C++),De[2*Ue+1]=_e,ht<Ue||(he.bl_count[_e]++,Ve=0,lt<=Ue&&(Ve=rt[Ue-lt]),Pe=De[2*Ue],he.opt_len+=Pe*(_e+Ve),bt&&(he.static_len+=Pe*(tt[2*Ue+1]+Ve)));if(C!==0){do{for(_e=nt-1;he.bl_count[_e]===0;)_e--;he.bl_count[_e]--,he.bl_count[_e+1]+=2,he.bl_count[nt]--,C-=2}while(0<C);for(_e=nt;_e!==0;_e--)for(Ue=he.bl_count[_e];Ue!==0;)ht<(et=he.heap[--Qe])||(De[2*et+1]!==_e&&(he.opt_len+=(_e-De[2*et+1])*De[2*et],De[2*et+1]=_e),Ue--)}}(x,j),Se(K,be,x.bl_count)}function o(x,j,F){var H,R,K=-1,Q=j[1],q=0,re=7,be=4;for(Q===0&&(re=138,be=3),j[2*(F+1)+1]=65535,H=0;H<=F;H++)R=Q,Q=j[2*(H+1)+1],++q<re&&R===Q||(q<be?x.bl_tree[2*R]+=q:R!==0?(R!==K&&x.bl_tree[2*R]++,x.bl_tree[2*A]++):q<=10?x.bl_tree[2*T]++:x.bl_tree[2*U]++,K=R,be=(q=0)===Q?(re=138,3):R===Q?(re=6,3):(re=7,4))}function B(x,j,F){var H,R,K=-1,Q=j[1],q=0,re=7,be=4;for(Q===0&&(re=138,be=3),H=0;H<=F;H++)if(R=Q,Q=j[2*(H+1)+1],!(++q<re&&R===Q)){if(q<be)for(;$(x,R,x.bl_tree),--q!=0;);else R!==0?(R!==K&&($(x,R,x.bl_tree),q--),$(x,A,x.bl_tree),V(x,q-3,2)):q<=10?($(x,T,x.bl_tree),V(x,q-3,3)):($(x,U,x.bl_tree),V(x,q-11,7));K=R,be=(q=0)===Q?(re=138,3):R===Q?(re=6,3):(re=7,4)}}c(G);var D=!1;function y(x,j,F,H){V(x,(f<<1)+(H?1:0),3),function(R,K,Q,q){fe(R),ee(R,Q),ee(R,~Q),n.arraySet(R.pending_buf,R.window,K,Q,R.pending),R.pending+=Q}(x,j,F)}i._tr_init=function(x){D||(function(){var j,F,H,R,K,Q=new Array(w+1);for(R=H=0;R<m-1;R++)for(z[R]=H,j=0;j<1<<M[R];j++)d[H++]=R;for(d[H-1]=R,R=K=0;R<16;R++)for(G[R]=K,j=0;j<1<<Z[R];j++)P[K++]=R;for(K>>=7;R<u;R++)for(G[R]=K<<7,j=0;j<1<<Z[R]-7;j++)P[256+K++]=R;for(F=0;F<=w;F++)Q[F]=0;for(j=0;j<=143;)J[2*j+1]=8,j++,Q[8]++;for(;j<=255;)J[2*j+1]=9,j++,Q[9]++;for(;j<=279;)J[2*j+1]=7,j++,Q[7]++;for(;j<=287;)J[2*j+1]=8,j++,Q[8]++;for(Se(J,b+1,Q),j=0;j<u;j++)k[2*j+1]=5,k[2*j]=ye(j,5);te=new ae(J,M,g+1,b,w),W=new ae(k,Z,0,u,w),le=new ae(new Array(0),L,0,v,_)}(),D=!0),x.l_desc=new I(x.dyn_ltree,te),x.d_desc=new I(x.dyn_dtree,W),x.bl_desc=new I(x.bl_tree,le),x.bi_buf=0,x.bi_valid=0,ue(x)},i._tr_stored_block=y,i._tr_flush_block=function(x,j,F,H){var R,K,Q=0;0<x.level?(x.strm.data_type===2&&(x.strm.data_type=function(q){var re,be=4093624447;for(re=0;re<=31;re++,be>>>=1)if(1&be&&q.dyn_ltree[2*re]!==0)return s;if(q.dyn_ltree[18]!==0||q.dyn_ltree[20]!==0||q.dyn_ltree[26]!==0)return a;for(re=32;re<g;re++)if(q.dyn_ltree[2*re]!==0)return a;return s}(x)),je(x,x.l_desc),je(x,x.d_desc),Q=function(q){var re;for(o(q,q.dyn_ltree,q.l_desc.max_code),o(q,q.dyn_dtree,q.d_desc.max_code),je(q,q.bl_desc),re=v-1;3<=re&&q.bl_tree[2*Y[re]+1]===0;re--);return q.opt_len+=3*(re+1)+5+5+4,re}(x),R=x.opt_len+3+7>>>3,(K=x.static_len+3+7>>>3)<=R&&(R=K)):R=K=F+5,F+4<=R&&j!==-1?y(x,j,F,H):x.strategy===4||K===R?(V(x,2+(H?1:0),3),We(x,J,k)):(V(x,4+(H?1:0),3),function(q,re,be,he){var Le;for(V(q,re-257,5),V(q,be-1,5),V(q,he-4,4),Le=0;Le<he;Le++)V(q,q.bl_tree[2*Y[Le]+1],3);B(q,q.dyn_ltree,re-1),B(q,q.dyn_dtree,be-1)}(x,x.l_desc.max_code+1,x.d_desc.max_code+1,Q+1),We(x,x.dyn_ltree,x.dyn_dtree)),ue(x),H&&fe(x)},i._tr_tally=function(x,j,F){return x.pending_buf[x.d_buf+2*x.last_lit]=j>>>8&255,x.pending_buf[x.d_buf+2*x.last_lit+1]=255&j,x.pending_buf[x.l_buf+x.last_lit]=255&F,x.last_lit++,j===0?x.dyn_ltree[2*F]++:(x.matches++,j--,x.dyn_ltree[2*(d[F]+g+1)]++,x.dyn_dtree[2*O(j)]++),x.last_lit===x.lit_bufsize-1},i._tr_align=function(x){V(x,2,3),$(x,S,J),function(j){j.bi_valid===16?(ee(j,j.bi_buf),j.bi_buf=0,j.bi_valid=0):8<=j.bi_valid&&(j.pending_buf[j.pending++]=255&j.bi_buf,j.bi_buf>>=8,j.bi_valid-=8)}(x)}},{"../utils/common":41}],53:[function(e,t,i){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){(function(n){(function(s,a){if(!s.setImmediate){var c,f,m,g,b=1,u={},v=!1,h=s.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(s);w=w&&w.setTimeout?w:s,c={}.toString.call(s.process)==="[object process]"?function(A){process.nextTick(function(){_(A)})}:function(){if(s.postMessage&&!s.importScripts){var A=!0,T=s.onmessage;return s.onmessage=function(){A=!1},s.postMessage("","*"),s.onmessage=T,A}}()?(g="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",S,!1):s.attachEvent("onmessage",S),function(A){s.postMessage(g+A,"*")}):s.MessageChannel?((m=new MessageChannel).port1.onmessage=function(A){_(A.data)},function(A){m.port2.postMessage(A)}):h&&"onreadystatechange"in h.createElement("script")?(f=h.documentElement,function(A){var T=h.createElement("script");T.onreadystatechange=function(){_(A),T.onreadystatechange=null,f.removeChild(T),T=null},f.appendChild(T)}):function(A){setTimeout(_,0,A)},w.setImmediate=function(A){typeof A!="function"&&(A=new Function(""+A));for(var T=new Array(arguments.length-1),U=0;U<T.length;U++)T[U]=arguments[U+1];var M={callback:A,args:T};return u[b]=M,c(b),b++},w.clearImmediate=p}function p(A){delete u[A]}function _(A){if(v)setTimeout(_,0,A);else{var T=u[A];if(T){v=!0;try{(function(U){var M=U.callback,Z=U.args;switch(Z.length){case 0:M();break;case 1:M(Z[0]);break;case 2:M(Z[0],Z[1]);break;case 3:M(Z[0],Z[1],Z[2]);break;default:M.apply(a,Z)}})(T)}finally{p(A),v=!1}}}}function S(A){A.source===s&&typeof A.data=="string"&&A.data.indexOf(g)===0&&_(+A.data.slice(g.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof Lt<"u"?Lt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(wn);var ui=wn.exports;const hi=Nn(ui),fi=["outline","plain","preview","markdown"],pi=["edit","split","preview"],mi=`
### 一章　冷たい朝
窓の外では、灰色の空が静かに澱んでいる。  
雨粒がガラスを伝い、ひとつひとつの呼吸のように流れていく。  
目を覚ましても、世界はまだ眠っているようだった。

### 二章　傘の下の世界
通りには、人の影がぽつぽつと揺れている。  
傘の布地を叩く音が、唯一のリズム。  
すれ違う誰かの温度が、雨に溶けて消えていった。

### 三章　湯気の向こう
喫茶店の扉を開けると、温かな香りが迎えてくれる。  
コーヒーの湯気が曇った眼鏡を曇らせ、世界を少し柔らかくした。
`,gi=`# 雨の日の幸

## 一章　冷たい朝
窓の外では、灰色の空が静かに澱んでいる。
雨粒がガラスを伝い、ひとつひとつの呼吸のように流れていく。
目を覚ましても、世界はまだ眠っているようだった。

## 二章　傘の下の世界
通りには、人の影がぽつぽつと揺れている。
傘の布地を叩く音が、唯一のリズム。
すれ違う誰かの温度が、雨に溶けて消えていった。

## 三章　湯気の向こう
喫茶店の扉を開けると、温かな香りが迎えてくれる。
コーヒーの湯気が曇った眼鏡を曇らせ、世界を少し柔らかくした。
`,xi=()=>{const{user:N,signOut:r}=It(),e=qt(),[t,i]=pe.useState([]),[n,s]=pe.useState(!0),[a,c]=pe.useState(null),[f,m]=pe.useState("plain"),[g,b]=pe.useState("edit"),u=pe.useRef("edit"),[v,h]=pe.useState(!1),[w,p]=pe.useState(!1),[_,S]=pe.useState(gi),[A,T]=pe.useState(""),[U,M]=pe.useState(""),[Z,L]=pe.useState(!1),[Y,J]=pe.useState(!1),[k,P]=pe.useState(!1),[d,z]=pe.useState([]),[te,W]=pe.useState(null),[le,G]=pe.useState(!1),[ae,I]=pe.useState([{id:"summary",title:"あらすじ",content:""},{id:"note",title:"Note",content:""},{id:"vocabulary",title:"単語帳",content:""},{id:"memo",title:"メモ",content:""}]),[O,ee]=pe.useState(new Set),[V,$]=pe.useState(null),[ye,Se]=pe.useState(null),ue=pe.useRef(null),[fe,Te]=pe.useState(!1);pe.useEffect(()=>{N&&je()},[N]),pe.useEffect(()=>{t.length>0&&!a&&c(t[0].id)},[t,a]);const de=t.find(C=>C.id===a)||null;pe.useEffect(()=>{if(a&&de){let C=de.content||"";C=C.split(`
`).filter(Ae=>!Ae.trim().match(/^#+\s*見出しレベル/)).join(`
`);const ve=Wt(C).filter(Ae=>Ae.level===2).length;let we=C;if(ve<4){const Ae=`## 第一章

ここに第一章の内容を記述してください。

## 第二章

ここに第二章の内容を記述してください。

## 第三章

ここに第三章の内容を記述してください。

## 第四章

ここに第四章の内容を記述してください。
`;!C.trim()||C.trim().length<50?we=Ae:we=C.trim()+`

`+Ae,N&&$e.updateScenario(de.id,{content:we})}S(we),T(de.title||""),z(de.dictionaryEntries??[])}else S(""),T(""),z([])},[a,de,N]),pe.useEffect(()=>{f==="preview"&&g!=="preview"?b("preview"):f==="markdown"&&g!==u.current&&b(u.current)},[f,g]),pe.useEffect(()=>{},[U,Z]);const We=C=>{T(C),de&&N&&($e.updateScenario(de.id,{title:C}),je())},je=async()=>{try{if(N){const C=$e.getUserScenarios(N.uid);i(C)}}catch(C){console.error("Error loading scenarios:",C)}finally{s(!1)}},o=async()=>{try{await r(),e("/")}catch(C){console.error("Sign out error:",C)}},B=()=>{if(!N)return;const se=$e.createScenario({title:"新しいプロジェクト",content:`## 第一章

ここに第一章の内容を記述してください。

## 第二章

ここに第二章の内容を記述してください。

## 第三章

ここに第三章の内容を記述してください。

## 第四章

ここに第四章の内容を記述してください。
`,tags:[],isPublic:!1,authorId:N.uid});je(),c(se)},D=C=>{console.log("Settings saved:",C)},y=async C=>{const se=$e.getProject(C.id);if(!se){const ce=`${C.title||"project"}.md`,ve=`texts/${ce}`,we={read:"allow",quote:"internal",write:"deny",scope:["local"],until:null},Ae={id:`proj-${C.id}`,name:C.title||"無題プロジェクト",main:ce,ai_policy:we,texts:[{id:"t-main",path:ve}],tags:Array.from(new Set((C.tags||[]).filter(xe=>xe&&xe.trim().length>0).map(xe=>xe.trim()))),tag_docs:{},libraly:C.dictionaryEntries&&C.dictionaryEntries.length>0?["辞書"]:void 0,lib_docs:C.dictionaryEntries&&C.dictionaryEntries.length>0?{辞書:{path:"tags/辞書.md"}}:void 0},ze={[ve]:_};if(C.dictionaryEntries&&C.dictionaryEntries.length>0){const xe=C.dictionaryEntries.map(Re=>`### ${Re.term}
${Re.description}`).join(`

`);ze["tags/辞書.md"]=xe}return{project:Ae,files:ze}}const oe={};for(const ce of se.texts){const ve=$e.getProjectTextContent(se.id,ce.id);ve&&(oe[ce.path]=ve)}for(const[ce,ve]of Object.entries(se.tag_docs||{}))ve.path&&!oe[ve.path]&&(oe[ve.path]=`# ${ce}

タグ「${ce}」の説明`);if(se.lib_docs){for(const[ce,ve]of Object.entries(se.lib_docs))if(ve.path&&!oe[ve.path])if(ce==="辞書"){const we=$e.getProjectDictionary(se.id);if(we.length>0){const Ae=we.map(ze=>`### ${ze.term}
${ze.description}`).join(`

`);oe[ve.path]=Ae}else oe[ve.path]=`# 辞書

プロジェクト「${se.name}」の辞書`}else oe[ve.path]=`# ${ce}

ライブラリ「${ce}」の内容`}return{project:se,files:oe}},x=async()=>{if(!de){alert("エクスポートするプロジェクトを選択してください。");return}try{const{project:C,files:se}=await y(de),oe={...C,texts:C.texts.map(Ie=>{const Ke=Ie;if(Ke.tags){const{tags:Xt,...Ot}=Ke;return Ot}return Ie})},ce=new hi;ce.file("project.json",JSON.stringify(oe,null,2));for(const[Ie,Ke]of Object.entries(se))ce.file(Ie,Ke);const ve=$e.getProjectDictionary(de.id);ve.length>0&&ce.file("dictionary.json",JSON.stringify(ve,null,2));const we=Array.from(new Set((C.tags||[]).filter(Ie=>Ie&&Ie.trim().length>0).map(Ie=>Ie.trim())));we.length>0&&ce.file("tags.json",JSON.stringify({tags:we,tag_docs:C.tag_docs||{}},null,2));const Ae=await ce.generateAsync({type:"blob"}),ze=URL.createObjectURL(Ae),xe=document.createElement("a"),ft=(de.title||"project").replace(/[<>:"/\\|?*]/g,"_");xe.href=ze,xe.download=`${ft}-export.zip`,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(ze),alert("プロジェクトのエクスポートが完了しました。")}catch(C){console.error("Export error:",C),alert("プロジェクトのエクスポートに失敗しました。")}},j=C=>{S(C),de&&N&&$e.updateScenario(de.id,{content:C})},F=C=>{if(f==="markdown"){u.current=C,b(C);return}if(f==="preview"){C==="preview"?b("preview"):(u.current=C,m("markdown"),b(C));return}m("markdown"),u.current=C,b(C)},H=C=>C?C.replace(/^#{1,6}\s+/gm,""):"",R=C=>{if(!C)return"";const se=Wt(_),oe=C.split(`
`),ce=[],ve=[/^第[一二三四五六七八九十百千万\d]+章/,/^Chapter\s+\d+/i,/^第\d+章/,/^第\d+節/,/^第\d+部/,/^第[一二三四五六七八九十百千万\d]+節/,/^第[一二三四五六七八九十百千万\d]+部/];let we=0;for(let Ae=0;Ae<oe.length;Ae++){const ze=oe[Ae],xe=ze.trim();if(!xe){ce.push(ze);continue}if(ve.some(ft=>ft.test(xe))&&we<se.length){const ft=se[we].level,Ie="#".repeat(Math.min(Math.max(ft,1),6));ce.push(`${Ie} ${xe}`),we++}else ce.push(ze)}return ce.join(`
`)},K=C=>C.replace(/^#{1,6}\s+/gm,""),Q=()=>{j(ii),m("markdown")},q=()=>{p(!0)},re=C=>{M(C)},be=async C=>{L(!0);try{await new Promise(oe=>setTimeout(oe,1500));const se=`【生成されたテキスト】

${C}に基づいて生成されたテキストがここに表示されます。

実際の実装では、AI API（ChatGPTまたはClaude）から取得したテキストが表示されます。`;M(se)}catch(se){console.error("Text generation error:",se),M("テキストの生成中にエラーが発生しました。")}finally{L(!1)}},he=()=>{Y||J(!0),W(null),P(!0)},Le=({term:C,description:se})=>{if(!de)return;const oe=$e.addDictionaryEntry(de.id,{term:C,description:se});oe&&(z(ce=>[...ce,oe]),J(!0),je(),W(null))},Qe=C=>{de&&($e.removeDictionaryEntry(de.id,C),z(se=>se.filter(oe=>oe.id!==C)),je())},Ue=({term:C,description:se})=>{if(de){if(te){const oe=$e.updateDictionaryEntry(de.id,te.id,{term:C,description:se});oe&&(z(ce=>ce.map(ve=>ve.id===oe.id?oe:ve)),W(null),J(!0),je());return}Le({term:C,description:se})}},et=C=>{W(C),P(!0)},_e=()=>{J(!1)},Ve=()=>{alert("資料の検索機能は今後実装予定です")},Pe=()=>{G(!0)},De=(C,se)=>{I(ae.map(oe=>oe.id===C?{...oe,title:se}:oe))},ht=C=>{I(ae.filter(se=>se.id!==C))},tt=pe.useMemo(()=>Wt(_),[_]),bt=pe.useMemo(()=>ai(_||mi),[_]),rt=pe.useMemo(()=>li(bt,d),[bt,d]),lt=C=>{const se=new Set(O);se.has(C)?se.delete(C):se.add(C),ee(se)},nt=(C,se)=>{if(!C||!se||C===se)return;const oe=di(_,C,se);oe!==_&&j(oe)};return n?l.jsxs("div",{className:"h-screen w-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-indigo-50/20 via-purple-50/10 to-pink-50/20 relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:l.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-br from-indigo-400/20 to-purple-400/20 rounded-full blur-3xl animate-pulse"})}),l.jsxs("div",{className:"flex flex-col items-center gap-6 relative z-10",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-4 border-slate-200/50 border-t-indigo-500 border-r-purple-500"}),l.jsx("div",{className:"absolute inset-0 animate-spin rounded-full h-20 w-20 border-4 border-transparent border-b-pink-500 border-l-emerald-500",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-base font-bold text-slate-700 mb-1",children:"読み込み中..."}),l.jsx("p",{className:"text-xs text-slate-500",children:"プロジェクトを読み込んでいます"})]})]})]}):N?l.jsxs("div",{className:"h-screen w-screen overflow-hidden bg-gradient-to-br from-slate-50 via-indigo-50/20 via-purple-50/10 to-pink-50/20 relative",children:[l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-blue-400/10 to-purple-400/10 rounded-full blur-3xl"}),l.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-indigo-400/10 to-pink-400/10 rounded-full blur-3xl"})]}),l.jsxs("div",{className:"h-full w-full flex flex-col px-6 py-6 relative z-10",children:[l.jsx("div",{className:"mb-6 flex-shrink-0",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4",children:[l.jsxs("div",{className:"flex flex-row items-end gap-8 basis-full sm:basis-[60%]",children:[l.jsx("div",{className:"flex-1 max-w-[300px]",children:l.jsx("input",{type:"text",value:A,onChange:C=>We(C.target.value),placeholder:"プロジェクトの名前",className:"w-full px-5 py-2.5 bg-white/95 backdrop-blur-md border-2 border-slate-200/80 rounded-lg text-base text-slate-800 placeholder-slate-400 shadow-lg shadow-slate-200/50 hover:shadow-xl hover:shadow-slate-300/50 hover:border-indigo-300/50 focus:outline-none focus:ring-4 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all duration-300"})}),l.jsx("div",{className:"flex items-end",children:l.jsxs(Be,{variant:"outline",onClick:B,className:"px-5 py-3 bg-white/90 backdrop-blur-md border-2 border-slate-200/80 rounded-2xl text-sm font-semibold text-slate-700 shadow-lg shadow-slate-200/50 hover:bg-white hover:shadow-xl hover:shadow-slate-300/50 hover:border-indigo-300 hover:scale-105 transition-all duration-300 group",children:[l.jsx(vt,{className:"h-4 w-4 mr-2 group-hover:rotate-90 transition-transform duration-300"}),"プロジェクトを新規作成"]})})]}),l.jsxs("div",{className:"flex flex-col items-end gap-3 basis-full sm:basis-[40%]",children:[l.jsxs(Be,{variant:"outline",className:"px-5 py-3 bg-white/90 backdrop-blur-md border-2 border-slate-200/80 rounded-2xl text-sm font-semibold text-slate-700 shadow-lg shadow-slate-200/50 hover:bg-white hover:shadow-xl hover:shadow-slate-300/50 hover:border-red-300 hover:scale-105 transition-all duration-300 group",onClick:o,children:[l.jsx(zn,{className:"h-4 w-4 mr-2 group-hover:translate-x-1 transition-transform duration-300"}),"ログアウト"]}),l.jsxs("div",{className:"flex w-full items-center justify-end gap-[70px]",children:[l.jsxs(Be,{variant:"outline",className:"px-5 py-3 bg-white/90 backdrop-blur-md border-2 border-slate-200/80 rounded-2xl text-sm font-semibold text-slate-700 shadow-lg shadow-slate-200/50 hover:bg-white hover:shadow-xl hover:shadow-slate-300/50 hover:border-indigo-300 hover:scale-105 transition-all duration-300 group",onClick:()=>h(!0),children:[l.jsx(On,{className:"h-4 w-4 mr-2 group-hover:rotate-90 transition-transform duration-300"}),"設定"]}),l.jsxs(Be,{variant:"outline",className:"min-w-[370px] px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white border-0 rounded-2xl text-sm font-semibold shadow-lg shadow-indigo-500/30 hover:shadow-xl hover:shadow-indigo-500/40 hover:scale-105 transition-all duration-300",onClick:x,children:[l.jsx(Xr,{className:"h-4 w-4 mr-2"}),"↓ エクスポート"]})]})]})]})}),l.jsxs("div",{className:`flex-1 grid grid-cols-1 gap-6 transition-all duration-300 ${fe?"xl:grid-cols-[clamp(44px,6vw,56px)_minmax(0,1fr)_clamp(280px,22vw,400px)]":"xl:grid-cols-[clamp(260px,20vw,300px)_minmax(0,1fr)_clamp(280px,22vw,400px)]"} min-h-0`,children:[l.jsxs("aside",{className:"bg-white/95 backdrop-blur-xl border-2 border-slate-200/60 rounded-3xl p-3 xl:p-6 flex flex-col shadow-2xl shadow-slate-300/30 min-h-0 relative overflow-hidden transition-all duration-300",children:[l.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-indigo-400/10 to-purple-400/10 rounded-full blur-2xl -mr-16 -mt-16"}),l.jsxs("div",{className:"relative z-10 flex flex-col flex-1 min-h-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4 flex-shrink-0",children:[!fe&&l.jsxs("h2",{className:"text-sm font-bold text-slate-700 tracking-wider uppercase flex items-center gap-2",children:[l.jsx("div",{className:"w-1 h-5 bg-gradient-to-b from-indigo-500 to-purple-500 rounded-full"}),"テキスト一覧"]}),l.jsx("button",{type:"button",onClick:()=>Te(C=>!C),className:"ml-auto inline-flex items-center justify-center w-8 h-8 rounded-full border border-slate-200 bg-white/90 text-slate-500 hover:text-indigo-600 hover:border-indigo-300 shadow-sm hover:shadow-md transition-all duration-300","aria-label":fe?"テキスト一覧を展開":"テキスト一覧を折りたたむ",children:l.jsx("span",{className:`text-lg leading-none transform transition-transform duration-300 ${fe?"-rotate-180":""}`,children:"‹"})})]}),!fe&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-3 flex-1 overflow-y-auto scrollable pr-2 min-h-0",children:t.length===0?l.jsxs("div",{className:"py-12 text-center",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200 flex items-center justify-center",children:l.jsx(vt,{className:"h-8 w-8 text-slate-400"})}),l.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"まだプロジェクトがありません"})]}):t.map(C=>l.jsx("button",{onClick:()=>c(C.id),className:`w-full text-left px-5 py-4 rounded-2xl border-2 transition-all duration-300 transform ${a===C.id?"border-indigo-500 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 text-white shadow-xl shadow-indigo-500/40 scale-[1.02]":"border-slate-200/80 bg-white/80 hover:bg-white hover:border-indigo-300/50 hover:shadow-lg hover:shadow-slate-200/50 hover:scale-[1.01] text-slate-700"}`,children:l.jsx("p",{className:"text-sm font-bold truncate",children:C.title})},C.id))}),l.jsxs(Be,{variant:"outline",onClick:B,className:"mt-5 w-full justify-center py-4 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 text-white border-0 rounded-2xl font-bold shadow-xl shadow-indigo-500/40 hover:shadow-2xl hover:shadow-indigo-500/50 hover:scale-105 transition-all duration-300 group flex-shrink-0",children:[l.jsx(vt,{className:"h-5 w-5 mr-2 group-hover:rotate-90 transition-transform duration-300"}),"新規作成"]})]})]})]}),l.jsxs("section",{className:"bg-white/95 backdrop-blur-xl border-2 border-slate-200/60 rounded-3xl p-6 flex flex-col shadow-2xl shadow-slate-300/30 min-h-0 relative overflow-hidden",children:[l.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-gradient-to-tr from-emerald-400/10 to-teal-400/10 rounded-full blur-2xl -ml-20 -mb-20"}),l.jsxs("div",{className:"relative z-10 flex flex-col min-h-0",children:[l.jsxs("div",{className:"flex items-center flex-wrap gap-4 mb-5 flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full"}),l.jsx("span",{className:"text-xs font-bold text-slate-700 tracking-wider uppercase",children:"ViewMode"})]}),l.jsx("div",{className:"flex flex-wrap gap-2.5",children:fi.map(C=>l.jsx("button",{onClick:()=>m(C),className:`px-5 py-2.5 rounded-2xl border-2 text-sm font-bold capitalize transition-all duration-300 transform ${f===C?"border-emerald-500 bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 text-white shadow-xl shadow-emerald-500/40 scale-105":"border-slate-200/80 bg-white/80 text-slate-600 hover:bg-white hover:border-emerald-300/50 hover:shadow-lg hover:shadow-slate-200/50 hover:scale-105"}`,children:C},C))}),(f==="markdown"||f==="preview")&&l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"表示"}),l.jsx("div",{className:"inline-flex rounded-2xl border-2 border-slate-200/80 overflow-hidden bg-white/90 shadow-lg shadow-slate-200/50",children:pi.map(C=>l.jsx("button",{type:"button",onClick:()=>F(C),className:`px-4 py-2 text-xs font-bold capitalize transition-all duration-300 ${g===C?"bg-gradient-to-r from-slate-700 to-slate-800 text-white shadow-inner":"bg-transparent text-slate-600 hover:bg-slate-50"}`,children:C==="edit"?"編集":C==="split"?"分割":"プレビュー"},C))})]}),l.jsx("button",{type:"button",onClick:Q,className:"text-xs font-bold border-2 border-dashed border-slate-300/80 rounded-2xl px-4 py-2 text-slate-600 hover:bg-slate-50 hover:border-indigo-300 hover:text-indigo-600 transition-all duration-300",children:"Markdownテスト挿入"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[260px_minmax(0,1fr)] gap-5 flex-1 min-h-0",children:[l.jsxs("div",{className:"border-2 border-slate-200/60 rounded-2xl p-5 bg-gradient-to-br from-slate-50/90 via-indigo-50/20 to-purple-50/20 overflow-y-auto scrollable min-h-0 shadow-lg shadow-slate-200/30",children:[l.jsxs("h3",{className:"text-xs font-bold text-slate-700 mb-4 tracking-wider uppercase flex items-center gap-2",children:[l.jsx("div",{className:"w-1 h-4 bg-gradient-to-b from-indigo-500 to-purple-500 rounded-full"}),"Outline"]}),l.jsx("div",{className:"space-y-1 text-sm text-gray-600",children:tt.length>0?tt.map(C=>{const se=O.has(C.id);return l.jsx("div",{className:`flex items-center gap-1 group ${ye===C.id?"bg-blue-50 rounded":""}`,children:l.jsxs("div",{className:`flex-1 flex items-center gap-2 cursor-move hover:bg-white/80 px-4 py-2.5 rounded-xl transition-all duration-300 ${C.level<=1?"pl-0":C.level===2?"pl-6":"pl-12"} ${ye===C.id?"bg-indigo-100/70 border-2 border-indigo-400 shadow-md":""}`,draggable:!0,onDragStart:oe=>{$(C.id),oe.dataTransfer.effectAllowed="move"},onDragOver:oe=>{oe.preventDefault(),oe.dataTransfer.dropEffect="move",V&&V!==C.id&&Se(C.id)},onDrop:oe=>{oe.preventDefault(),V&&V!==C.id&&nt(V,C.id),Se(null),$(null)},onDragEnd:()=>{Se(null),$(null)},onDragLeave:()=>{ye===C.id&&Se(null)},onClick:()=>{V||lt(C.id)},children:[l.jsx("span",{className:"text-sm font-semibold text-slate-700",children:C.text}),se&&l.jsx("span",{className:"text-xs text-indigo-500 ml-1 font-bold",children:"▼"}),!se&&l.jsx("span",{className:"text-xs text-slate-400 ml-1",children:"▶"})]})},C.id)}):l.jsx("div",{className:"py-8 text-center",children:l.jsx("p",{className:"text-sm text-slate-400 font-medium",children:"アウトラインはまだありません。"})})})]}),l.jsx("div",{className:"border-2 border-slate-200/60 rounded-2xl p-6 overflow-y-auto scrollable bg-white/90 backdrop-blur-sm shadow-lg shadow-slate-200/30",style:{height:"calc(100vh - 280px)",minHeight:"400px"},children:de?f===null?l.jsxs("div",{className:"relative h-full min-h-[400px] flex items-center justify-center bg-white",children:[l.jsx("div",{className:"absolute left-6 bottom-16 w-2/3 border-t border-dashed border-gray-300 rotate-[-12deg]"}),l.jsx("span",{className:"text-lg font-semibold text-gray-600 bg-white px-3 py-1 shadow-sm rounded",children:"Main Editor"})]}):f==="outline"?l.jsx("div",{className:"h-full flex flex-col",style:{height:"100%"},children:tt.length>0?l.jsx("div",{className:"flex-1 space-y-4",children:tt.map((C,se)=>l.jsxs("div",{className:`flex flex-col border-2 rounded-2xl p-5 hover:border-indigo-300/50 hover:shadow-xl hover:shadow-slate-200/50 transition-all duration-300 cursor-move bg-white/90 backdrop-blur-sm transform hover:scale-[1.01] ${ye===C.id?"border-indigo-400 bg-gradient-to-br from-indigo-50/80 to-purple-50/50 shadow-2xl shadow-indigo-400/30 scale-[1.02]":"border-slate-200/80"}`,draggable:!0,onDragStart:()=>$(C.id),onDragOver:oe=>{oe.preventDefault(),V&&V!==C.id&&Se(C.id)},onDrop:oe=>{oe.preventDefault(),V&&V!==C.id&&nt(V,C.id),Se(null),$(null)},onDragEnd:()=>{Se(null),$(null)},onDragLeave:()=>{ye===C.id&&Se(null)},children:[l.jsx("div",{className:"flex items-center justify-between gap-2",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-xs font-bold text-white bg-gradient-to-r from-indigo-500 to-purple-500 px-3 py-1.5 rounded-xl shadow-md shadow-indigo-500/30",children:[se+1,"章"]}),l.jsx("span",{className:"font-bold text-slate-800 text-base",children:C.text})]})}),l.jsxs("p",{className:"text-xs text-slate-500 mt-3 font-semibold flex items-center gap-2",children:[l.jsxs("span",{className:"px-2 py-0.5 bg-slate-100 rounded-md",children:["レベル: ",C.level]}),l.jsxs("span",{className:"px-2 py-0.5 bg-slate-100 rounded-md",children:["開始行: ",C.startLine+1]})]})]},`outline-main-${C.id}-${se}`))}):l.jsx("div",{className:"flex-1 flex items-center justify-center text-sm text-slate-400 italic",children:"アウトラインはまだありません"})}):f==="plain"?l.jsx("div",{className:"h-full flex flex-col",style:{height:"100%"},children:l.jsx("textarea",{value:H(_),onChange:C=>{const se=K(C.target.value),oe=R(se);j(oe)},className:"w-full h-full text-sm leading-relaxed text-slate-800 font-sans resize-none border-2 border-slate-200/80 rounded-xl p-4 bg-white/90 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 transition-all duration-200 scrollable whitespace-pre-wrap",placeholder:"ここにプレーンテキストで内容を編集できます...","aria-label":"プレーンモード編集"})}):f==="preview"?l.jsx("div",{className:"h-full flex flex-col",style:{height:"100%"},children:l.jsx("div",{ref:ue,contentEditable:!0,suppressContentEditableWarning:!0,onBlur:C=>{const se=C.currentTarget,oe=ve=>{let we="";return ve.childNodes.forEach(Ae=>{if(Ae.nodeType===Node.TEXT_NODE)we+=Ae.textContent||"";else if(Ae.nodeType===Node.ELEMENT_NODE){const ze=Ae,xe=ze.tagName.toLowerCase(),Re=oe(ze);xe==="h1"?we+=`# ${Re}

`:xe==="h2"?we+=`## ${Re}

`:xe==="h3"?we+=`### ${Re}

`:xe==="h4"?we+=`#### ${Re}

`:xe==="p"?we+=`${Re}

`:xe==="li"?we+=`- ${Re}
`:xe==="ul"||xe==="ol"?we+=Re:xe==="blockquote"?we+=`> ${Re}

`:xe==="strong"||xe==="b"?we+=`**${Re}**`:xe==="em"||xe==="i"?we+=`*${Re}*`:xe==="code"?we+=`\`${Re}\``:xe==="br"?we+=`
`:xe==="div"?we+=`${Re}
`:we+=Re}}),we},ce=oe(se).trim();j(ce)},className:"h-full border-2 border-slate-200/80 rounded-xl p-4 overflow-y-auto scrollable bg-white/90 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 transition-all duration-200 cursor-text markdown-preview","aria-label":"プレビューモード編集",dangerouslySetInnerHTML:{__html:rt}},`preview-${a||"none"}`)}):f==="markdown"?l.jsx("div",{className:"h-full flex flex-col",style:{height:"100%"},children:g==="split"?l.jsxs("div",{className:"grid md:grid-cols-2 gap-4 h-full",children:[l.jsx("textarea",{value:_,onChange:C=>j(C.target.value),className:"w-full h-full text-sm leading-relaxed text-slate-700 font-mono resize-none border-2 border-slate-200 rounded-xl p-4 bg-white/90 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 transition-all duration-200 scrollable",placeholder:"ここにMarkdown形式で内容を入力してください..."}),l.jsx("div",{className:"border-2 border-slate-200 rounded-xl p-4 overflow-y-auto scrollable bg-white/90 h-full",children:l.jsx("div",{className:"markdown-preview",dangerouslySetInnerHTML:{__html:rt}})})]}):g==="preview"?l.jsx("div",{className:"h-full border-2 border-slate-200 rounded-xl p-4 overflow-y-auto scrollable bg-white/90",children:l.jsx("div",{className:"markdown-preview",dangerouslySetInnerHTML:{__html:rt}})}):l.jsx("textarea",{value:_,onChange:C=>j(C.target.value),className:"w-full h-full text-sm leading-relaxed text-slate-700 font-mono resize-none border-none outline-none bg-transparent scrollable",placeholder:"ここにMarkdown形式で内容を入力してください..."})}):l.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap text-gray-700 font-mono",children:_}):l.jsxs("div",{className:"h-full flex flex-col items-center justify-center py-16",children:[l.jsx("div",{className:"w-24 h-24 rounded-3xl bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center mb-6 shadow-lg shadow-indigo-200/50",children:l.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center shadow-xl shadow-indigo-500/30",children:l.jsx(vt,{className:"h-6 w-6 text-white"})})}),l.jsx("p",{className:"text-base font-bold text-slate-600 mb-2",children:"プロジェクトを選択してください"}),l.jsx("p",{className:"text-sm text-slate-400",children:"左側のプロジェクト一覧から選択すると内容が表示されます"})]})})]})]})]}),le?l.jsxs("aside",{className:"bg-white/90 backdrop-blur-md border border-slate-200/60 rounded-2xl p-5 flex flex-col space-y-3 shadow-lg shadow-slate-200/50 min-h-0",children:[l.jsxs("div",{className:"flex items-center justify-between border-b-2 border-slate-200/60 pb-3 mb-3",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-700 tracking-wider uppercase",children:"校正モード"}),l.jsx("button",{onClick:()=>G(!1),className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg p-1 transition-all duration-200","aria-label":"校正モードを閉じる",children:l.jsx(st,{className:"h-4 w-4"})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto scrollable space-y-3 min-h-0",children:ae.map(C=>l.jsxs("div",{className:"border-2 border-slate-200/60 rounded-xl bg-gradient-to-br from-white/90 to-slate-50/50 shadow-md",children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b-2 border-slate-200/60 bg-slate-50/50 rounded-t-xl",children:[l.jsx("input",{type:"text",value:C.title,onChange:se=>De(C.id,se.target.value),className:"text-xs font-bold text-slate-700 bg-transparent border-none outline-none focus:bg-white px-2 py-1 rounded-lg tracking-wider uppercase",onBlur:se=>{se.target.value.trim()||De(C.id,"新しいパネル")}}),l.jsx("button",{onClick:()=>ht(C.id),className:"text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg p-1 transition-all duration-200","aria-label":"閉じる",children:l.jsx(st,{className:"h-4 w-4"})})]}),l.jsx("div",{className:"px-4 py-3 min-h-[80px]",children:l.jsx("textarea",{value:C.content,onChange:se=>{I(ae.map(oe=>oe.id===C.id?{...oe,content:se.target.value}:oe))},className:"w-full text-sm text-slate-700 border-none outline-none resize-none bg-transparent placeholder-slate-400",placeholder:"内容を入力...",rows:3})})]},C.id))}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-auto pt-5 border-t-2 border-slate-200/60",children:[l.jsx("button",{onClick:q,className:"border-2 border-slate-200/80 bg-white/90 rounded-2xl px-4 py-3 text-sm font-bold text-left text-slate-700 hover:bg-white hover:border-indigo-300/50 hover:shadow-xl hover:shadow-slate-200/50 hover:scale-[1.02] transition-all duration-300 group",children:l.jsx("span",{className:"group-hover:text-indigo-600 transition-colors duration-300",children:"＋ 文章の追加"})}),l.jsx("button",{onClick:he,className:"border-2 border-slate-200/80 bg-white/90 rounded-2xl px-4 py-3 text-sm font-bold text-left text-slate-700 hover:bg-white hover:border-pink-300/50 hover:shadow-xl hover:shadow-slate-200/50 hover:scale-[1.02] transition-all duration-300 group",children:l.jsx("span",{className:"group-hover:text-pink-600 transition-colors duration-300",children:"＋ 辞書の追加"})}),l.jsxs("button",{onClick:Pe,className:"border-2 border-slate-200/80 bg-gradient-to-r from-emerald-500/10 to-teal-500/10 rounded-2xl px-4 py-3 text-sm font-bold text-left text-slate-700 hover:from-emerald-500/20 hover:to-teal-500/20 hover:border-emerald-300/50 hover:shadow-xl hover:shadow-emerald-200/50 hover:scale-[1.02] transition-all duration-300 flex items-center justify-between group",children:[l.jsx("span",{className:"group-hover:text-emerald-600 transition-colors duration-300",children:"範囲を校正"}),l.jsx(Qt,{className:"h-4 w-4 group-hover:translate-x-1 group-hover:text-emerald-600 transition-all duration-300"})]})]})]}):Y?l.jsxs("aside",{className:"bg-white/95 backdrop-blur-xl border-2 border-slate-200/60 rounded-3xl p-6 flex flex-col space-y-4 shadow-2xl shadow-slate-300/30 min-h-0 overflow-y-auto scrollable relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 left-0 w-40 h-40 bg-gradient-to-br from-blue-400/10 to-cyan-400/10 rounded-full blur-2xl -ml-20 -mt-20"}),l.jsxs("div",{className:"relative z-10",children:[l.jsxs("div",{className:"border-2 border-slate-200/60 rounded-2xl bg-gradient-to-br from-white/95 to-blue-50/30 shadow-xl shadow-slate-200/30 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b-2 border-slate-200/60 bg-gradient-to-r from-blue-50/50 to-cyan-50/30 rounded-t-2xl",children:[l.jsxs("h3",{className:"text-xs font-bold text-slate-700 tracking-wider uppercase flex items-center gap-2",children:[l.jsx("div",{className:"w-1 h-4 bg-gradient-to-b from-blue-500 to-cyan-500 rounded-full"}),"あらすじ"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:_e,className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg p-1 transition-all duration-200","aria-label":"最小化",children:l.jsx(er,{className:"h-4 w-4"})}),l.jsx("button",{onClick:_e,className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg p-1 transition-all duration-200","aria-label":"閉じる",children:l.jsx(st,{className:"h-4 w-4"})})]})]}),l.jsx("div",{className:"px-4 py-3 min-h-[80px]",children:l.jsx("textarea",{className:"w-full text-sm text-slate-700 border-none outline-none resize-none bg-transparent placeholder-slate-400",placeholder:"あらすじを入力...",rows:3})})]}),l.jsxs("div",{className:"border-2 border-slate-200/60 rounded-2xl bg-gradient-to-br from-white/95 to-emerald-50/30 shadow-xl shadow-slate-200/30 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b-2 border-slate-200/60 bg-gradient-to-r from-emerald-50/50 to-teal-50/30 rounded-t-2xl",children:[l.jsxs("h3",{className:"text-xs font-bold text-slate-700 tracking-wider uppercase flex items-center gap-2",children:[l.jsx("div",{className:"w-1 h-4 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full"}),"Note"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:_e,className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg p-1 transition-all duration-200","aria-label":"最小化",children:l.jsx(er,{className:"h-4 w-4"})}),l.jsx("button",{onClick:_e,className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg p-1 transition-all duration-200","aria-label":"閉じる",children:l.jsx(st,{className:"h-4 w-4"})})]})]}),l.jsx("div",{className:"px-4 py-3 min-h-[80px]",children:l.jsx("textarea",{className:"w-full text-sm text-slate-700 border-none outline-none resize-none bg-transparent placeholder-slate-400",placeholder:"ノートを入力...",rows:3})})]}),l.jsxs("div",{className:"border-2 border-slate-200/60 rounded-2xl bg-gradient-to-br from-white/95 to-amber-50/30 shadow-xl shadow-slate-200/30 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b-2 border-slate-200/60 bg-gradient-to-r from-amber-50/50 to-orange-50/30 rounded-t-2xl",children:[l.jsxs("h3",{className:"text-xs font-bold text-slate-700 tracking-wider uppercase flex items-center gap-2",children:[l.jsx("div",{className:"w-1 h-4 bg-gradient-to-b from-amber-500 to-orange-500 rounded-full"}),"タグ"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:_e,className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg p-1 transition-all duration-200","aria-label":"最小化",children:l.jsx(er,{className:"h-4 w-4"})}),l.jsx("button",{onClick:_e,className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg p-1 transition-all duration-200","aria-label":"閉じる",children:l.jsx(st,{className:"h-4 w-4"})})]})]}),l.jsxs("div",{className:"px-5 py-4 flex items-center gap-3 flex-wrap",children:[l.jsx("span",{className:"text-sm font-bold text-slate-700",children:"タグ"}),l.jsx("button",{className:"px-4 py-2 bg-gradient-to-r from-amber-500 via-orange-500 to-red-500 hover:from-amber-600 hover:via-orange-600 hover:to-red-600 rounded-xl text-sm font-bold text-white shadow-lg shadow-amber-500/30 hover:shadow-xl hover:shadow-amber-500/40 hover:scale-105 transition-all duration-300",children:"Main"}),l.jsx("button",{className:"px-4 py-2 border-2 border-slate-200/80 hover:border-indigo-300/50 hover:bg-indigo-50/50 rounded-xl text-sm font-bold text-slate-600 hover:text-indigo-600 transition-all duration-300 hover:scale-105",children:"+説明を追加"})]})]}),d.map(C=>l.jsxs("div",{className:"border-2 border-slate-200/60 rounded-2xl bg-gradient-to-br from-white/95 to-blue-50/40 shadow-xl shadow-slate-200/30 mb-4 transform hover:scale-[1.01] transition-all duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b-2 border-slate-200/60 bg-gradient-to-r from-blue-50/60 via-indigo-50/40 to-purple-50/30 rounded-t-2xl",children:[l.jsxs("h3",{className:"text-base font-bold text-slate-800 flex items-center gap-2",children:[l.jsx("div",{className:"w-1.5 h-5 bg-gradient-to-b from-blue-500 to-indigo-500 rounded-full"}),C.term]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>et(C),className:"text-xs font-bold text-blue-600 hover:text-blue-700 hover:bg-blue-50 px-3 py-1.5 rounded-xl transition-all duration-300 hover:scale-105","aria-label":"辞書エントリを編集",children:"編集"}),l.jsx("button",{onClick:()=>Qe(C.id),className:"text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-xl p-1.5 transition-all duration-300 hover:scale-110","aria-label":"辞書エントリを削除",children:l.jsx(st,{className:"h-4 w-4"})})]})]}),l.jsxs("div",{className:"px-5 py-4",children:[l.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap leading-relaxed font-medium mb-3",children:C.description}),l.jsx("div",{className:"flex items-center gap-2 pt-3 border-t border-slate-200/50",children:l.jsxs("span",{className:"text-xs text-slate-500 font-semibold",children:["登録日: ",C.createdAt?new Date(C.createdAt).toLocaleDateString("ja-JP"):"-"]})})]})]},C.id)),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-auto pt-5 border-t-2 border-slate-200/60",children:[l.jsx("button",{onClick:q,className:"border-2 border-slate-200/80 bg-white/90 rounded-2xl px-4 py-3 text-sm font-bold text-left text-slate-700 hover:bg-white hover:border-indigo-300/50 hover:shadow-xl hover:shadow-slate-200/50 hover:scale-[1.02] transition-all duration-300 group",children:l.jsx("span",{className:"group-hover:text-indigo-600 transition-colors duration-300",children:"＋ 文章の追加"})}),l.jsx("button",{onClick:he,className:"border-2 border-slate-200/80 bg-white/90 rounded-2xl px-4 py-3 text-sm font-bold text-left text-slate-700 hover:bg-white hover:border-pink-300/50 hover:shadow-xl hover:shadow-slate-200/50 hover:scale-[1.02] transition-all duration-300 group",children:l.jsx("span",{className:"group-hover:text-pink-600 transition-colors duration-300",children:"＋ 辞書の追加"})}),l.jsxs("button",{onClick:Pe,className:"border-2 border-slate-200/80 bg-gradient-to-r from-emerald-500/10 to-teal-500/10 rounded-2xl px-4 py-3 text-sm font-bold text-left text-slate-700 hover:from-emerald-500/20 hover:to-teal-500/20 hover:border-emerald-300/50 hover:shadow-xl hover:shadow-emerald-200/50 hover:scale-[1.02] transition-all duration-300 flex items-center justify-between group",children:[l.jsx("span",{className:"group-hover:text-emerald-600 transition-colors duration-300",children:"範囲を校正"}),l.jsx(Qt,{className:"h-4 w-4 group-hover:translate-x-1 group-hover:text-emerald-600 transition-all duration-300"})]})]})]})]}):l.jsxs("aside",{className:"bg-white/95 backdrop-blur-xl border-2 border-slate-200/60 rounded-3xl p-6 flex flex-col space-y-4 shadow-2xl shadow-slate-300/30 min-h-0 relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-gradient-to-br from-pink-400/10 to-rose-400/10 rounded-full blur-2xl -ml-16 -mt-16"}),l.jsxs("div",{className:"relative z-10 flex flex-col space-y-4",children:[l.jsx("button",{onClick:q,className:"w-full border-2 border-slate-200/80 bg-white/90 rounded-2xl px-5 py-4 text-sm font-bold text-left text-slate-700 hover:bg-white hover:border-indigo-300/50 hover:shadow-xl hover:shadow-slate-200/50 hover:scale-[1.02] transition-all duration-300 group",children:l.jsx("span",{className:"group-hover:text-indigo-600 transition-colors duration-300",children:"＋ 文章の追加"})}),l.jsx("button",{onClick:he,className:"w-full border-2 border-slate-200/80 bg-white/90 rounded-2xl px-5 py-4 text-sm font-bold text-left text-slate-700 hover:bg-white hover:border-pink-300/50 hover:shadow-xl hover:shadow-slate-200/50 hover:scale-[1.02] transition-all duration-300 group",children:l.jsx("span",{className:"group-hover:text-pink-600 transition-colors duration-300",children:"＋ 辞書の追加"})}),l.jsxs("button",{onClick:Ve,className:"w-full border-2 border-slate-200/80 bg-white/90 rounded-2xl px-5 py-4 text-sm font-bold text-left text-slate-700 hover:bg-white hover:border-teal-300/50 hover:shadow-xl hover:shadow-slate-200/50 hover:scale-[1.02] transition-all duration-300 flex items-center group",children:[l.jsx(vt,{className:"h-4 w-4 mr-2 group-hover:text-teal-600 transition-colors duration-300"}),l.jsx("span",{className:"group-hover:text-teal-600 transition-colors duration-300",children:"資料の検索"})]}),l.jsxs("button",{onClick:Pe,className:"w-full border-2 border-slate-200/80 bg-gradient-to-r from-emerald-500/10 to-teal-500/10 rounded-2xl px-5 py-4 text-sm font-bold text-left text-slate-700 hover:from-emerald-500/20 hover:to-teal-500/20 hover:border-emerald-300/50 hover:shadow-xl hover:shadow-emerald-200/50 hover:scale-[1.02] transition-all duration-300 flex items-center justify-between group",children:[l.jsx("span",{className:"group-hover:text-emerald-600 transition-colors duration-300",children:"範囲を校正"}),l.jsx(Qt,{className:"h-4 w-4 group-hover:translate-x-1 group-hover:text-emerald-600 transition-all duration-300"})]})]})]})]})]}),l.jsx(Jn,{isOpen:v,onClose:()=>h(!1),onSave:D}),l.jsx(Qn,{isOpen:w,onClose:()=>p(!1),onSave:re,onNext:be}),l.jsx(es,{isOpen:k,onClose:()=>{P(!1),W(null)},onSave:Ue,onNext:te?void 0:Le,mode:te?"edit":"create",initialEntry:te?{term:te.term,description:te.description}:void 0})]}):null},bi=({variant:N="info",title:r,message:e,onClose:t,className:i=""})=>{const s={success:{bg:"bg-green-50",border:"border-green-200",text:"text-green-800",icon:Mn,iconColor:"text-green-600"},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",icon:Pn,iconColor:"text-red-600"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",icon:Ln,iconColor:"text-yellow-600"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",icon:Dn,iconColor:"text-blue-600"}}[N],a=s.icon;return l.jsx("div",{className:`${s.bg} ${s.border} border rounded-lg p-4 ${i}`,role:"alert",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx(a,{className:`${s.iconColor} h-5 w-5 mt-0.5 mr-3 flex-shrink-0`}),l.jsxs("div",{className:"flex-1",children:[r&&l.jsx("h3",{className:`${s.text} font-semibold mb-1`,children:r}),l.jsx("p",{className:`${s.text} text-sm`,children:e})]}),t&&l.jsx("button",{onClick:t,className:`${s.text} ml-4 flex-shrink-0 hover:opacity-75`,"aria-label":"Close",children:l.jsx(st,{className:"h-5 w-5"})})]})})},wi=()=>{const[N,r]=ge.useState(""),[e,t]=ge.useState(""),[i,n]=ge.useState(!1),[s,a]=ge.useState(""),{signIn:c}=It(),f=qt(),m=async g=>{g.preventDefault(),n(!0),a("");try{await c(N,e),f("/dashboard")}catch(b){a(b.message||"ログインに失敗しました")}finally{n(!1)}};return l.jsx("div",{className:"min-h-screen bg-white text-gray-900 flex items-center justify-center",children:l.jsx("div",{className:"w-full max-w-md px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"border border-gray-300 rounded-lg bg-white px-6 py-10 sm:px-12 sm:py-14 shadow-sm",children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-800 mb-12 text-center",children:"あるかなライター"}),l.jsxs("div",{className:"w-full",children:[s&&l.jsx(bi,{variant:"error",message:s,onClose:()=>a(""),className:"mb-6"}),l.jsxs("form",{className:"space-y-6",onSubmit:m,children:[l.jsx(it,{label:"メールアドレス",type:"email",value:N,onChange:g=>r(g.target.value),placeholder:"pxr@example.com",required:!0}),l.jsx(it,{label:"パスワード",type:"password",value:e,onChange:g=>t(g.target.value),placeholder:"パスワードを入力",required:!0}),l.jsx(Be,{type:"submit",className:"w-full",disabled:i,children:i?l.jsxs(l.Fragment,{children:[l.jsx(rn,{size:"sm",className:"mr-2"}),"ログイン中..."]}):"ログイン"})]}),l.jsx("div",{className:"mt-4 text-sm text-center",children:l.jsx("a",{href:"#",className:"text-gray-700 underline hover:text-gray-900",children:"パスワード忘れた方はこちら"})})]}),l.jsxs("div",{className:"mt-24 sm:mt-28 flex flex-col items-center space-y-2 text-sm text-gray-600",children:[l.jsx(pt,{to:"#",className:"underline hover:text-gray-800",children:"アルカナライター テスター希望はこちら"}),l.jsx(pt,{to:"#",className:"underline hover:text-gray-800",children:"利用規約"}),l.jsx("p",{className:"text-xs uppercase tracking-wide",children:"PxR LLC."})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx(pt,{to:"#",className:"text-xs text-gray-500 underline hover:text-gray-700",children:"フォームへリンク"})})]})})})},vi=()=>{const[N,r]=ge.useState(""),[e,t]=ge.useState(""),[i,n]=ge.useState(""),[s,a]=ge.useState(""),[c,f]=ge.useState(!1),[m,g]=ge.useState(!1),[b,u]=ge.useState(!1),[v,h]=ge.useState(""),{signUp:w}=It(),p=qt(),_=async S=>{if(S.preventDefault(),u(!0),h(""),e!==i){h("パスワードが一致しません"),u(!1);return}if(e.length<6){h("パスワードは6文字以上で入力してください"),u(!1);return}try{await w(N,e,s),p("/dashboard")}catch(A){h(A.message||"アカウント作成に失敗しました")}finally{u(!1)}};return l.jsx("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"max-w-md w-full space-y-8",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"flex justify-center",children:l.jsx(Bn,{className:"h-12 w-12 text-primary-600"})}),l.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"新規アカウント作成"}),l.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["または"," ",l.jsx(pt,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"既存のアカウントでログイン"})]})]}),l.jsxs("form",{className:"mt-8 space-y-6",onSubmit:_,children:[v&&l.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md text-sm",children:v}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(it,{label:"表示名",type:"text",value:s,onChange:S=>a(S.target.value),placeholder:"あなたの名前",required:!0}),l.jsx(it,{label:"メールアドレス",type:"email",value:N,onChange:S=>r(S.target.value),placeholder:"your@email.com",required:!0}),l.jsxs("div",{className:"relative",children:[l.jsx(it,{label:"パスワード",type:c?"text":"password",value:e,onChange:S=>t(S.target.value),placeholder:"パスワードを入力（6文字以上）",required:!0}),l.jsx("button",{type:"button",className:"absolute right-3 top-8 text-gray-400 hover:text-gray-600",onClick:()=>f(!c),children:c?l.jsx(zr,{className:"h-5 w-5"}):l.jsx(Or,{className:"h-5 w-5"})})]}),l.jsxs("div",{className:"relative",children:[l.jsx(it,{label:"パスワード確認",type:m?"text":"password",value:i,onChange:S=>n(S.target.value),placeholder:"パスワードを再入力",required:!0}),l.jsx("button",{type:"button",className:"absolute right-3 top-8 text-gray-400 hover:text-gray-600",onClick:()=>g(!m),children:m?l.jsx(zr,{className:"h-5 w-5"}):l.jsx(Or,{className:"h-5 w-5"})})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),l.jsxs("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-900",children:[l.jsx(pt,{to:"#",className:"text-primary-600 hover:text-primary-500",children:"利用規約"}),"と",l.jsx(pt,{to:"#",className:"text-primary-600 hover:text-primary-500",children:"プライバシーポリシー"}),"に同意します"]})]}),l.jsx("div",{children:l.jsx(Be,{type:"submit",className:"w-full",disabled:b,children:b?"アカウント作成中...":"アカウントを作成"})}),l.jsx("div",{className:"text-center",children:l.jsx(pt,{to:"/",className:"text-sm text-gray-600 hover:text-gray-500",children:"ホームに戻る"})})]})]})})},or="auth:unauthorized",yi=({children:N})=>{const{user:r,loading:e,signOut:t}=It(),i=qt(),n=An(),s=pe.useCallback(()=>{n.pathname!=="/"&&i("/",{replace:!0})},[n.pathname,i]);return pe.useEffect(()=>{e||["/editor","/dashboard"].some(c=>n.pathname.startsWith(c))&&!r&&s()},[e,r,n.pathname,s]),pe.useEffect(()=>{const a=async()=>{try{await t()}finally{s()}};return window.addEventListener(or,a),()=>window.removeEventListener(or,a)},[s,t]),pe.useEffect(()=>{if(window.__authFetchPatched)return;const a=window.fetch;window.__authFetchPatched=!0,window.fetch=async(...c)=>{const f=await a(...c);return(f.status===401||f.status===403)&&window.dispatchEvent(new CustomEvent(or)),f}},[]),l.jsx(l.Fragment,{children:N})};function _i(){return l.jsx(Gn,{children:l.jsx("div",{className:"min-h-screen bg-white",children:l.jsx(yi,{children:l.jsx(Tn,{children:l.jsxs(yt,{path:"/",element:l.jsx(qn,{}),children:[l.jsx(yt,{index:!0,element:l.jsx(wi,{})}),l.jsx(yt,{path:"register",element:l.jsx(vi,{})}),l.jsx(yt,{path:"editor",element:l.jsx(Vn,{})}),l.jsx(yt,{path:"dashboard",element:l.jsx(xi,{})})]})})})})})}lr.createRoot(document.getElementById("root")).render(l.jsx(pe.StrictMode,{children:l.jsx(Cn,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsx(_i,{})})}));
//# sourceMappingURL=index-DlWCdmVc.js.map
